(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-525e8888","chunk-2d0cf4a3","chunk-2d0cf4a3"],{4167:function(t,e,a){},"62a2":function(t,e,a){"use strict";a.d(e,"c",function(){return o}),a.d(e,"b",function(){return i}),a.d(e,"a",function(){return s}),a.d(e,"d",function(){return r});var n=a("2864");function o(t,e){var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),S:t.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e}function i(t,e,a,o){return new Promise(function(o,i){"image/png"!=t.type&&"image/jpeg"!=t.type&&"image/jpg"!=t.type&&"image/bmp"!=t.type&&(n["Message"].error("图片格式只能选择png/jpeg/jpg/bmp"),i());var s=new FileReader;s.onload=function(t){var s=t.target.result,r=new Image;r.onload=function(){e&&this.width!=e?(n["Message"].error("请上传宽为"+e+"的图片"),i()):a&&this.height!=a?(n["Message"].error("请上传高为"+a+"的图片"),i()):o()},r.onerror=i,r.src=s},s.readAsDataURL(t)})}function s(t,e){return new Promise(function(e,a){"image/png"!=t.type&&"image/jpeg"!=t.type&&"image/jpg"!=t.type&&"image/bmp"!=t.type&&(n["Message"].error("图片格式只能选择png/jpeg/jpg/bmp"),a());var o=new FileReader;o.onload=function(t){var n=t.target.result,o=new Image;e(),o.onerror=a,o.src=n},o.readAsDataURL(t)})}function r(t,e){for(var a=[t[0]],n=1;n<t.length;n++){for(var o=t[n],i=!1,s=0;s<a.length;s++)if(o[e]==a[s][e]){i=!0;break}i||a.push(o)}return a}},"835b":function(t,e,a){"use strict";var n=a("4167"),o=a.n(n);o.a},"8d0a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[t.couponEditPage?t._e():a("Row",[a("div",{staticStyle:{width:"90%",background:"#fff","box-shadow":"0 6px 6px -4px rgba(0,0,0,.2)","z-index":"5",position:"fixed",padding:"14px"}},[t.merchantId?a("Alert",{attrs:{"show-icon":""}},[t._v("\n         商户编号 :  "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.merchantId))]),a("span",{attrs:{slot:"desc"},slot:"desc"})]):t._e()],1),a("div",{staticStyle:{"padding-top":"100px"}},[a("Card",[a("Row",[a("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":120}},[a("FormItem",{attrs:{label:"优惠券模版ID"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入优惠券模版ID"},model:{value:t.searchItem.templateId,callback:function(e){t.$set(t.searchItem,"templateId",e)},expression:"searchItem.templateId"}})],1),t.drop?a("span",[a("FormItem",{attrs:{label:"优惠券标题\t"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入优惠券标题\t"},model:{value:t.searchItem.title,callback:function(e){t.$set(t.searchItem,"title",e)},expression:"searchItem.title"}})],1),a("FormItem",{attrs:{label:"优惠券种类"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择优惠券种类",clearable:""},model:{value:t.searchItem.couponKind,callback:function(e){t.$set(t.searchItem,"couponKind",e)},expression:"searchItem.couponKind"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("免费券")]),a("Option",{attrs:{value:"2"}},[t._v("付费券")])],1)],1),a("FormItem",{attrs:{label:"用券有效期类型"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择用券有效期类型",clearable:""},model:{value:t.searchItem.useDateType,callback:function(e){t.$set(t.searchItem,"useDateType",e)},expression:"searchItem.useDateType"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("固定时间范围")]),a("Option",{attrs:{value:"2"}},[t._v("相对有效期")])],1)],1),a("FormItem",{attrs:{label:"优惠类型"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择优惠类型",clearable:""},model:{value:t.searchItem.couponType,callback:function(e){t.$set(t.searchItem,"couponType",e)},expression:"searchItem.couponType"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("固定金额")]),a("Option",{attrs:{value:"2"}},[t._v("折扣")])],1)],1),a("FormItem",{attrs:{label:"状态"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:t.searchItem.status,callback:function(e){t.$set(t.searchItem,"status",e)},expression:"searchItem.status"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("上架")]),a("Option",{attrs:{value:"-1"}},[t._v("下架")])],1)],1)],1):t._e(),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.queryTableList}},[t._v("搜索")]),a("Button",{on:{click:t.refresh}},[t._v("重置")]),a("a",{staticClass:"drop-down",on:{click:t.dropDown}},[t._v("\n                "+t._s(t.dropDownContent)+"\n                "),a("Icon",{attrs:{type:t.dropDownIcon}})],1)],1)],1)],1)],1),a("Card",[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(e){return t.goback()}}},[t._v("返回")]),a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){return t.addInfo()}}},[t._v("新增")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.updateTableList}},[t._v("刷新")])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:t.TableLoading,border:"",columns:t.tableColumns,data:t.table_list,sortable:"custom"},scopedSlots:t._u([{key:"couponBigImg",fn:function(e){var n=e.row;return[a("Tooltip",{attrs:{content:"点击可查看大图 ",placement:"right"}},[a("img",{staticStyle:{width:"74px",height:"43px"},attrs:{src:n.couponBigImg},on:{click:function(e){return t.showBigImg(n)}}})])]}},{key:"ticketMoney",fn:function(e){var n=e.row;return[1==n.couponType?a("span",[t._v(t._s(n.ticketMoney/100)+" 元")]):t._e(),2==n.couponType?a("span",[t._v(t._s(n.ticketDiscount/10)+" 折")]):t._e()]}},{key:"ChangeStart",fn:function(e){var n=e.row;return[1==n.useDateType?a("span",[t._v(" "+t._s(n.useStartDate))]):t._e(),2==n.useDateType?a("span",[t._v(" 加"+t._s(n.addDaysUseStart)+"天开始生效")]):t._e()]}},{key:"ChangeEnd",fn:function(e){var n=e.row;return[1==n.useDateType?a("span",[t._v(" "+t._s(n.useEndDate))]):t._e(),2==n.useDateType?a("span",[t._v(" 加"+t._s(n.addDaysUseEnd)+"天结束用券")]):t._e()]}},{key:"price",fn:function(e){var n=e.row;return[2==n.couponKind?a("span",[t._v(t._s(n.price/100)+" 元 ")]):a("span",[t._v("免费")])]}},{key:"operate",fn:function(e){var n=e.row;return[0==n.status?a("Button",{staticStyle:{color:"#2db7f5"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(n)}}},[t._v("编辑")]):t._e(),0==n.status||-1==n.status?a("Button",{staticStyle:{color:"#19be6b"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.changeStatus(n)}}},[t._v("发布")]):t._e(),1==n.status?a("Button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.changeStatus(n)}}},[t._v("下架")]):t._e()]}}],null,!1,1362173866)})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1)],1)]),t.couponEditPage?a("div",[a("couponEdit",{attrs:{couponEdit_info:t.couponEdit_info},on:{changeStatus:t.showbasicSetStatus}})],1):t._e(),a("Modal",{attrs:{title:"查看大图",width:"600"},on:{"on-cancel":t.bigImgCancel},model:{value:t.bigImgDialog,callback:function(e){t.bigImgDialog=e},expression:"bigImgDialog"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.big_Image_url}})])],1)},o=[],i=a("7f80"),s=(a("62a2"),a("7599")),r={name:"merchant-information",components:{couponEdit:s["default"]},props:{merchantId:String},data:function(){return{couponEditPage:!1,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{templateId:"",title:"",couponKind:"",couponType:"",useDateType:"",status:""},couponEdit_info:{},current:1,totalSize:0,pageNum:1,limit:10,TableLoading:!1,table_list:[],self:this,bigImgDialog:!1,big_Image_url:"",tableColumns:[{title:"商户编号",key:"merchantId",align:"center",width:150},{title:"优惠券模板ID",key:"templateId",sortable:!0,align:"center",width:150},{title:"优惠券标题",key:"title",align:"center",width:150},{title:"优惠券详情图",align:"center",width:120,key:"couponBigImg",slot:"couponBigImg"},{title:"优惠类型",key:"couponType",align:"center",width:150,render:function(t,e){var a=e.row,n=1===a.couponType?"blue":"red",o=1===a.couponType?"固定金额":"折扣";return t("Tag",{props:{color:n}},o)}},{title:"优惠金额/优惠折扣",align:"center",width:150,slot:"ticketMoney"},{title:"优惠券种类",key:"couponKind",width:150,align:"center",render:function(t,e){var a=e.row,n=1===a.couponKind?"green":2===a.couponKind?"blue":"red",o=1===a.couponKind?"免费券":2===a.couponKind?"付费券":"其他";return t("Tag",{props:{color:n}},o)}},{title:"购买价格(单位为元)",key:"price",align:"center",width:150,slot:"price"},{title:"活动开始时间",key:"startDate",align:"center",width:150},{title:"活动结束时间",key:"endDate",align:"center",width:150},{title:"用券有效期类型",key:"useDateType",align:"center",width:150,render:function(t,e){var a=e.row,n=1===a.useDateType?"blue":"red",o=1===a.useDateType?"固定时间范围":"相对有效期";return t("Tag",{props:{color:n}},o)}},{title:"用券开始时间",width:200,align:"center",slot:"ChangeStart"},{title:"用券结束时间",width:200,align:"center",slot:"ChangeEnd"},{title:"状态",key:"status",width:150,align:"center",render:function(t,e){var a=e.row,n=0===a.status?"green":1===a.status?"blue":"red",o=0===a.status?"创建":1===a.status?"上架":"下架";return t("Tag",{props:{color:n}},o)}},{title:"用户限领数量",key:"getLimit",align:"center",width:150},{title:"库存数量",key:"stockCount",align:"center",width:150},{title:"操作",key:"action",fixed:"left",align:"center",slot:"operate",width:200}]}},created:function(){},methods:{init:function(){this.updateTableList()},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},refresh:function(){this.searchItem.templateId="",this.searchItem.title="",this.searchItem.couponKind="",this.searchItem.couponType="",this.searchItem.useDateType="",this.searchItem.status="",this.updateTableList()},queryTableList:function(){this.updateTableList()},changeCurrent:function(t){this.pageNum=t,this.updateTableList()},updateTableList:function(){var t=this;this.TableLoading=!0;var e={merchantId:this.merchantId,templateId:this.searchItem.templateId,title:this.searchItem.title,couponKind:this.searchItem.couponKind,couponType:this.searchItem.couponType,useDateType:this.searchItem.useDateType,status:this.searchItem.status};Object(i["g"])("/merchantCouponTemplate/list?pageNum="+this.pageNum+"&pageSize="+this.limit,e).then(function(e){t.TableLoading=!1,t.totalSize=e.data.total,t.table_list=e.data.records})},addInfo:function(){this.setStore("camp_pageStatus","add"),this.couponEdit_info.merchantId=this.merchantId,this.couponEditPage=!0},editInfo:function(t){this.setStore("camp_pageStatus","edit"),this.couponEdit_info=t,this.couponEditPage=!0},showbasicSetStatus:function(t){this.couponEditPage=t,this.updateTableList()},showBigImg:function(t){this.bigImgDialog=!0,this.big_Image_url=t.couponBigImg},bigImgCancel:function(){this.bigImgDialog=!1},changeStatus:function(t){var e=this,a="";switch(t.status){case 0:a="1";break;case 1:a="-1";break;case-1:a="1";break;case"0":a="1";break;case"1":a="-1";break;case"-1":a="1";break}console.log(this.pageNum),this.$Modal.confirm({title:"更改状态",content:"是否继续更改状态？",onOk:function(){var n={templateId:t.templateId,status:a};Object(i["g"])("/merchantCouponTemplate/updStatus/?templateId="+t.templateId+"&status="+a,n).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("更改状态成功！"),setTimeout(function(){e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})},goback:function(){this.$emit("changeStatus",!1)},removeInfo:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"删除后不可恢复，是否继续删除？",onOk:function(){e.$Loading.start(),Object(i["c"])("/merchantCouponTemplate/edit/"+t.templateId).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("删除成功！"),setTimeout(function(){e.pageNum=1,e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})}},mounted:function(){this.init()}},c=r,l=(a("835b"),a("6691")),u=Object(l["a"])(c,n,o,!1,null,"13b3bf4d",null);e["default"]=u.exports}}]);