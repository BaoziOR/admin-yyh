(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20feec"],{b679:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"优惠券选择",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.viewDialogVisible,callback:function(t){e.viewDialogVisible=t},expression:"viewDialogVisible"}},[a("div",[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"couponForm",attrs:{"label-position":"right","label-width":80,model:e.couponForm,inline:""}},[a("FormItem",{staticStyle:{width:"45%"},attrs:{label:"商家名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商家名称",maxlength:20},model:{value:e.couponForm.merchantName,callback:function(t){e.$set(e.couponForm,"merchantName",t)},expression:"couponForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"50%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"优惠券名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写优惠券名称",maxlength:20},model:{value:e.couponForm.couponName,callback:function(t){e.$set(e.couponForm,"couponName",t)},expression:"couponForm.couponName"}})],1),a("FormItem",{staticStyle:{float:"right"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search("searchForm")}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":e.selectBusiness},model:{value:e.selectIndex,callback:function(t){e.selectIndex=t},expression:"selectIndex"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading,border:"",columns:e.tableColumns,data:e.listData,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"address",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.province+"/"+o.city))])]}},{key:"timer",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.useStartTime+" -- "+o.useEndTime))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize,"show-total":"","show-elevator":"",current:e.current},on:{"on-change":e.changeCurrent,"update:current":function(t){e.current=t}}})],1)],1)]),a("div",{staticStyle:{"text-align":"center",margin:"10px 0"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.couponSave}},[e._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.couponClose}},[e._v("关闭")])],1)])},n=[],i=a("7f80"),s={name:"couponModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading:"",couponForm:{merchantName:"",couponName:"",current:1},totalSize:0,current:1,selectIndex:"",selectRow:{},addressData:[],tableColumns:[{title:"操作",width:80,align:"center",slot:"action",fixed:"left"},{title:"商家名称",minWidth:150,key:"merchantName",align:"center"},{title:"省/市",minWidth:200,slot:"address",align:"center"},{title:"优惠券名称",minWidth:150,key:"title",align:"center"},{title:"有效期",minWidth:200,slot:"timer",align:"center"}],listData:[],selectDataList:[],addressValue:[]}},methods:{resetRow:function(e,t){this.couponForm.couponName=e.couponName,this.couponForm.merchantName=e.merchantName,this.addressValue=[],this.selectIndex="",this.selectRow=t,this.loadTableData()},addressLoad:function(e,t){e.loading=!0,setTimeout(function(){"beijing"===e.value?e.children=[{value:"talkingdata",label:"TalkingData"},{value:"baidu",label:"百度"},{value:"sina",label:"新浪"}]:"hangzhou"===e.value&&(e.children=[{value:"ali",label:"阿里巴巴"},{value:"163",label:"网易"}]),e.loading=!1,t()},1e3)},search:function(){this.loadTableData()},reset:function(){this.couponForm.couponName=row.couponName,this.couponForm.merchantName=row.merchantName,this.addressValue=[]},loadTableData:function(e){var t=this,a=this;this.selectDataList=[],this.totalSize=0,this.listData=[],this.TableLoading=!0;var o={page:this.couponForm.current,size:10,cityCode:this.addressValue[1]||"",couponName:this.couponForm.couponName,merchantName:this.couponForm.merchantName,provinceCode:this.addressValue[0]||""};a=this;Object(i["g"])("/coupon/merchant/list",o).then(function(e){t.TableLoading=!1,"200"===e.code?(t.totalSize=e.data.total,t.listData=e.data.records||[],t.selectRow.templateId&&t.listData.forEach(function(e,t){e.templateId==a.selectRow.templateId&&(a.selectIndex=t)})):t.$Message.error("获取数据失败")})},handleSelect:function(e,t){this.selectDataList=e},changeCurrent:function(e){this.couponForm.current!=e&&(this.couponForm.current=e,this.loadTableData())},selectBusiness:function(){this.selectRow=this.listData[this.selectIndex]},couponClose:function(){this.$emit("setViewDialogVisible",!1)},couponSave:function(){this.selectIndex||0===this.selectIndex?this.$emit("setViewDialogVisible",this.selectRow):this.$Message.error("请选择优惠券")}},created:function(){this.TableLoading=!1,console.log(2)}},l=s,c=a("6691"),r=Object(c["a"])(l,o,n,!1,null,"265f483e",null);t["default"]=r.exports}}]);