(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d225074"],{e33c:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"参与活动优惠券",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.viewDialogVisible,callback:function(t){e.viewDialogVisible=t},expression:"viewDialogVisible"}},[a("div",[a("Tabs",{attrs:{type:"card"}},[a("TabPane",{attrs:{label:"商超"}},[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"volumeForm",attrs:{"label-position":"right","label-width":80,model:e.volumeForm,inline:""}},[a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"商户名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商户名称",maxlength:20},model:{value:e.volumeForm.merchantName,callback:function(t){e.$set(e.volumeForm,"merchantName",t)},expression:"volumeForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{label:"优惠券名称",span:"24"}},[a("Input",{attrs:{placeholder:"请填写优惠券名称",maxlength:20},model:{value:e.volumeForm.couponName,callback:function(t){e.$set(e.volumeForm,"couponName",t)},expression:"volumeForm.couponName"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search(1)}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Card",[a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":function(t){return e.selectBusiness(1)}},model:{value:e.selectIndex1,callback:function(t){e.selectIndex1=t},expression:"selectIndex1"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading1,border:"",columns:e.tableColumns,data:e.listData1,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"address",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.province+"/"+o.city))])]}},{key:"timer",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.startDate+"——"+o.endDate))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize1,"show-total":"","show-elevator":"",current:e.current1},on:{"on-change":e.changeCurrent1,"update:current":function(t){e.current1=t}}})],1)],1)],1)]),a("TabPane",{attrs:{label:"商户"}},[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"volumeForm",attrs:{"label-position":"right","label-width":80,model:e.volumeForm,inline:""}},[a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"商户名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商户名称",maxlength:20},model:{value:e.volumeForm.merchantName,callback:function(t){e.$set(e.volumeForm,"merchantName",t)},expression:"volumeForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{label:"优惠券名称",span:"24"}},[a("Input",{attrs:{placeholder:"请填写优惠券名称",maxlength:20},model:{value:e.volumeForm.couponName,callback:function(t){e.$set(e.volumeForm,"couponName",t)},expression:"volumeForm.couponName"}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search(2)}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Card",[a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":function(t){return e.selectBusiness(2)}},model:{value:e.selectIndex2,callback:function(t){e.selectIndex2=t},expression:"selectIndex2"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading2,border:"",columns:e.tableColumns,data:e.listData2,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"address",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.province+"/"+o.city))])]}},{key:"timer",fn:function(t){var o=t.row;t.index;return[a("div",[e._v(e._s(o.useStartTime+"——"+o.useEndTime))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize2,"show-total":"","show-elevator":"",current:e.current2},on:{"on-change":e.changeCurrent2,"update:current":function(t){e.current2=t}}})],1)],1)],1)])],1)],1),a("div",{staticStyle:{"text-align":"center",margin:"20px 0"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.volumeSave}},[e._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.volumeClose}},[e._v("关闭")])],1)])},s=[],i=a("7f80"),l={name:"volume-modal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading1:"",TableLoading2:"",volumeForm:{merchantName:"",couponName:"",current1:1,current2:1},volumeObj:{},addressData:[],totalSize1:0,totalSize2:0,current1:1,current2:1,addressValue:[],selectIndex1:"",selectIndex2:"",tableColumns:[{title:"操作",width:80,align:"center",slot:"action",fixed:"left"},{title:"商户名称",minWidth:200,key:"merchantName"},{title:"省/市",minWidth:200,slot:"address"},{title:"优惠券名称",minWidth:200,align:"center",key:"title"},{title:"有效期",minWidth:200,slot:"timer"}],listData1:[],listData2:[],selectDataList:[]}},methods:{search:function(e){switch(e){case 1:this.loadTableData1();break;case 2:this.loadTableData2();break}},resetRow:function(e){this.volumeForm.merchantName="",this.volumeForm.couponName="",this.addressValue=[],this.volumeObj=e,this.TableLoading=!1,this.loadTableData1(e),this.loadTableData2(e)},reset:function(){this.volumeForm.merchantName="",this.volumeForm.couponName="",this.addressValue=[]},getProvinceList:function(e){var t=this;Object(i["g"])("/system/area/province/list",{}).then(function(e){"200"===e.code?(console.log(e),t.addressData=e.data||[],t.addressData.length&&t.addressData.forEach(function(e){e.value=e.provinceCode,e.label=e.shortName,e.children=[],e.loading=!1})):t.$Message.error("获取数据失败")})},addressLoad:function(e,t){var a=this;e.loading=!0,Object(i["d"])("/system/area/city/"+e.provinceCode).then(function(o){"200"===o.code?(e.children=o.data||[],e.loading=!1,e.children.length&&e.children.forEach(function(e){e.label=e.shortName,e.value=e.cityCode}),t()):(a.$Message.error("获取数据失败"),e.loading=!1,t())})},loadTableData1:function(){var e=this,t=this,a=this.volumeObj;this.totalSize1=0,this.listData1=[],this.TableLoading1=!0,this.selectIndex1="";var o={page:this.volumeForm.current1,size:10,cityCode:this.addressValue[1]||"",couponName:this.volumeForm.couponName,merchantName:this.volumeForm.merchantName,provinceCode:this.addressValue[0]||""};Object(i["g"])("/coupon/superMarket/list?pageNum=".concat(this.current1,"&pageSize=10"),o).then(function(o){e.TableLoading1=!1,"200"===o.code?(e.totalSize1=o.data.total,e.listData1=o.data.records,a&&a.awardAmount&&o.data.records.forEach(function(e,o){e.templateId===(a.awardAmount||a.award)&&(t.selectIndex1=o)})):e.$Message.error("获取数据失败")})},loadTableData2:function(){var e=this,t=this,a=this.volumeObj;this.totalSize2=0,this.listData2=[],this.TableLoading2=!0,this.selectIndex2="";var o={page:this.volumeForm.current2,size:10,cityCode:this.addressValue[1]||"",couponName:this.volumeForm.couponName,merchantName:this.volumeForm.merchantName,provinceCode:this.addressValue[0]||""};Object(i["g"])("/coupon/merchant/list?pageNum=".concat(this.current2,"&pageSize=10"),o).then(function(o){e.TableLoading2=!1,"200"===o.code?(e.totalSize2=o.data.total,e.listData2=o.data.records,a&&a.awardAmount&&o.data.records.forEach(function(e,o){e.templateId===(a.awardAmount||a.award)&&(t.selectIndex2=o)})):e.$Message.error("获取数据失败")})},handleSelect:function(e,t){this.selectDataList=e},changeCurrent1:function(e){this.volumeForm.current1!=e&&(this.volumeForm.current1=e,this.loadTableData1())},changeCurrent2:function(e){this.volumeForm.current2!=e&&(this.volumeForm.current2=e,this.loadTableData2())},selectBusiness:function(e){switch(e){case 1:this.selectIndex2="",this.volumeObj.JObj=this.listData1[this.selectIndex1],this.volumeObj.awardName=this.listData1[this.selectIndex1].title,this.volumeObj.couponType="1",this.volumeObj.awardAmount=this.listData1[this.selectIndex1].templateId;break;case 2:this.selectIndex1="",this.volumeObj.JObj=this.listData2[this.selectIndex2],this.volumeObj.awardName=this.listData2[this.selectIndex2].title,this.volumeObj.couponType="2",this.volumeObj.awardAmount=this.listData2[this.selectIndex2].templateId;break}},volumeClose:function(){this.$emit("setViewDialogVisible",!1)},volumeSave:function(){this.volumeObj.JObj||this.$Message.error({content:"请选择优惠券",duration:3}),this.$emit("setViewDialogVisible",this.volumeObj)}},created:function(){this.getProvinceList()}},n=l,r=a("6691"),c=Object(r["a"])(n,o,s,!1,null,"69416da8",null);t["default"]=c.exports}}]);