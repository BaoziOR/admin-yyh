(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f41a7c1","chunk-2d229d49"],{1521:function(e,t,a){"use strict";var r=a("70c9"),n=a.n(r);n.a},"444a":function(e,t,a){"use strict";var r=a("ced0"),n=a.n(r);n.a},4974:function(e,t,a){"use strict";a.r(t);var r,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"brand-list-box"},[a("Modal",{attrs:{title:"品牌列表",width:"900","footer-hide":"",closable:!0,"mask-closable":!1,styles:{top:"20px"}},on:{"on-cancel":e.closeDialog},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[a("div",[a("row",[a("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:e.searchItem,inline:"","label-width":70}},[a("FormItem",{attrs:{label:"品牌名称"}},[a("Input",{staticStyle:{width:"150px"},attrs:{type:"text",clearable:"",placeholder:"请输入品牌名称"},model:{value:e.searchItem.name,callback:function(t){e.$set(e.searchItem,"name",t)},expression:"searchItem.name"}})],1),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.search}},[e._v("搜索")]),a("Button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Table",{ref:"selection",staticClass:"bussiness-list",attrs:{border:"",size:"small",columns:e.tableColumns,data:e.tableData,loading:e.tableLoading}}),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{"show-total":"","show-elevator":"",current:e.page.pageNum,"page-size":e.page.pageSize,total:e.page.total},on:{"on-change":e.changeCurrent}})],1)],1),a("Row",{staticStyle:{"margin-left":"350px","margin-top":"30px"}},[a("Button",{staticStyle:{"margin-right":"20px"},on:{click:e.cancel}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.selectMerchant}},[e._v("确定")])],1)],1)],1)},s=[],i=a("3add"),o=a.n(i),l=(a("6797"),a("7f80"));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(a,!0).forEach(function(t){m(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e,t,a,r,n,s,i){try{var o=e[s](i),l=o.value}catch(c){return void a(c)}o.done?t(l):Promise.resolve(l).then(r,n)}function h(e){return function(){var t=this,a=arguments;return new Promise(function(r,n){var s=e.apply(t,a);function i(e){d(s,r,n,i,o,"next",e)}function o(e){d(s,r,n,i,o,"throw",e)}i(void 0)})}}var p={name:"brand-list",data:function(){var e=this;return{isShow:!0,searchItem:{name:""},choice:{id:"",name:""},tableColumns:[{title:"序号",type:"index",width:80,align:"center"},{title:"选择",key:"brandId",width:70,align:"center",render:function(t,a){var r=a.row.id,n=a.row.name,s=!1;s=e.choice.id==r;var i=e;return t("div",[t("Radio",{props:{value:s},on:{"on-change":function(){console.log("change",a.row),i.choice.merchantType=1,i.choice.id=r,i.choice.name=n,i.choice.row=a.row}}})])}},{title:"品牌编号",align:"center",minWidth:130,key:"id"},{title:"品牌名称",align:"center",width:230,key:"name"},{title:"关联店铺数",align:"center",minWidth:120,key:"relationMerchantCount"}],page:{pageNum:1,pageSize:10,total:0},tableLoading:!1,tableData:[]}},methods:(r={cancel:function(){this.closeDialog()},search:function(){this.page={pageNum:1,pageSize:10,total:0},this.queryTableData()},changeCurrent:function(e){this.queryTableData(e)},queryTableData:function(){var e=h(o.a.mark(function e(t){var a,r,n,s,i,c,m,d,h;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.page.pageNum=t||1,this.tableLoading=!0,a="/merchant/brandMain/selectByBrandName",e.next=5,Object(l["g"])(a,u({},this.searchItem,{},this.page));case 5:r=e.sent,n=r.code,s=r.data,i=s.current,c=s.total,m=s.size,d=s.records,h=r.msg,200==n?(this.tableData=d,this.page.pageNum=i,this.page.total=c,this.page.pageSize=m):this.msgErr(h),this.tableLoading=!1;case 15:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),closeDialog:function(){this.$emit("update:showBrandList",!1)},selectMerchant:function(){this.choice.id?(this.$emit("seclectedTr-event",this.choice),this.closeDialog()):this.msgErr("至少选一个品牌")},reset:function(){this.searchItem.name="",this.page={pageNum:1,pageSize:10},this.queryTableData()}},m(r,"changeCurrent",function(e){this.pageNum=e,this.queryTableData()}),m(r,"msgOk",function(e){this.$Message.info({content:e,duration:3})}),m(r,"msgErr",function(e){this.$Message.error({content:e,duration:3})}),r),mounted:function(){this.queryTableData()}},f=p,b=(a("1521"),a("96c9"),a("6691")),g=Object(b["a"])(f,n,s,!1,null,"843c4c9c",null);t["default"]=g.exports},"70c9":function(e,t,a){},9472:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"a",function(){return s});var r=a("2864");function n(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[r]:("00"+a[r]).substr((""+a[r]).length)));return t}function s(e,t,a,n){return new Promise(function(n,s){"image/png"!=e.type&&"image/jpeg"!=e.type&&"image/jpg"!=e.type&&"image/bmp"!=e.type&&(r["Message"].error("图片格式只能选择png/jpeg/jpg/bmp"),s());var i=new FileReader;i.onload=function(e){var i=e.target.result,o=new Image;o.onload=function(){t&&this.width!=t?(r["Notice"].warning({title:"文件尺寸超出限制",desc:"请上传宽为"+t+"的图片"}),s()):a&&this.height!=a?(r["Notice"].warning({title:"文件尺寸超出限制",desc:"请上传高为"+a+"的图片"}),s()):n()},o.onerror=s,o.src=i},i.readAsDataURL(e)})}},"96c9":function(e,t,a){"use strict";var r=a("af74"),n=a.n(r);n.a},af74:function(e,t,a){},ced0:function(e,t,a){},deb4:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Alert",e._l(e.merchantMoneyChargesRecords,function(t,r){return a("Row",{key:r,attrs:{type:"flex",justify:"center",gutter:10}},[a("Col",{attrs:{span:"4"}},[a("FormItem",{key:r,attrs:{"label-width":0,prop:"merchantMoneyChargesRecords."+r+".paymentMode",rules:{required:!0,validator:e.validateEmpty("请选择支付方式"),trigger:"blur"}}},[a("Select",{attrs:{placeholder:"请选择支付方式"},model:{value:t.paymentMode,callback:function(a){e.$set(t,"paymentMode",a)},expression:"item.paymentMode"}},e._l(e.payTypeList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),a("Col",{attrs:{span:"5"}},[a("FormItem",{key:r,attrs:{"label-width":0,prop:"merchantMoneyChargesRecords."+r+".actualAmount",rules:{required:!0,validator:e.validateMoney}}},[a("Input",{attrs:{placeholder:"请填写实际收款金额，小数点后两位",clearable:""},model:{value:t.actualAmount,callback:function(a){e.$set(t,"actualAmount",a)},expression:"item.actualAmount"}})],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{key:r,attrs:{"label-width":0,prop:"merchantMoneyChargesRecords."+r+".payee",rules:{required:!0,validator:e.validateEmpty("请填写收款人"),trigger:"blur"}}},[a("Input",{attrs:{maxlength:10,placeholder:"请填写收款人",clearable:""},model:{value:t.payee,callback:function(a){e.$set(t,"payee",a)},expression:"item.payee"}})],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{key:r,attrs:{"label-width":0,prop:"merchantMoneyChargesRecords."+r+".receivedDate",rules:{required:!0,validator:e.validateEmpty("请填写收款日期"),trigger:"blur"}}},[a("DatePicker",{attrs:{type:"datetime",placeholder:"请填写收款日期"},model:{value:t.receivedDate,callback:function(a){e.$set(t,"receivedDate",a)},expression:"item.receivedDate"}})],1)],1),a("Col",{attrs:{span:"5"}},[a("FormItem",{key:r,attrs:{"label-width":0,prop:"merchantMoneyChargesRecords."+r+".serialNumber",rules:{required:!0,validator:e.validateEmpty("请填写流水号"),trigger:"blur"}}},[a("Input",{attrs:{maxlength:20,placeholder:"请填写流水号",clearable:""},model:{value:t.serialNumber,callback:function(a){e.$set(t,"serialNumber",a)},expression:"item.serialNumber"}})],1)],1),a("Col",{attrs:{span:"2"}},[a("FormItem",{key:r,attrs:{"label-width":0}},[a("Button",{attrs:{type:"error",icon:"md-trash",size:"small"},on:{click:function(a){return e.compatible_delInfo(r,t)}}},[e._v("删除")])],1)],1)],1)}),1)],1)},n=[],s={name:"fee-entry",props:{merchantMoneyChargesRecords:{type:Array,default:function(){return[]}}},data:function(){return{payTypeList:[{id:"1",name:"现金"},{id:"2",name:"微信"},{id:"3",name:"支付宝"},{id:"4",name:"银行卡"}]}},methods:{compatible_delInfo:function(e,t){this.merchantMoneyChargesRecords.splice(e,1)},validateEmpty:function(e){return function(t,a,r){if(console.log(1111111,t,a),a+="",a=a.trim(),""==a)return r(e);r()}},validateMoney:function(e,t,a){if(t+="",t=t.trim(),""==t)return a("金额不能为空");if(!t||"0"==t||"0.0"==t||"0.00"==t)return a(new Error("金额不能为0"));var r=Number(t);if(isNaN(r))return a(new Error("请输入数字"));if(!(r>0&&r<=99999.99))return a(new Error("请输入[0.01—99999.99]之间的数"));var n=/^(0|[1-9]\d*)(\s|$|\.\d{1,2}\b)/;if(!n.test(t))return a(new Error("请输入大于等于0的金额，小数点最多包含两位小数"));a()}}},i=s,o=a("6691"),l=Object(o["a"])(i,r,n,!1,null,null,null);t["default"]=l.exports},e3a1:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"recharge-edit"},[a("div",[a("Form",{ref:"form",attrs:{"label-position":"right",model:e.formData,rules:e.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"商户类型：",prop:"merchantType"}},[a("RadioGroup",{model:{value:e.formData.merchantType,callback:function(t){e.$set(e.formData,"merchantType",t)},expression:"formData.merchantType"}},e._l(e.merchantTypeOption,function(t){return a("Radio",{key:t.value,attrs:{label:t.value}},[a("span",[e._v(e._s(t.label))])])}),1)],1),a("FormItem",{attrs:{label:"商户名称：",prop:"businessName",rules:{required:!0,validator:e.validateBusinessName}}},[a("Row",[a("Col",{attrs:{span:"16"}},[a("Input",{attrs:{placeholder:"点击按钮选择"+e.businessTypeLabel,disabled:""},model:{value:e.formData.businessName,callback:function(t){e.$set(e.formData,"businessName",t)},expression:"formData.businessName"}},[a("Button",{attrs:{slot:"append"},on:{click:e.handleChoose},slot:"append"},[e._v("选择")])],1)],1)],1)],1),a("Row",{staticClass:"box",staticStyle:{"margin-bottom":"20px"}},[a("Table",{attrs:{size:"small",border:"",width:"600px",columns:e.dynamicColumns,data:e.dynamicTableData},scopedSlots:e._u([{key:"operate",fn:function(t){var r=t.row;return[a("Button",{staticStyle:{color:"#2db7f5"},attrs:{size:"small",icon:"ios-trash-outline"},on:{click:function(t){return e.remove(r)}}},[e._v("移除")])]}}])})],1),a("FormItem",{attrs:{label:"应收款：",prop:"receivables",rules:{required:!0,validator:e.validateMoney}}},[a("Row",[a("Col",{attrs:{span:"16"}},[a("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入应收款金额，小数点后两位",clearable:""},model:{value:e.formData.receivables,callback:function(t){e.$set(e.formData,"receivables",t)},expression:"formData.receivables"}}),e._v(" 元\n          ")],1)],1)],1),a("FormItem",{attrs:{label:"合同号：",prop:"contractNumber",rules:{required:!0,validator:e.validateContractNumber}}},[a("Row",[a("Col",{attrs:{span:"16"}},[a("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入合同号",clearable:""},model:{value:e.formData.contractNumber,callback:function(t){e.$set(e.formData,"contractNumber",t)},expression:"formData.contractNumber"}})],1)],1)],1),a("FormItem",{attrs:{label:"签单销售：",prop:"biller",rules:{required:!0,validator:e.validateSalesName}}},[a("Row",[a("Col",{attrs:{span:"16"}},[a("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入销售名字",clearable:""},model:{value:e.formData.biller,callback:function(t){e.$set(e.formData,"biller",t)},expression:"formData.biller"}})],1)],1)],1),a("FormItem",{attrs:{label:"备注："}},[a("Row",[a("Col",{attrs:{span:"10"}},[a("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多500个汉字",placement:"right"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"请输入500个字符以内备注",maxlength:500},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1)],1)],1),a("FormItem",{attrs:{label:"收费条目：",prop:"merchantMoneyChargesRecords",rules:{required:!0,validator:e.validateCompatibleList}}},[a("Button",{attrs:{type:"primary",icon:"md-add-circle",size:"small"},on:{click:e.compatible_addInfo}},[e._v("新增")])],1),e.formData.merchantMoneyChargesRecords.length?a("FeeEntry",{attrs:{merchantMoneyChargesRecords:e.formData.merchantMoneyChargesRecords}}):e._e()],1)],1),a("div",{staticClass:"demo-drawer-footer"},[a("Button",{staticStyle:{"margin-right":"8px"},on:{click:e.closeDialog}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("form")}}},[e._v("保存")])],1),e.showBusinessList?a("BusinessList",{attrs:{showBusinessList:e.showBusinessList},on:{"update:showBusinessList":function(t){e.showBusinessList=t},"update:show-business-list":function(t){e.showBusinessList=t},"seclectedTr-event":e.selectedTrCallBack}}):e._e(),e.showBrandList?a("BrandList",{attrs:{showBrandList:e.showBrandList},on:{"update:showBrandList":function(t){e.showBrandList=t},"update:show-brand-list":function(t){e.showBrandList=t},"seclectedTr-event":e.selectedTrCallBack}}):e._e()],1)},n=[],s=a("3add"),i=a.n(s),o=a("9472"),l=a("d6d6"),c=a("4974"),u=a("deb4"),m=a("6797");function d(e,t,a,r,n,s,i){try{var o=e[s](i),l=o.value}catch(c){return void a(c)}o.done?t(l):Promise.resolve(l).then(r,n)}function h(e){return function(){var t=this,a=arguments;return new Promise(function(r,n){var s=e.apply(t,a);function i(e){d(s,r,n,i,o,"next",e)}function o(e){d(s,r,n,i,o,"throw",e)}i(void 0)})}}function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var f={name:"recharge-edit",components:{BusinessList:l["default"],FeeEntry:u["default"],BrandList:c["default"]},props:{showRecharge:{type:Boolean,default:!0}},computed:{dynamicColumns:function(){return 0==this.formData.merchantType?this.columns1:this.columns2},dynamicTableData:function(){return 0==this.formData.merchantType?this.tableData1:this.tableData2}},watch:p({},"formData.merchantType",function(){var e=this,t=this.formData.merchantType;this.merchantTypeOption.some(function(a){var r=a.value==t;return r&&(e.businessTypeLabel=a.label),r}),0==t?(this.formData.brandId=this.formData.businessId,this.formData.brandName=this.formData.businessName,this.formData.businessId=this.formData.merchantId,this.formData.businessName=this.formData.merchantName):(this.formData.merchantId=this.formData.businessId,this.formData.merchantName=this.formData.businessName,this.formData.businessId=this.formData.brandId,this.formData.businessName=this.formData.brandName),this.$refs.form.validateField("businessName")}),data:function(){return{isShow:!1,title:"扣款信息",data:{},businessTypeLabel:"商户",merchantTypeOption:[{value:0,label:"本地商户（单店）"},{value:1,label:"本地商户（多店）"}],formData:{changeType:0,merchantType:0,businessId:"",businessName:"",merchantId:"",merchantName:"",brandId:"",brandName:"",receivables:"",contractNumber:"",biller:"",remark:"",merchantMoneyChargesRecords:[]},ruleValidate:{},showBusinessList:!1,showBrandList:!1,tableData1:[],tableData2:[],columns1:[{title:"商户编号",align:"center",width:200,key:"merchantId"},{title:"商户名称",align:"center",width:200,key:"name"},{title:"操作",align:"center",width:140,key:"action",slot:"operate"}],columns2:[{title:"品牌名称",align:"center",width:200,key:"name"},{title:"关联店铺数",align:"center",width:200,key:"relationMerchantCount"},{title:"操作",align:"center",width:140,key:"action",slot:"operate"}]}},methods:{compatible_addInfo:function(){this.formData.merchantMoneyChargesRecords.push({id:"",paymentMode:"",actualAmount:"",payee:"",receivedDate:"",receivedDateStr:"",serialNumber:""})},selectedTrCallBack:function(e){console.log("selectedTrCallBack----",e);var t=e.merchantType,a=e.id,r=e.name,n=e.row;this.formData.businessId=a,this.formData.businessName=r,0==t?this.tableData1=[n]:this.tableData2=[n]},handleChoose:function(){0==this.formData.merchantType?this.showBusinessList=!0:this.showBrandList=!0},validateCompatibleList:function(e,t,a){if(console.log("validateCompatibleList",e,t),!t.length)return a("请填写收费条目");a()},validateBusinessName:function(e,t,a){if(t+="",t=t.trim(),""==t)return a("请选择".concat(this.businessTypeLabel));a()},validateMoney:function(e,t,a){if(t+="",t=t.trim(),""==t)return a("金额不能为空");if(!t||"0"==t||"0.0"==t||"0.00"==t)return a(new Error("兑换的金额不能为0"));var r=Number(t);if(isNaN(r))return a(new Error("请输入数字"));if(!(r>0&&r<=99999.99))return a(new Error("请输入[0.01—99999.99]之间的数"));var n=/^(0|[1-9]\d*)(\s|$|\.\d{1,2}\b)/;if(!n.test(t))return a(new Error("请输入大于等于0的金额，小数点最多包含两位小数"));a()},validateContractNumber:function(e,t,a){t+="",t=t.trim(),""==t?a(new Error("合同号不能为空,且最多支持30个字")):t.length>30?a(new Error("合同号最多支持30个字")):a()},validateSalesName:function(e,t,a){t+="",t=t.trim(),""==t?a(new Error("签单销售不能为空")):t.length>30?a(new Error("签单销售最多支持30个字")):a()},remove:function(){var e=this.formData.merchantType;this.formData.businessId="",this.formData.businessName="",0==e?(this.formData.merchantId="",this.formData.merchantName="",this.tableData1=[]):(this.formData.brandId="",this.formData.brandName="",this.tableData2=[])},changeDrawType:function(e){console.log(e)},closeDialog:function(){console.log("closeDialog"),this.$emit("update:showRecharge",!1)},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(){var e=h(i.a.mark(function e(a){var r,n,s,l,c;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=16;break}return t.$Message.success("数据验证成功!"),r=JSON.parse(JSON.stringify(t.formData)),console.log("o1Form",r),r.merchantMoneyChargesRecords=r.merchantMoneyChargesRecords.map(function(e){return e.receivedDateStr=Object(o["b"])(new Date(e.receivedDate),"yyyy-MM-dd hh:mm:ss"),e}),console.log("oForm",r),n=r.merchantType,0==n?(r.merchantId=r.businessId,r.merchantName=r.businessName):(r.brandId=r.businessId,r.brandName=r.businessName),e.next=10,Object(m["oc"])(r);case 10:s=e.sent,l=s.code,c=s.msg,200==l?(t.msgOk("保存成功"),t.closeDialog(),t.$emit("refresh")):t.msgErr(c),e.next=17;break;case 16:t.$Message.error("数据验证失败！");case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}}},b=f,g=(a("444a"),a("6691")),y=Object(g["a"])(b,r,n,!1,null,"1559c485",null);t["default"]=y.exports}}]);