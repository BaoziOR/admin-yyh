(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01d1713c","chunk-501b04b4"],{"0a1b":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bannerway"},[i("Card",{staticClass:"add-bannerway-row",staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[i("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(t){return e.addOrEdit("add")}}},[e._v("新增")]),e._v("  \n    "),i("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:e.goback}},[e._v("返回列表")])],1),i("Card",{attrs:{bordered:!1}},[i("Table",{attrs:{border:"",loading:e.loading,columns:e.columns,data:e.tableData},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row;return[i("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addOrEdit("edit",a)}}},[e._v("编辑")]),2==a.status?i("Button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.updateOperationStatus(a)}}},[e._v("上架")]):e._e(),1==a.status?i("Button",{attrs:{type:"warning",size:"small"},on:{click:function(t){return e.underUpdateOperationStatus(a)}}},[e._v("下架")]):e._e()]}},{key:"createAndModifiedBy",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.modifiedBy||a.createBy))])]}},{key:"gmtModifiedAndCreate",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.gmtModified||a.gmtCreate))])]}},{key:"totalPlayer",fn:function(t){var a=t.row;return[i("a",{staticClass:"underline",attrs:{href:"javascript:;"},on:{click:function(t){return e.showTotalPlayer(a.id)}}},[e._v(e._s(a.totalPlayer))])]}},{key:"totalTicket",fn:function(t){var a=t.row;return[i("a",{staticClass:"underline",attrs:{href:"javascript:;"},on:{click:function(t){return e.showTotalTicket(a.id)}}},[e._v(e._s(a.totalTicket))])]}},{key:"idLinkUrl",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.drawId||a.linkUrl))])]}},{key:"img",fn:function(t){var a=t.row;return[i("Button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.showBigImg(a)}}},[e._v("查看")])]}}])}),i("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[i("Page",{attrs:{"show-total":"","show-elevator":"",total:e.page.total,current:e.page.pageNum,"page-size":e.page.pageSize},on:{"on-change":e.changeCurrent}})],1)],1),i("Modal",{attrs:{width:"600","footer-hide":!0},on:{"on-cancel":e.bigImgCancel},model:{value:e.bigImgDialog,callback:function(t){e.bigImgDialog=t},expression:"bigImgDialog"}},[i("img",{staticStyle:{width:"100%"},attrs:{src:e.bigImageUrl}})]),i("bannerway-edit",{attrs:{action:e.action},on:{refresh:e.queryTableList}}),i("Modal",{attrs:{closable:!0,"mask-closable":!1,width:"400"},model:{value:e.undercarriage,callback:function(t){e.undercarriage=t},expression:"undercarriage"}},[i("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"ios-information-circle"}}),i("span",[e._v("下架")])],1),i("div",[i("Form",{ref:"formValidate",attrs:{"label-position":"top",model:e.formValidate,rules:e.ruleValidate}},[i("FormItem",{attrs:{label:"填写原因：",prop:"reason"}},[i("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"填写下架原因..."},model:{value:e.formValidate.reason,callback:function(t){e.$set(e.formValidate,"reason",t)},expression:"formValidate.reason"}})],1)],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"error",size:"large"},on:{click:function(t){return e.putoff("formValidate")}}},[e._v("确认")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.cancelHandleReset("formValidate")}}},[e._v("取消")])],1)])],1)},r=[],n=i("6797"),o=i("e6e6"),l=i("a6c7");function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(i,!0).forEach(function(t){d(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u={name:"bannerway",components:d({},l["default"].name,l["default"]),data:function(){var e=function(e,t,i){t+="",t=t.trim(),""==t?i(new Error("下架原因不能为空")):t.length<10?i(new Error("下架原因不得少于10个字")):i()};return{modalAddModify:!1,action:{id:Math.random(),type:"add"},bigImgDialog:!1,bigImageUrl:"",id:"",undercarriage:!1,formValidate:{reason:""},ruleValidate:{reason:[{required:!0,validator:e,trigger:"blur"}]},loading:!1,page:{pageNum:1,pageSize:10,total:0},columns:o["a"],tableData:[]}},created:function(){this.queryTableList()},methods:{goback:function(){this.$emit("changeComp","draw-config")},showBigImg:function(e){this.bigImgDialog=!0,this.bigImageUrl=e.imgUrl},bigImgCancel:function(){this.bigImgDialog=!1},cancelHandleReset:function(e){var t=this;this.undercarriage=!1,this.$nextTick(function(){t.$refs[e].resetFields()})},putoff:function(e){var t=this;this.$refs[e].validate(function(i){i&&Object(n["yc"])({id:t.id,nextStatus:2,reason:t.formValidate.reason}).then(function(i){200==i.code?(t.msgOk("下架成功"),t.queryTableList()):t.msgErr(i.msg),t.cancelHandleReset(e)})})},updateBanner:function(e){},updateOperationStatus:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"<p>确定要上架吗？</p>",onOk:function(){Object(n["yc"])({id:e.id,nextStatus:1}).then(function(e){200==e.code?(t.msgOk("上架成功"),t.queryTableList()):t.msgErr(e.msg)})},onCancel:function(){t.msgOk("上架已取消")}})},underUpdateOperationStatus:function(e){this.undercarriage=!0,this.id=e.id},changeCurrent:function(e){this.queryTableList(e)},queryTableList:function(e){var t=this;this.page.pageNum=e||1,this.loading=!0,Object(n["Zb"])(c({},this.page)).then(function(e){200==e.code?(t.tableData=e.data.records,t.page.pageNum=e.data.current,t.page.total=e.data.total,t.page.pageSize=e.data.size,t.loading=!1):(t.$Message.error(e.code+" 数据加载失败!",3),t.loading=!1)})},addOrEdit:function(e,t){this.action={id:Math.random(),type:e,data:t}},reset:function(){this.page={pageNum:1,pageSize:10}},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}}},f=u,m=i("6691"),g=Object(m["a"])(f,a,r,!1,null,"3e1f9d18",null);t["default"]=g.exports},"4c9c":function(e,t,i){"use strict";var a=i("764b"),r=i.n(a);r.a},"764b":function(e,t,i){},a6c7:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bannerwayEdit"},[i("Modal",{attrs:{closable:!0,"mask-closable":!1},on:{"on-cancel":e.closeDialog},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[i("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"ios-information-circle"}}),i("span",[e._v(e._s(e.title))])],1),i("div",[i("Form",{ref:"formValidate",attrs:{"label-position":"left",model:e.formValidate,rules:e.ruleValidate,"label-width":100}},[i("FormItem",{attrs:{prop:"drawType"}},[i("RadioGroup",{on:{"on-change":e.changeDrawType},model:{value:e.formValidate.drawType,callback:function(t){e.$set(e.formValidate,"drawType",t)},expression:"formValidate.drawType"}},e._l(e.drawTypeList,function(t){return i("Radio",{key:t.value,attrs:{label:t.value}},[i("span",[e._v(e._s(t.label))])])}),1)],1),1==e.formValidate.drawType?i("FormItem",{attrs:{prop:"checkDrawType",rules:{required:!0,validator:e.validateCheckDrawType,trigger:"blur"}}},[i("Input",{attrs:{type:"text"},model:{value:e.formValidate.checkDrawType,callback:function(t){e.$set(e.formValidate,"checkDrawType",t)},expression:"formValidate.checkDrawType"}})],1):e._e(),i("FormItem",{attrs:{label:"上传图片：",prop:"imgUrl"}},[e._l(e.uploadList,function(t){return i("div",{key:t.imgUrl,staticClass:"demo-upload-list"},[i("img",{attrs:{src:t.imgUrl}}),i("div",{staticClass:"demo-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){return e.handleView(t.imgUrl)}}}),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){return e.handleRemove(t)}}})],1)])}),i("div",{staticStyle:{display:"inline"}},[i("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"90px"},attrs:{headers:e.userToken,type:"drag",format:["jpg","jpeg","png","bmp"],"show-upload-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess,action:e.url,accept:"image","max-size":1024,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError}},[i("div",{staticStyle:{width:"90px",height:"90px","line-height":"90px"}},[i("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),i("p",{staticStyle:{"font-size":"12px"}},[e._v("选择图片(不大于1M,JPG/PNG/JPEG/BMP）")])],1)],2),i("FormItem",{attrs:{label:"上线时间：",prop:"onlineTime"}},[i("DatePicker",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"datetime",options:e.m_dateOptions,placeholder:"请选择抽奖日期",format:"yyyy-MM-dd HH:mm",value:e.formValidate.onlineTime},on:{"on-change":e.changeTime}})],1),i("FormItem",{attrs:{label:"下线时间：",prop:"offlineTime"}},[i("DatePicker",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"datetime",options:e.m_dateOptions,placeholder:"请选择抽奖日期",format:"yyyy-MM-dd HH:mm",value:e.formValidate.offlineTime},on:{"on-change":e.changeOfflineTime}})],1),i("FormItem",{attrs:{label:"排序字段：",prop:"rankNum"}},[i("Input",{attrs:{number:"",type:"text",placeholder:"排序字段，值越大优先级越高..."},model:{value:e.formValidate.rankNum,callback:function(t){e.$set(e.formValidate,"rankNum",t)},expression:"formValidate.rankNum"}})],1)],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"error",size:"large"},on:{click:function(t){return e.save("formValidate")}}},[e._v("确认")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.cancelHandleReset("formValidate")}}},[e._v("取消")])],1)]),i("Modal",{attrs:{"footer-hide":!0},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.formValidate.imgUrl}}):e._e()])],1)},r=[],n=i("3add"),o=i.n(n),l=i("6797"),s=i("365c"),c=i("62a2"),d=i("872c");function u(e,t,i,a,r,n,o){try{var l=e[n](o),s=l.value}catch(c){return void i(c)}l.done?t(s):Promise.resolve(s).then(a,r)}function f(e){return function(){var t=this,i=arguments;return new Promise(function(a,r){var n=e.apply(t,i);function o(e){u(n,a,r,o,l,"next",e)}function l(e){u(n,a,r,o,l,"throw",e)}o(void 0)})}}var m={mixins:[d["a"]],name:"bannerway-edit",props:{action:{type:Object,default:function(){return{type:"add"}}}},watch:{action:{handler:function(e,t){var i=this,a=this.action,r=a.type,n=a.data;this.isShow=!0,"add"==r?(this.title="添加任务抽奖banner",Object.keys(this.formValidate).forEach(function(e){i.formValidate[e]=""})):(this.title="修改任务抽奖banner",this.$nextTick(function(){Object.keys(i.formValidate).forEach(function(e){i.formValidate[e]=n[e]});var e=n.drawId,t=n.linkUrl,a=e?1:2;i.formValidate.drawType=a,i.formValidate.checkDrawType=1==a?e:t,i.uploadList=[{imgUrl:n.imgUrl}]}))},deep:!0}},data:function(){var e=function(e,t,i){t+="",t=t.trim(),""==t?i(new Error("请选择类型")):i()},t=function(e,t,i){if(t+="",""==t.trim())return i();if(-1!=t.indexOf("."))return i(new Error("请输入整数"));var a=parseInt(t);return isNaN(a)?i(new Error("请输入整数")):a!=t?i(new Error("请输入整数")):(a>=1&&a<=99999&&i(),void i(new Error("请输入[1—99999]之间的整数")))};return{userToken:{},url:s["g"],uploadList:[],visible:!1,isShow:!1,title:"新增",data:{},drawTypeList:[{value:1,label:"抽奖id"},{value:2,label:"抽奖链接"}],formValidate:{id:"",drawType:"",checkDrawType:"",drawId:"",linkUrl:"",imgUrl:"",onlineTime:"",offlineTime:"",rankNum:""},ruleValidate:{drawType:[{required:!0,validator:e,trigger:"blur"}],imgUrl:[{required:!0,message:"请上传图片",trigger:"blur"}],onlineTime:[{required:!0,type:"string",message:"请选择上线时间",trigger:"change"}],offlineTime:[{required:!0,type:"string",message:"请选择下线时间",trigger:"change"}],rankNum:[{validator:t,trigger:"blur"}]}}},created:function(){this.userToken={jwttoken:localStorage.getItem("jwttoken")}},methods:{validateCheckDrawType:function(e,t,i){if(""===t){var a="";if(""==this.formValidate.drawType)return this.$refs.formValidate.validateField("drawType");1==this.formValidate.drawType&&(a="请输入抽奖id"),i(new Error(a))}else{if(1==this.formValidate.drawType){if(t+="",-1!=t.indexOf("."))return i(new Error("请输入整数"));var r=parseInt(t);if(isNaN(r))return i(new Error("请输入整数"));if(r!=t)return i(new Error("请输入整数"))}i()}},changeDrawType:function(e){console.log(e)},closeDialog:function(){this.$refs.formValidate.resetFields(),this.uploadList=[]},handleView:function(e){this.formValidate.imgUrl=e,this.visible=!0},handleRemove:function(e){this.$refs.upload.fileList=[],this.uploadList=[],this.formValidate.imgUrl=""},handleUploadSuccess:function(e,t){if(200==e.code){var i=e.image_url;this.uploadList=[{imgUrl:i}],this.formValidate.imgUrl=i,this.$Message.info("上传图片成功")}else this.$Message.error("上传图片失败，请重新上传")},handleMaxSize:function(e){this.$Message.error("图片不大于1M")},handleFormatError:function(){this.msgErr("只能上传jpg,jpeg,png,bmp格式,请重新上传")},handleBeforeUpload:function(e){return Object(c["a"])(e)},changeTime:function(e){this.formValidate.onlineTime=e},changeOfflineTime:function(e){this.formValidate.offlineTime=e},showBigImg:function(e){this.bigImgDialog=!0,this.bigImageUrl=e.imgUrl},bigImgCancel:function(){this.bigImgDialog=!1},cancelHandleReset:function(e){var t=this;e=e||"formValidate",this.isShow=!1,this.$nextTick(function(){t.$refs[e].resetFields(),t.uploadList=[],t.formValidate={id:"",drawType:1,checkDrawType:"",drawId:"",linkUrl:"",imgUrl:"",onlineTime:"",offlineTime:"",rankNum:""}})},save:function(e){var t=this;this.$refs[e].validate(function(){var e=f(o.a.mark(function e(i){var a,r,n,s,c;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=13;break}return a=JSON.parse(JSON.stringify(t.formValidate)),r=a.drawType,n=a.checkDrawType,1==r?a.drawId=n:a.linkUrl=n,delete a.checkDrawType,s=null,s="add"==t.action.type?l["a"]:l["J"],e.next=9,s(a);case 9:c=e.sent,200==c.code?(t.cancelHandleReset(),t.$emit("refresh")):t.msgErr(c.msg),e.next=14;break;case 13:t.$Message.error("数据验证失败！");case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}}},g=m,p=(i("4c9c"),i("6691")),h=Object(p["a"])(g,a,r,!1,null,"7c5b75f6",null);t["default"]=h.exports},e6e6:function(e,t,i){"use strict";i.d(t,"d",function(){return a}),i.d(t,"e",function(){return r}),i.d(t,"c",function(){return n}),i.d(t,"a",function(){return o}),t["b"]=[{title:"操作",align:"center",width:200,fixed:"left",slot:"action"},{type:"index",width:60,title:"序号",align:"center"},{key:"id",title:"ID",align:"center",width:120},{title:"状态",key:"statusName",align:"center",width:120},{title:"团类型",key:"groupType",align:"center",minWidth:100},{key:"name",title:"抽奖名称",align:"center",minWidth:140},{title:"大奖",key:"bigPrizeName",align:"center",minWidth:140},{title:"阳光普照奖",key:"normalPrizeName",align:"center",minWidth:140},{title:"抽奖开始时间",key:"startTime",align:"center",width:170},{title:"抽奖开奖时间",key:"openDrawTime",align:"center",width:170},{title:"广告主",key:"advertName",align:"center",minWidth:80},{title:"最近修改人",key:"createAndModifiedBy",align:"center",minWidth:105,slot:"createAndModifiedBy"},{title:"最近修改时间",key:"gmtModifiedAndCreate",align:"center",width:170,slot:"gmtModifiedAndCreate"},{title:"报名成功用户",key:"totalPlayer",align:"center",minWidth:120,slot:"totalPlayer"},{title:"排列五数字",key:"winningRefValue",align:"center",minWidth:140},{title:"抽奖券",key:"totalTicket",align:"center",minWidth:140,slot:"totalTicket"},{title:"开奖结果",key:"winningRefValue",align:"center",minWidth:140,slot:"result"}];var a=[{title:"昵称",key:"nickName",align:"center"},{title:"手机号",key:"phoneNumber",align:"center"},{title:"报名时间",key:"join_time",align:"center"}],r=[{title:"昵称",key:"nickName",align:"center"},{title:"奖券",key:"ticket_code",align:"center"},{title:"手机号",key:"phoneNumber",align:"center"}],n=[{title:"昵称",key:"nickName",align:"center"},{title:"奖项",key:"prize",align:"center"},{title:"收件人",key:"realName",align:"center"},{title:"手机号",key:"phoneNumber",align:"center"},{title:"邮寄地址",key:"address",align:"center"},{title:"发放状态",key:"statusName",align:"center"},{title:"奖品发送失败备注",key:"memo",align:"center"},{title:"物流信息",key:"logistics",align:"center",slot:"logistics"}],o=[{title:"操作",align:"center",width:200,fixed:"left",slot:"action"},{title:"抽奖id或链接",key:"nickName",align:"center",slot:"idLinkUrl"},{title:"图片",key:"imgUrl",align:"center",slot:"img"},{title:"最近修改人",key:"createAndModifiedBy",align:"center",minWidth:105,slot:"createAndModifiedBy"},{title:"最近修改时间",key:"gmtModifiedAndCreate",align:"center",width:170,slot:"gmtModifiedAndCreate"},{title:"上架时间",key:"onlineTime",align:"center"}]}}]);