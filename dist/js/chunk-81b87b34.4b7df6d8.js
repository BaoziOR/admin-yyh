(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81b87b34","chunk-cbc1a068"],{"00cc":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[t.merchantEditPage||t.merchantCouponPage||t.merchantStaffPage?t._e():a("Row",[a("Col",[a("Card",[a("Row",[a("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":70}},[a("FormItem",{attrs:{label:"商户名称"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入商户名称"},model:{value:t.searchItem.name,callback:function(e){t.$set(t.searchItem,"name",e)},expression:"searchItem.name"}})],1),a("FormItem",[a("span",[t._v("所在地区")]),a("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getcitylist},model:{value:t.searchItem.provinceId,callback:function(e){t.$set(t.searchItem,"provinceId",e)},expression:"searchItem.provinceId"}},t._l(t.provincelist,function(e,n){return a("Option",{key:n,attrs:{value:e.provinceCode}},[t._v(t._s(e.provinceName))])}),1),a("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getarealist},model:{value:t.searchItem.cityId,callback:function(e){t.$set(t.searchItem,"cityId",e)},expression:"searchItem.cityId"}},t._l(t.citylist,function(e,n){return a("Option",{key:n,attrs:{value:e.cityCode}},[t._v(t._s(e.cityName))])}),1),a("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:t.searchItem.areaId,callback:function(e){t.$set(t.searchItem,"areaId",e)},expression:"searchItem.areaId"}},t._l(t.arealist,function(e,n){return a("Option",{key:n,attrs:{value:e.areaCode}},[t._v(t._s(e.areaName))])}),1)],1),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.queryTableList}},[t._v("搜索")]),a("Button",{on:{click:t.refresh}},[t._v("重置")])],1)],1)],1)],1),a("Card",[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){return t.addInfo()}}},[t._v("新增")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.updateTableList}},[t._v("刷新")])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:t.TableLoading,border:"",columns:t.tableColumns,data:t.table_list,sortable:"custom"},scopedSlots:t._u([{key:"address",fn:function(e){var a=e.row;return[t._v("\n          "+t._s(a.province)+" "+t._s(a.city)+" "+t._s(a.district)+" "+t._s(a.address)+"\n          ")]}},{key:"logoImg",fn:function(e){var n=e.row;return[a("img",{staticStyle:{width:"74px",height:"43px"},attrs:{src:n.logoImg},on:{click:function(e){return t.showBigImg(n)}}})]}},{key:"operate",fn:function(e){var n=e.row;return[a("Button",{staticStyle:{color:"#2db7f5"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(n)}}},[t._v("编辑")]),a("Button",{staticStyle:{color:"#ed4014"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.copyInfo(n)}}},[t._v("复制")])]}}],null,!1,2143521752)})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1)],1)],1),t.merchantEditPage?a("div",[a("merchantEdit",{attrs:{merchantId:t.merchantId},on:{changeStatus:t.showMerchantEditStatus}})],1):t._e(),t.merchantCouponPage?a("div",[a("merchantCoupon",{attrs:{merchantId:t.merchantId},on:{changeStatus:t.showMerchantCouponStatus}})],1):t._e(),t.merchantStaffPage?a("div",[a("merchantStaff",{attrs:{merchantId:t.merchantId},on:{changeStatus:t.showMerchantStaffStatus}})],1):t._e(),a("Modal",{attrs:{title:"查看大图",width:"600"},on:{"on-cancel":t.bigImgCancel},model:{value:t.bigImgDialog,callback:function(e){t.bigImgDialog=e},expression:"bigImgDialog"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.big_Image_url}})])],1)},i=[],r=a("7f80"),s=(a("62a2"),a("d546")),o=a("8d0a"),c=a("885e"),l={name:"merchant-information",components:{merchantEdit:s["default"],merchantCoupon:o["default"],merchantStaff:c["default"]},data:function(){return{merchantEditPage:!1,merchantCouponPage:!1,merchantStaffPage:!1,merchantId:"",drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{name:"",provinceId:"",cityId:"",areaId:""},current:1,totalSize:0,pageNum:1,limit:10,TableLoading:!1,table_list:[],self:this,bigImgDialog:!1,big_Image_url:"",tableColumns:[{title:"商户id",key:"merchantId",sortable:!0,align:"center",minWidth:140},{title:"商户名称",key:"name",align:"center",minWidth:120},{title:"商户logo信息",align:"center",minWidth:120,key:"logoImg",slot:"logoImg"},{title:"主品牌",key:"mainBrandName",align:"center",minWidth:120},{title:"主营类目",key:"industryName",align:"center",minWidth:120},{title:"商户地址",key:"address",align:"center",slot:"address",minWidth:220},{title:"营业状态",key:"operatingStatusName",align:"center",minWidth:120},{title:"创建人",key:"createBy",align:"center",minWidth:120},{title:"创建时间",key:"createTime",align:"center",minWidth:120},{title:"编辑人",key:"updateBy",align:"center",minWidth:120},{title:"编辑时间",key:"updateTime",align:"center",minWidth:120},{title:"操作",key:"action",fixed:"left",align:"center",slot:"operate",minWidth:200}],staffList:[],res_list:[],provincelist:[],citylist:[],arealist:[]}},created:function(){},methods:{init:function(){this.updateTableList(),this.getindustryTemplate(),this.getprovincelist()},getprovincelist:function(){var t=this;Object(r["g"])("/system/area/province/list").then(function(e){200==e.code?t.provincelist=e.data:t.$Message.error(e.msg)})},getcitylist:function(){var t=this;Object(r["c"])("/system/area/city/"+this.searchItem.provinceId).then(function(e){200==e.code?(t.citylist=e.data,t.searchItem.areaId=""):t.$Message.error(e.msg)})},getarealist:function(){var t=this;Object(r["c"])("/system/area/district/"+this.searchItem.cityId).then(function(e){200==e.code?t.arealist=e.data:t.$Message.error(e.msg)})},getindustryTemplate:function(){var t=this,e={dictCode:"merchant_industry"};Object(r["g"])("/system/sys-dict-data/list?pageNum=1&pageSize=30",e).then(function(e){200==e.code?t.res_list=e.data.records:t.$Message.error(e.msg)})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},refresh:function(){this.searchItem.name="",this.searchItem.provinceId="",this.searchItem.cityId="",this.searchItem.areaId="",this.updateTableList()},queryTableList:function(){this.current=1,this.totalSize=0,this.pageNum=1,this.updateTableList()},changeCurrent:function(t){this.pageNum=t,this.updateTableList()},updateTableList:function(){var t=this;this.TableLoading=!0;var e=this.searchItem;Object(r["g"])("/merchant/merchantInfo/list?pageNum="+this.pageNum+"&pageSize="+this.limit,e).then(function(e){t.TableLoading=!1,e.isSuccess?(t.totalSize=e.data.total,t.table_list=e.data.records):t.$Message.error(e.msg)})},addInfo:function(){this.setStore("camp_pageStatus","add"),this.merchantEditPage=!0},editInfo:function(t){console.log(t),this.setStore("camp_pageStatus","edit"),this.merchantId=t.merchantId,this.merchantEditPage=!0},copyInfo:function(t){this.setStore("camp_pageStatus","copy"),this.merchantId=t.merchantId,this.merchantEditPage=!0},showMerchantEditStatus:function(t){this.merchantEditPage=t,this.updateTableList()},merchantCouponInfo:function(t){this.merchantId=t.merchantId,this.merchantCouponPage=!0},showMerchantCouponStatus:function(t){this.merchantCouponPage=t,this.updateTableList()},merchantStaffInfo:function(t){this.merchantId=t.merchantId,this.merchantStaffPage=!0},showMerchantStaffStatus:function(t){this.merchantStaffPage=t,this.updateTableList()},showBigImg:function(t){this.bigImgDialog=!0,this.big_Image_url=t.logoImg},bigImgCancel:function(){this.bigImgDialog=!1},changeStatus:function(t){var e=this,a=this,n="",i="",s="";switch(t.status){case 0:s="1",n="发布成功";break;case 1:s="-1",n="下架成功",i="下架后商户关联的员工和优惠券都会失效,</br>";break;case-1:s="1",n="发布成功";break}var o={merchantId:t.merchantId};Object(r["g"])("/merchant/merchantEmployee/list?isAsc=DESC&orderByColumn=1&pageNum=1&pageSize="+this.limit,o).then(function(o){e.staffList=o.data.records,e.staffList.length>0||1==t.status?e.$Modal.confirm({title:"更改状态",content:i+"是否继续更改状态？ ",onOk:function(){var e={merchantId:t.merchantId,status:s};Object(r["g"])("/merchant/merchantInfo/updateStatus/?merchantId="+t.merchantId+"&status="+s,e).then(function(t){a.loading=!1,"200"==t.code?(a.$Message.info(n),setTimeout(function(){a.updateTableList()},3200)):a.$Message.error(t.msg)})},onCancel:function(){a.$Message.info("点击了取消")}}):e.$Modal.error({title:"提醒",content:"至少存在一个员工，才允许商户发布上线 "})})},removeInfo:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"删除后不可恢复，是否继续删除？",onOk:function(){var a={merchantId:t.merchantId};Object(r["g"])("/merchant/merchantInfo/delete?merchantId="+t.merchantId,a).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("删除成功！"),setTimeout(function(){e.pageNum=1,e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})}},mounted:function(){this.init()}},d=l,u=(a("6268"),a("6691")),h=Object(u["a"])(d,n,i,!1,null,"1b5e7654",null);e["default"]=h.exports},4167:function(t,e,a){},"5a9f":function(t,e,a){"use strict";var n=a("d880"),i=a.n(n);i.a},6268:function(t,e,a){"use strict";var n=a("face"),i=a.n(n);i.a},"835b":function(t,e,a){"use strict";var n=a("4167"),i=a.n(n);i.a},"885e":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.merchantStaffAddPage?t._e():a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{attrs:{inline:""}},[a("FormItem",{attrs:{label:"员工手机号：","label-width":85}},[a("InputNumber",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入员工手机号",clearable:"",max:99999999999,min:0},nativeOn:{keyup:function(e){return t.changeNumber1(e)}},model:{value:t.searchData.mobile,callback:function(e){t.$set(t.searchData,"mobile",e)},expression:"searchData.mobile"}})],1),a("FormItem",{attrs:{label:"商户名称：","label-width":85}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商户名称"},model:{value:t.searchData.merchantName,callback:function(e){t.$set(t.searchData,"merchantName",e)},expression:"searchData.merchantName"}})],1),a("FormItem",{attrs:{label:"状态：","label-width":85}},[a("Select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择状态"},model:{value:t.searchData.status,callback:function(e){t.$set(t.searchData,"status",e)},expression:"searchData.status"}},[a("Option",{attrs:{value:"-1"}},[t._v("全部")]),a("Option",{attrs:{value:"0"}},[t._v("正常")]),a("Option",{attrs:{value:"1"}},[t._v("已禁用")])],1)],1),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.search}},[t._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("Card",{attrs:{bordered:!1}},[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:t.addInfo}},[t._v("新增")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.search}},[t._v("刷新")])],1),a("div",[a("Table",{attrs:{border:"",width:"100%",columns:t.columns8,data:t.staffList,loading:t.TableLoading},scopedSlots:t._u([{key:"wxQrcode",fn:function(e){var n=e.row;return[""!=n.wxQrcode?a("img",{staticStyle:{width:"40px"},attrs:{src:n.wxQrcode},on:{click:function(e){return t.wxQrcodeLook(n.wxQrcode)}}}):t._e()]}},{key:"action",fn:function(e){var n=e.row;return["0"==n.status?a("Button",{staticStyle:{color:"#f39913"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.inputUnbinding(n)}}},[t._v("禁用")]):t._e(),"1"==n.status?a("Button",{staticStyle:{color:"#368029"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.inputUnbinding(n)}}},[t._v("解禁")]):t._e(),a("Button",{staticStyle:{color:"#2db7f5"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(n)}}},[t._v("编辑")])]}}],null,!1,234777226)})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent}})],1)],1)],1),a("Modal",{attrs:{title:"禁用/解禁原因",width:"600","footer-hide":"",closable:!1,"mask-closable":!1},model:{value:t.unbindDisplay,callback:function(e){t.unbindDisplay=e},expression:"unbindDisplay"}},[a("Divider",{staticStyle:{"margin-top":"-10px"}},[t._v("员工编号："+t._s(t.banRemark.employeeId))]),a("Row",[a("Input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"200个字符以内原因",clearable:"",rows:2},model:{value:t.banRemark.remark,callback:function(e){t.$set(t.banRemark,"remark",e)},expression:"banRemark.remark"}})],1),a("Row",{staticStyle:{margin:"10px 0 0 456px"}},[a("Button",{attrs:{type:"text"},on:{click:function(e){t.unbindDisplay=!1}}},[t._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:t.ban}},[t._v(t._s(t.banRemark.title))])],1),a("div",[a("Divider",[t._v("操作日志")])],1),a("Table",{attrs:{height:"350",columns:t.columns1,data:t.data1}})],1),a("Modal",{attrs:{title:"查看二维码",width:"350","footer-hide":""},model:{value:t.wxQrcodeDisplay,callback:function(e){t.wxQrcodeDisplay=e},expression:"wxQrcodeDisplay"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.wxQrcode_url}})]),1==t.merchantStaffAddPage?a("div",[a("merchantStaffAdd",{attrs:{employeeId:t.employeeId},on:{changeStatus:t.showMerchantStaffAddStatus}})],1):t._e()],1)},i=[],r=a("6797"),s=a("7f80"),o=a("365c"),c=a("4bbb");function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d={name:"merchant-staff",components:{merchantStaffAdd:c["default"]},data:function(){var t;return{employeeId:"",merchantStaffAddPage:!1,drop:!1,dropDownIcon:"ios-arrow-down",columns1:[{title:"操作者",key:"operater"},{title:"操作类型",key:"operateType"},{title:"原因",key:"remark"},{title:"操作时间",key:"time"}],data1:[],columns8:[{title:"操作",align:"center",width:180,fixed:"left",slot:"action"},{title:"编号",align:"center",width:140,key:"employeeId"},(t={title:"关联商户",align:"center",minWidth:200,ellipsis:!0},l(t,"align","left"),l(t,"key","merchantNames"),l(t,"render",function(t,e){return t("div",[t("Tooltip",{props:{placement:"top"}},[t("span",{style:{display:"inline-block",width:.85*e.column._width+"px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.row.merchantNames),t("span",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.merchantNames)])])}),t),{title:"名称",align:"center",minWidth:120,key:"realName"},{title:"手机号",align:"center",minWidth:120,key:"mobile"},{title:"角色类型",ellipsis:!0,align:"left",minWidth:200,key:"roles",render:function(t,e){return t("div",[t("Tooltip",{props:{placement:"top"}},[t("span",{style:{display:"inline-block",width:.85*e.column._width+"px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.row.roles),t("span",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.roles)])])}},{title:"状态",align:"center",minWidth:120,key:"statusName"},{title:"来源",align:"center",minWidth:120,key:"status"},{title:"员工岗位描述",align:"center",minWidth:120,key:"postDesc"},{title:"员工微信号",align:"center",minWidth:120,key:"wxAccount"},{title:"微信号二维码",align:"center",minWidth:120,key:"wxQrcode",slot:"wxQrcode"}],staffList:[],searchData:{status:"",merchantName:"",mobile:null},current:1,totalSize:0,TableLoading:!1,merchantList:[],addStaffDisplay:!1,formValidate:{merchantId:"",mobile:null,postDesc:"",profile:"",realName:"",serviceContent:"",wxAccount:"",wxQrcode:""},uploadList1:[],url:o["g"],userToken:{},editStaffDisplay:!1,editEmployeeId:"",banRemark:{employeeId:"",remark:"",type:"",title:"禁用"},unbindDisplay:!1,wxQrcodeDisplay:!1,wxQrcode_url:""}},created:function(){this.searchData.merchantId=this.merchantId,this.formValidate.merchantId=this.merchantId,this.getMerchantListFn(),this.search(),this.userToken={jwttoken:localStorage.getItem("jwttoken")}},methods:{showMerchantStaffAddStatus:function(t){this.merchantStaffAddPage=t,this.search()},addInfo:function(){this.setStore("pageStatus","add"),this.merchantStaffAddPage=!0},editInfo:function(t){this.setStore("pageStatus","edit"),this.employeeId=t.employeeId,this.merchantStaffAddPage=!0},init:function(){},search:function(){this.current=1,this.totalSize=0,this.getStaffListFn(this.searchData)},reset:function(){this.searchData.realName="",this.searchData.mobile=null,this.pagingType="1",this.search()},getMerchantListFn:function(){var t=this;Object(r["Ab"])().then(function(e){200==e.code?t.merchantList=e.data.records:t.msgErr(e.msg)})},getStaffListFn:function(t){var e=this;this.TableLoading=!0;var a=t.status;"-1"==a&&(a=null);var n={status:a,merchantName:t.merchantName,mobile:t.mobile};Object(r["Pb"])(n,this.current).then(function(t){200==t.code?(e.staffList=t.data.records,e.current=t.data.current,e.totalSize=t.data.total,e.TableLoading=!1):(e.TableLoading=!1,e.msgErr(t.msg))})},handleSuccess2:function(t,e){if(200==t.code){this.formValidate.wxQrcode=t.image_url;var a=[{url:t.image_url}];this.uploadList1=a,this.msgOk("上传图片成功")}else this.msgErr("上传图片失败，请重新上传")},handleMaxSize:function(){this.msgErr("上传图片不能超过1MB,请重新上传")},formatError:function(){this.msgErr("只能上传jpg,jpeg,png,bmp格式,请重新上传")},addStaffFn:function(){var t=this;this.ruleValidate()&&Object(r["r"])(this.formValidate).then(function(e){200==e.code?(t.msgOk("新增成功"),t.search(),t.cancel()):t.msgErr(e.msg)})},cancel:function(){this.editEmployeeId="",this.formValidate.mobile=null,this.formValidate.postDesc="",this.formValidate.profile="",this.formValidate.realName="",this.formValidate.serviceContent="",this.formValidate.wxAccount="",this.formValidate.wxQrcode="",this.addStaffDisplay=!1,this.editStaffDisplay=!1},inputUnbinding:function(t){this.banRemark.employeeId=t.employeeId,this.banRemark.remark="",this.banRemark.status=t.status,t.remark?this.data1=JSON.parse(t.remark):this.data1=[],"0"==this.banRemark.status?this.banRemark.title="禁用":"1"==this.banRemark.status&&(this.banRemark.title="解禁"),this.unbindDisplay=!0},ban:function(){var t=this;console.info(this.banRemark);var e="";if("0"==this.banRemark.status?e="禁用":"1"==this.banRemark.status&&(e="解禁"),""!=this.banRemark.remark.trim()){var a={employeeId:this.banRemark.employeeId,remark:this.banRemark.remark.trim(),status:this.banRemark.status};Object(s["g"])("/merchant/merchantEmployee/ban",a).then(function(a){200==a.code?(t.msgOk(e+"成功"),t.unbindDisplay=!1,t.search()):t.msgErr(a.msg)})}else this.msgErr(e+"原因不能为空")},delStaffFn:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"<p>确认删除当前员工吗？</p>",onOk:function(){Object(r["F"])(t).then(function(t){200==t.code?(e.msgOk("删除成功"),e.search()):e.msgErr(t.msg)})},onCancel:function(){}})},changeCurrent:function(t){this.current=t,this.getStaffListFn(this.searchData)},wxQrcodeLook:function(t){this.wxQrcode_url=t,this.wxQrcodeDisplay=!0},changeNumber:function(){var t=""+this.formValidate.mobile;if(-1!=t.indexOf(".")){var e=t.split("");e.splice(e.length-1);var a=e.join("");this.formValidate.mobile=+a,this.msgErr("只能输入整数")}},changeNumber1:function(){var t=""+this.searchData.mobile;if(-1!=t.indexOf(".")){var e=t.split("");e.splice(e.length-1);var a=e.join("");this.searchData.mobile=+a,this.msgErr("只能输入整数")}},changeNumber2:function(){var t=""+this.bindData.mobile;if(-1!=t.indexOf(".")){var e=t.split("");e.splice(e.length-1);var a=e.join("");this.bindData.mobile=+a,this.msgErr("只能输入整数")}},ruleValidate:function(){if(""!=this.formValidate.realName)if(null!=this.formValidate.mobile){var t=/^[1][3,4,5,7,8][0-9]{9}$/;if(t.test(this.formValidate.mobile))if(""!=this.formValidate.wxAccount)if(""!=this.formValidate.wxQrcode)if(""!=this.formValidate.postDesc)if(""!=this.formValidate.profile){if(""!=this.formValidate.serviceContent)return!0;this.msgErr("员工服务内容不能为空")}else this.msgErr("员工一句话描述不能为空");else this.msgErr("员工岗位不能为空");else this.msgErr("员工微信号二维码没有上传");else this.msgErr("员工微信号不能为空");else this.msgErr("请输入常规手机号")}else this.msgErr("员工电话不能为空");else this.msgErr("员工名称不能为空")},msgOk:function(t){this.$Message.info({content:t,duration:3})},msgErr:function(t){this.$Message.error({content:t,duration:3})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},back:function(){this.$emit("changeStatus",!1)}},mounted:function(){this.init()}},u=d,h=(a("5a9f"),a("6691")),m=Object(h["a"])(u,n,i,!1,null,"2e65a20e",null);e["default"]=m.exports},"8d0a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[t.couponEditPage?t._e():a("Row",[a("div",{staticStyle:{width:"90%",background:"#fff","box-shadow":"0 6px 6px -4px rgba(0,0,0,.2)","z-index":"5",position:"fixed",padding:"14px"}},[t.merchantId?a("Alert",{attrs:{"show-icon":""}},[t._v("\n         商户编号 :  "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.merchantId))]),a("span",{attrs:{slot:"desc"},slot:"desc"})]):t._e()],1),a("div",{staticStyle:{"padding-top":"100px"}},[a("Card",[a("Row",[a("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":120}},[a("FormItem",{attrs:{label:"优惠券模版ID"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入优惠券模版ID"},model:{value:t.searchItem.templateId,callback:function(e){t.$set(t.searchItem,"templateId",e)},expression:"searchItem.templateId"}})],1),t.drop?a("span",[a("FormItem",{attrs:{label:"优惠券标题\t"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入优惠券标题\t"},model:{value:t.searchItem.title,callback:function(e){t.$set(t.searchItem,"title",e)},expression:"searchItem.title"}})],1),a("FormItem",{attrs:{label:"优惠券种类"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择优惠券种类",clearable:""},model:{value:t.searchItem.couponKind,callback:function(e){t.$set(t.searchItem,"couponKind",e)},expression:"searchItem.couponKind"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("免费券")]),a("Option",{attrs:{value:"2"}},[t._v("付费券")])],1)],1),a("FormItem",{attrs:{label:"用券有效期类型"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择用券有效期类型",clearable:""},model:{value:t.searchItem.useDateType,callback:function(e){t.$set(t.searchItem,"useDateType",e)},expression:"searchItem.useDateType"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("固定时间范围")]),a("Option",{attrs:{value:"2"}},[t._v("相对有效期")])],1)],1),a("FormItem",{attrs:{label:"优惠类型"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择优惠类型",clearable:""},model:{value:t.searchItem.couponType,callback:function(e){t.$set(t.searchItem,"couponType",e)},expression:"searchItem.couponType"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("固定金额")]),a("Option",{attrs:{value:"2"}},[t._v("折扣")])],1)],1),a("FormItem",{attrs:{label:"状态"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:t.searchItem.status,callback:function(e){t.$set(t.searchItem,"status",e)},expression:"searchItem.status"}},[a("Option",{attrs:{value:""}},[t._v("所有")]),a("Option",{attrs:{value:"1"}},[t._v("上架")]),a("Option",{attrs:{value:"-1"}},[t._v("下架")])],1)],1)],1):t._e(),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.queryTableList}},[t._v("搜索")]),a("Button",{on:{click:t.refresh}},[t._v("重置")]),a("a",{staticClass:"drop-down",on:{click:t.dropDown}},[t._v("\n                "+t._s(t.dropDownContent)+"\n                "),a("Icon",{attrs:{type:t.dropDownIcon}})],1)],1)],1)],1)],1),a("Card",[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(e){return t.goback()}}},[t._v("返回")]),a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){return t.addInfo()}}},[t._v("新增")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.updateTableList}},[t._v("刷新")])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:t.TableLoading,border:"",columns:t.tableColumns,data:t.table_list,sortable:"custom"},scopedSlots:t._u([{key:"couponBigImg",fn:function(e){var n=e.row;return[a("Tooltip",{attrs:{content:"点击可查看大图 ",placement:"right"}},[a("img",{staticStyle:{width:"74px",height:"43px"},attrs:{src:n.couponBigImg},on:{click:function(e){return t.showBigImg(n)}}})])]}},{key:"ticketMoney",fn:function(e){var n=e.row;return[1==n.couponType?a("span",[t._v(t._s(n.ticketMoney/100)+" 元")]):t._e(),2==n.couponType?a("span",[t._v(t._s(n.ticketDiscount/10)+" 折")]):t._e()]}},{key:"ChangeStart",fn:function(e){var n=e.row;return[1==n.useDateType?a("span",[t._v(" "+t._s(n.useStartDate))]):t._e(),2==n.useDateType?a("span",[t._v(" 加"+t._s(n.addDaysUseStart)+"天开始生效")]):t._e()]}},{key:"ChangeEnd",fn:function(e){var n=e.row;return[1==n.useDateType?a("span",[t._v(" "+t._s(n.useEndDate))]):t._e(),2==n.useDateType?a("span",[t._v(" 加"+t._s(n.addDaysUseEnd)+"天结束用券")]):t._e()]}},{key:"price",fn:function(e){var n=e.row;return[2==n.couponKind?a("span",[t._v(t._s(n.price/100)+" 元 ")]):a("span",[t._v("免费")])]}},{key:"operate",fn:function(e){var n=e.row;return[0==n.status?a("Button",{staticStyle:{color:"#2db7f5"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(n)}}},[t._v("编辑")]):t._e(),0==n.status||-1==n.status?a("Button",{staticStyle:{color:"#19be6b"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.changeStatus(n)}}},[t._v("发布")]):t._e(),1==n.status?a("Button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.changeStatus(n)}}},[t._v("下架")]):t._e()]}}],null,!1,1362173866)})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1)],1)]),t.couponEditPage?a("div",[a("couponEdit",{attrs:{couponEdit_info:t.couponEdit_info},on:{changeStatus:t.showbasicSetStatus}})],1):t._e(),a("Modal",{attrs:{title:"查看大图",width:"600"},on:{"on-cancel":t.bigImgCancel},model:{value:t.bigImgDialog,callback:function(e){t.bigImgDialog=e},expression:"bigImgDialog"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.big_Image_url}})])],1)},i=[],r=a("7f80"),s=(a("62a2"),a("7599")),o={name:"merchant-information",components:{couponEdit:s["default"]},props:{merchantId:String},data:function(){return{couponEditPage:!1,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{templateId:"",title:"",couponKind:"",couponType:"",useDateType:"",status:""},couponEdit_info:{},current:1,totalSize:0,pageNum:1,limit:10,TableLoading:!1,table_list:[],self:this,bigImgDialog:!1,big_Image_url:"",tableColumns:[{title:"商户编号",key:"merchantId",align:"center",width:150},{title:"优惠券模板ID",key:"templateId",sortable:!0,align:"center",width:150},{title:"优惠券标题",key:"title",align:"center",width:150},{title:"优惠券详情图",align:"center",width:120,key:"couponBigImg",slot:"couponBigImg"},{title:"优惠类型",key:"couponType",align:"center",width:150,render:function(t,e){var a=e.row,n=1===a.couponType?"blue":"red",i=1===a.couponType?"固定金额":"折扣";return t("Tag",{props:{color:n}},i)}},{title:"优惠金额/优惠折扣",align:"center",width:150,slot:"ticketMoney"},{title:"优惠券种类",key:"couponKind",width:150,align:"center",render:function(t,e){var a=e.row,n=1===a.couponKind?"green":2===a.couponKind?"blue":"red",i=1===a.couponKind?"免费券":2===a.couponKind?"付费券":"其他";return t("Tag",{props:{color:n}},i)}},{title:"购买价格(单位为元)",key:"price",align:"center",width:150,slot:"price"},{title:"活动开始时间",key:"startDate",align:"center",width:150},{title:"活动结束时间",key:"endDate",align:"center",width:150},{title:"用券有效期类型",key:"useDateType",align:"center",width:150,render:function(t,e){var a=e.row,n=1===a.useDateType?"blue":"red",i=1===a.useDateType?"固定时间范围":"相对有效期";return t("Tag",{props:{color:n}},i)}},{title:"用券开始时间",width:200,align:"center",slot:"ChangeStart"},{title:"用券结束时间",width:200,align:"center",slot:"ChangeEnd"},{title:"状态",key:"status",width:150,align:"center",render:function(t,e){var a=e.row,n=0===a.status?"green":1===a.status?"blue":"red",i=0===a.status?"创建":1===a.status?"上架":"下架";return t("Tag",{props:{color:n}},i)}},{title:"用户限领数量",key:"getLimit",align:"center",width:150},{title:"库存数量",key:"stockCount",align:"center",width:150},{title:"操作",key:"action",fixed:"left",align:"center",slot:"operate",width:200}]}},created:function(){},methods:{init:function(){this.updateTableList()},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},refresh:function(){this.searchItem.templateId="",this.searchItem.title="",this.searchItem.couponKind="",this.searchItem.couponType="",this.searchItem.useDateType="",this.searchItem.status="",this.updateTableList()},queryTableList:function(){this.updateTableList()},changeCurrent:function(t){this.pageNum=t,this.updateTableList()},updateTableList:function(){var t=this;this.TableLoading=!0;var e={merchantId:this.merchantId,templateId:this.searchItem.templateId,title:this.searchItem.title,couponKind:this.searchItem.couponKind,couponType:this.searchItem.couponType,useDateType:this.searchItem.useDateType,status:this.searchItem.status};Object(r["g"])("/merchantCouponTemplate/list?pageNum="+this.pageNum+"&pageSize="+this.limit,e).then(function(e){t.TableLoading=!1,t.totalSize=e.data.total,t.table_list=e.data.records})},addInfo:function(){this.setStore("camp_pageStatus","add"),this.couponEdit_info.merchantId=this.merchantId,this.couponEditPage=!0},editInfo:function(t){this.setStore("camp_pageStatus","edit"),this.couponEdit_info=t,this.couponEditPage=!0},showbasicSetStatus:function(t){this.couponEditPage=t,this.updateTableList()},showBigImg:function(t){this.bigImgDialog=!0,this.big_Image_url=t.couponBigImg},bigImgCancel:function(){this.bigImgDialog=!1},changeStatus:function(t){var e=this,a="";switch(t.status){case 0:a="1";break;case 1:a="-1";break;case-1:a="1";break;case"0":a="1";break;case"1":a="-1";break;case"-1":a="1";break}console.log(this.pageNum),this.$Modal.confirm({title:"更改状态",content:"是否继续更改状态？",onOk:function(){var n={templateId:t.templateId,status:a};Object(r["g"])("/merchantCouponTemplate/updStatus/?templateId="+t.templateId+"&status="+a,n).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("更改状态成功！"),setTimeout(function(){e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})},goback:function(){this.$emit("changeStatus",!1)},removeInfo:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"删除后不可恢复，是否继续删除？",onOk:function(){e.$Loading.start(),Object(r["c"])("/merchantCouponTemplate/edit/"+t.templateId).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("删除成功！"),setTimeout(function(){e.pageNum=1,e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})}},mounted:function(){this.init()}},c=o,l=(a("835b"),a("6691")),d=Object(l["a"])(c,n,i,!1,null,"13b3bf4d",null);e["default"]=d.exports},d880:function(t,e,a){},face:function(t,e,a){}}]);