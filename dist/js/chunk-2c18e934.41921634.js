(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c18e934","chunk-743dd334"],{"05791":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Row",[i("Col",{attrs:{span:"4"}},[i("FormItem",{attrs:{prop:"drawDailyShopList["+e.index+"].provinceCode",rules:{required:!0,message:"请选择省份"}}},[i("Select",{attrs:{placeholder:"选择省","label-in-value":!0},on:{"on-change":e.provinceChange},model:{value:e.provinceCode,callback:function(t){e.provinceCode=t},expression:"provinceCode"}},e._l(e.provinceList,function(t,o){return i("Option",{key:o,attrs:{value:t.provinceCode}},[e._v(e._s(t.provinceName))])}),1)],1)],1),i("Col",{attrs:{span:"4"}},[i("FormItem",{attrs:{prop:"drawDailyShopList["+e.index+"].cityCode",rules:{required:!0,message:"请选择市"}}},[i("Select",{attrs:{placeholder:"选择市","label-in-value":!0},on:{"on-change":e.cityChange},model:{value:e.cityCode,callback:function(t){e.cityCode=t},expression:"cityCode"}},e._l(e.cityList,function(t,o){return i("Option",{key:o,attrs:{value:t.cityCode}},[e._v(e._s(t.cityName))])}),1)],1)],1),i("Col",{attrs:{span:"4"}},[i("FormItem",{attrs:{prop:"drawDailyShopList["+e.index+"].countryCode",rules:{required:!0,message:"请选择区"}}},[i("Select",{attrs:{placeholder:"选择区","label-in-value":!0},on:{"on-change":e.areaChange},model:{value:e.countryCode,callback:function(t){e.countryCode=t},expression:"countryCode"}},e._l(e.areaList,function(t,o){return i("Option",{key:o,attrs:{value:t.areaCode}},[e._v(e._s(t.areaName))])}),1)],1)],1),i("Col",{attrs:{span:"4"}},[i("FormItem",{attrs:{prop:"drawDailyShopList["+e.index+"].shopId",rules:{required:!0,message:"请选择门店"}}},[i("Select",{attrs:{placeholder:"选择门店","label-in-value":!0},on:{"on-change":e.shopIdChange},model:{value:e.shopId,callback:function(t){e.shopId=t},expression:"shopId"}},e._l(e.shopList,function(t,o){return i("Option",{key:o,attrs:{value:t.shopId}},[e._v(e._s(t.shopName))])}),1)],1)],1),i("Col",{attrs:{span:"2"}},[i("Button",{attrs:{type:"dashed",long:"",icon:"ios-close"},on:{click:function(t){return e.handleRemove()}}})],1)],1)],1)},n=[],a=i("7f80"),s={props:{id:Number,index:Number,shop:{type:Object,default:function(){return{}}}},data:function(){return{isInit:0,provinceList:[],cityList:[],areaList:[],shopList:[],provinceCode:null,cityCode:null,countryCode:null,shopId:null,provinceName:null,cityName:null,districtName:null}},methods:{loadProvinceList:function(){var e=this;return Object(a["h"])("/system/area/province/list").then(function(t){200==t.code?(e.provinceList=t.data,["provinceCode","cityCode","countryCode","shopId"].forEach(function(t){e[t]=e.shop[t]})):e.$Message.error(t.msg)})},provinceChange:function(e,t){var i=this;this.cityList=[],this.areaList=[],this.shopList=[],this.cityCode=null,this.countryCode=null,this.shopId=null,this.cityName=null,this.districtName=null,this.provinceName=e.label,this.$emit("sendProvinceId",this.provinceCode,this.shop.id),Object(a["d"])("/system/area/city/"+this.provinceCode).then(function(e){200==e.code?i.cityList=e.data:i.$Message.error(e.msg)})},cityChange:function(e,t){var i=this;this.areaList=[],this.shopList=[],this.countryCode=null,this.shopId=null,this.districtName=null,this.cityName=e?e.label:null,this.$emit("sendCityId",this.cityCode,this.shop.id),Object(a["d"])("/system/area/district/"+this.cityCode).then(function(e){200==e.code?(i.areaList=e.data,t&&t()):i.$Message.error(e.msg)})},areaChange:function(e){this.shopList=[],this.shopId=null,this.districtName=e?e.label:null,this.$emit("sendAreaId",this.countryCode,this.shop.id),this.loadShops()},shopIdChange:function(e){e?this.$emit("sendShopId",this.shopId,e.label,this.shop.id):this.$emit("sendShopId",this.shopId,null,this.shop.id)},loadShops:function(){var e=this;return this.provinceName?this.cityName?this.districtName?void Object(a["g"])("/system/sys-shop-info/list?pageNum=1&pageSize=2000",{province:this.provinceName,city:this.cityName,district:this.districtName}).then(function(t){200==t.code?e.shopList=t.data.records:e.$Message.error(t.msg)}):this.$Message.error("请选择区域"):this.$Message.error("请选择区县"):this.$Message.error("请选择省份")},handleRemove:function(){this.$emit("handleRemove-event",this.shop.id)},init:function(){var e=this;Object(a["g"])("/system/area/province/list").then(function(t){return 200==t.code?e.provinceList=t.data:e.$Message.error(t.msg),t}).then(function(t){return e.shop.provinceCode&&(e.provinceCode=e.shop.provinceCode,e.provinceName=e.provinceList.find(function(t){return t.provinceCode==e.provinceCode}).provinceName),t}).then(function(t){Object(a["d"])("/system/area/city/"+e.provinceCode).then(function(t){return 200==t.code?(e.cityList=t.data,e.cityCode=e.shop.cityCode,e.countryCode=null,e.shop.cityCode&&(e.cityName=e.cityList.find(function(t){return t.cityCode==e.cityCode}).cityName)):e.$Message.error(t.msg),t}).then(function(t){e.shop.cityCode&&Object(a["d"])("/system/area/district/"+e.cityCode).then(function(t){200==t.code?(e.areaList=t.data,e.countryCode=e.shop.countryCode,e.shop.countryCode&&(e.districtName=e.areaList.find(function(t){return t.areaCode==e.countryCode}).areaName),e.shop.shopId&&(e.shopId="".concat(e.shop.shopId),e.loadShops())):e.$Message.error(t.msg)})})})}},mounted:function(){var e=this;this.$nextTick(function(){e.loadProvinceList(),e.shop.provinceCode&&e.init()})}},r=s,c=i("6691"),l=Object(c["a"])(r,o,n,!1,null,null,null);t["default"]=l.exports},"10b3":function(e,t,i){},"1e28":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("span",{staticClass:"label"},[e._v(e._s(e.label))]),e._l(e.uploadList,function(t){return i("div",{key:t.uid,staticClass:"demo-upload-list"},[i("img",{attrs:{src:t.imgUrl}}),i("div",{staticClass:"demo-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){return e.handleView(t.imgUrl)}}}),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){return e.handleRemove(t)}}})],1)])}),i("div",{staticStyle:{display:"inline"}},[i("Upload",{ref:"upload",style:e.uploadStyle,attrs:{headers:e.userToken,type:e.dragType,format:["jpg","jpeg","png","bmp"],"show-upload-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess,action:e.url,accept:"image","max-size":1024,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError}},[0==e.uploadList.length?[i("div",{staticStyle:{width:"90px",height:"90px","line-height":"90px"}},[i("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]:[i("Button",{attrs:{size:"small",icon:"ios-cloud-upload-outline"}},[e._v("更改")])]],2)],1),i("Modal",{attrs:{"footer-hide":!0},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.imgUrl}}):e._e()])],2)},n=[],a=i("365c"),s=i("62a2"),r={name:"upload-image",props:{label:{type:String,default:""},defaultList:{type:Array,default:function(){return[]}},fileUploadType:{type:[String,Number],default:""}},watch:{defaultList:{handler:function(){this.uploadList=[];for(var e=0;e<this.defaultList.length;e++){var t=this.defaultList[e];this.uploadList.push(t)}},immediate:!0}},computed:{uploadStyle:function(){return 0==this.uploadList.length?"display: inline-block;width:90px;":"float:'left';padding-top:60px;"},dragType:function(){return this.uploadList.length?"select":"drag"}},data:function(){return{userToken:{},url:a["g"],uploadList:[],imgUrl:"",visible:!1}},created:function(){this.userToken={jwttoken:localStorage.getItem("jwttoken")}},mounted:function(){this.defaultList.length&&(this.uploadList=this.defaultList)},methods:{handleView:function(e){this.imgUrl=e,this.visible=!0},handleRemove:function(e){this.uploadList=[]},handleUploadSuccess:function(e,t,i){if(200==e.code){this.uploadList=[];var o=e.image_url;t.imgUrl=o,this.$emit("uploadSuccess",{fileUploadType:this.fileUploadType,imgUrl:o}),this.uploadList.push(t),this.$Message.info("上传图片成功")}else this.$Message.error("上传图片失败，请重新上传")},handleMaxSize:function(e){this.$Message.error("图片不大于1M")},handleFormatError:function(){this.msgErr("只能上传jpg,jpeg,png,bmp格式,请重新上传")},handleBeforeUpload:function(e){return Object(s["a"])(e)},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}}},c=r,l=(i("6b61"),i("6691")),h=Object(l["a"])(c,o,n,!1,null,"79811e88",null);t["default"]=h.exports},"6b61":function(e,t,i){"use strict";var o=i("10b3"),n=i.n(o);n.a},d260:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Alert",{attrs:{type:"warning"}},[e._v("请点击选择优惠券类型，按搜索，选择需要的优惠券")]),i("Form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":100}},[i("FormItem",{staticStyle:{display:"inline-block"},attrs:{label:"优惠券类型："}},[i("Select",{staticStyle:{width:"200px"},on:{"on-change":e.optionChange},model:{value:e.searchForm.couponType,callback:function(t){e.$set(e.searchForm,"couponType",t)},expression:"searchForm.couponType"}},e._l(e.couponTypeList,function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),i("FormItem",{staticStyle:{display:"inline-block"},attrs:{label:"优惠券名称："}},[i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),i("FormItem",{staticClass:"br",attrs:{"label-width":10}},[i("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.search}},[e._v("搜索")])],1)],1),i("Table",{ref:"selection",attrs:{border:"",columns:e.tableColumns,data:e.tableData,"highlight-row":!0,loading:e.loading}}),i("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[i("Page",{attrs:{"show-total":"","show-elevator":"",total:e.page.total,current:e.page.pageNum,"page-size":e.page.pageSize},on:{"on-change":e.changeCurrent}})],1),i("Row",{staticStyle:{"margin-left":"350px","margin-top":"30px"}},[i("Button",{staticStyle:{"margin-right":"20px"},on:{click:e.cancel}},[e._v("取消")]),i("Button",{attrs:{type:"primary"},on:{click:e.selectMerchant}},[e._v("确定")])],1)],1)},n=[],a=(i("7f80"),i("6797")),s={props:{prizeType:{type:String,default:""},couponType:{type:[String,Number],default:2}},computed:{tableColumns:function(){return 1==this.searchForm.couponType?this.columns1:this.columns2}},watch:{prizeType:function(){}},data:function(){var e=this;return{searchForm:{couponType:2,name:""},loading:!1,page:{pageNum:1,pageSize:10,total:0},tableData:[],choice:{id:"",name:""},couponTypeList:[{value:2,label:"超市券"},{value:1,label:"周边券"}],columns1:[{title:"选择",key:"chooseTemplateId",width:70,align:"center",render:function(t,i){var o=i.row.templateId,n=i.row.title,a=!1;a=e.choice.id==o;var s=e;return t("div",[t("Radio",{props:{value:a},on:{"on-change":function(){s.choice.id=o,s.choice.name=n}}})])}},{title:"优惠券ID",align:"center",minWidth:140,key:"templateId"},{title:"优惠券名称",align:"center",minWidth:140,key:"title"},{title:"所属商户",align:"center",minWidth:140,key:"merchantName"}],columns2:[{title:"选择",key:"chooseCampId",width:70,align:"center",render:function(t,i){var o=i.row.campId,n=i.row.name,a=!1;a=e.choice.id==o;var s=e;return t("div",[t("Radio",{props:{value:a},on:{"on-change":function(){s.choice.id=o,s.choice.name=n}}})])}},{title:"优惠券ID",align:"center",minWidth:140,key:"campId"},{title:"优惠券名称",align:"center",minWidth:140,key:"name"}]}},methods:{changeCurrent:function(e){this.page.pageNum=e,this.search()},optionChange:function(){this.tableData=[],this.searchForm.name="",this.page.pageNum=1,this.choice.couponType=this.searchForm.couponType,this.search()},search:function(){var e=this;if(!this.searchForm.couponType)return this.msgErr("请选择优惠券类型");var t="",i={};2==this.searchForm.couponType?(t="/campagin/list",i={isEffective:1,campType:57,status:1,sendChannel:1,name:this.searchForm.name}):(t="/merchantCouponTemplate/backList",i={isActivityCoupon:null,templateStatus:"进行中",title:this.searchForm.name}),this.loading=!0,Object(a["nb"])(t,i,this.page.pageNum).then(function(t){200==t.code?(e.tableData=t.data.records,e.page.pageNum=t.data.current,e.page.total=t.data.total,e.page.pageSize=t.data.size):e.$Message.error(t.code+" 数据加载失败!",3),e.loading=!1})},selectedTr:function(){this.$emit("seclectedTr-event",{prizeType:this.prizeType,couponType:this.couponType,id:this.id,name:this.name})},changeCurren:function(e){this.searchForm.pageNum!=e&&(this.searchForm.pageNum=e,this.search())},selectMerchant:function(){this.choice.id?(this.merchantTabDisplay=!1,this.choice.prizeType=this.prizeType,this.choice.couponType=this.searchForm.couponType,this.$emit("seclectedTr-event",this.choice)):this.msgErr("至少选一个商户")},cancel:function(){this.choice={id:"",name:""},this.$emit("seclectedTr-event",!1)},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}},mounted:function(){this.search()}},r=s,c=i("6691"),l=Object(c["a"])(r,o,n,!1,null,null,null);t["default"]=l.exports}}]);