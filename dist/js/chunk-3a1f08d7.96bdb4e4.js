(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a1f08d7","chunk-57d8dcc4"],{"86b5":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.viewDialogVisible?a("div",{staticClass:"modal",on:{click:function(e){e.stopPropagation()}}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("下载")]),a("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(t){return e.close()}}},[e._v("返回上一层")])],1),a("Form",{ref:"addOrEditModal",attrs:{model:e.modal,rules:e.ruleValidate,"label-width":80,"label-position":"left"}},[a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"商户名称："}},[a("Select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择商户类型"},model:{value:e.modal.expandType,callback:function(t){e.$set(e.modal,"expandType",t)},expression:"modal.expandType"}},e._l(e.typeList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),1==e.modal.expandType?a("Button",{staticStyle:{"min-width":"150px"},attrs:{type:"dashed",disabled:!e.modal.expandType},on:{click:e.openBusiness}},[e.selectBusinessObj.name?e._e():a("span",[e._v("请选择商户名称")]),e.selectBusinessObj.name?a("span",[e._v(e._s(e.selectBusinessObj.name))]):e._e()]):e._e(),2==e.modal.expandType?a("Button",{staticStyle:{"min-width":"150px"},attrs:{type:"dashed",disabled:!e.modal.expandType},on:{click:e.openBrand}},[e.selectBrandObj.name?e._e():a("span",[e._v("请选择品牌名称")]),e.selectBrandObj.name?a("span",[e._v(e._s(e.selectBrandObj.name))]):e._e()]):e._e()],1)],1)],1),2==e.modal.expandType&&e.brandList.length?a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:""}},e._l(e.brandList,function(t){return a("div",[e._v(e._s(t.name))])}),0)],1)],1):e._e(),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"套餐：",span:"24"}},[a("Select",{staticStyle:{width:"150px"},model:{value:e.modal.merchantType,callback:function(t){e.$set(e.modal,"merchantType",t)},expression:"modal.merchantType"}},e._l(e.packageList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1)],1)],1),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"拓客时间："}},[a("DatePicker",{staticStyle:{width:"150px"},attrs:{value:e.modal.expandTimeStart,type:"date",options:e.options1},on:{"on-change":function(t){e.changeDateTime(t,1)}}}),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),a("DatePicker",{staticStyle:{width:"150px"},attrs:{value:e.modal.expandTimeEnd,type:"date",options:e.options2},on:{"on-change":function(t){e.changeDateTime(t,2)}}})],1)],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.downLoad}},[e._v("下载")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.close}},[e._v("关闭")])],1)],1)],1),a("brandModal",{ref:"brandModal",attrs:{viewDialogVisible:e.brandVolumeModal},on:{setViewDialogVisible:e.selectBrand}}),a("businessModal",{ref:"businessModal",attrs:{viewDialogVisible:e.businessVolumeModal},on:{setViewDialogVisible:e.selectBusiness}})],1):e._e()},i=[],n=a("7f80"),o=a("2c67"),l=a("3cbc"),r={name:"downLoadModal",components:{brandModal:o["default"],businessModal:l["default"]},props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{brandVolumeModal:!1,businessVolumeModal:!1,timeList1:24,timeList2:60,typeList:[{value:"1",label:"本地商户(单店)"},{value:"2",label:"本地商户(多店)"}],statusList:[{value:"1",label:"未生效"},{value:2,label:"已生效"},{value:3,label:"已完成"}],packageList:[{value:"",label:"全部"},{value:1,label:"精准拓客"},{value:2,label:"平台拓客"}],modal:{expandType:"1",expandTimeStart:"",expandTimeEnd:"",static:""},brandList:[],options1:{},options2:{},selectBusinessObj:{},selectBrandObj:{},ruleValidate:{requiredType:[{required:!0,message:"",trigger:"blur"}]}}},methods:{changeDateTime:function(e,t){switch(t){case 1:this.modal.expandTimeStart=e,this.options2={disabledDate:function(t){return t.valueOf()<new Date(e)-864e5}};break;case 2:this.modal.expandTimeEnd=e,this.options1={disabledDate:function(t){return t.valueOf()>new Date(e)}};break}},resetRow:function(){this.expandType="1",this.expandTimeStart="",this.expandTimeEnd="",this.static="",this.brandList=[],this.selectBusinessObj={},this.selectBrandObj={}},getPackageData:function(e,t){var a=this;Object(n["g"])("/merchant/merchantBrand/list/merchant",{brandId:e,brandLevel:1}).then(function(e){"200"===e.code?a.brandList=e.data||[]:(a.$Message.error(e.msg),a.brandList=[])})},openBusiness:function(e){var t=this;this.businessVolumeModal=!0,this.$nextTick(function(){t.$refs["businessModal"].resetRow(t.selectBusinessObj)})},selectBusiness:function(e){this.selectBusinessObj=e,this.businessVolumeModal=!1,e&&e.merchantId},openBrand:function(e){var t=this;this.brandVolumeModal=!0,this.$nextTick(function(){t.$refs["brandModal"].resetRow(t.selectBrandObj)})},selectBrand:function(e){this.selectBrandObj=e,this.brandVolumeModal=!1,e&&e.id&&this.getPackageData(e.id,2)},downLoad:function(){if(this.modal.expandType)if("1"!=this.modal.expandType||this.selectBusinessObj.name)if("2"!=this.modal.expandType||this.selectBrandObj.name){var e={expandTimeEnd:this.modal.expandTimeEnd,expandTimeStart:this.modal.expandTimeStart,expandType:this.modal.expandType,merchantName:this.modal.merchantName,merchantType:this.modal.merchantType,status:this.modal.status,merchantIds:[]};"1"==this.modal.expandType?(e.merchantName=this.selectBusinessObj.name,e.merchantIds.push(this.selectBusinessObj.merchantId)):"2"==this.modal.expandType&&(e.merchantName=this.selectBrandObj.name,this.brandList.forEach(function(t,a){e.merchantIds.push(t.merchantId)})),Object(n["b"])("/merchant/platform/expand/download",e).then(function(e){var t=e.data,a=e.headers["filename"],s=new Blob([t],{type:"application/vnd.ms-excel"});if("download"in document.createElement("a")){var i=document.createElement("a");i.download=decodeURI(a),i.style.display="none",i.href=URL.createObjectURL(s),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}else navigator.msSaveBlob(s,a)})}else this.$Message.error("请选择品牌名称");else this.$Message.error("请选择商户名称");else this.$Message.error("请选择商户类型")},close:function(){this.$emit("setViewDialogVisible",!1)}}},c=r,d=(a("9fc4"),a("6691")),h=Object(d["a"])(c,s,i,!1,null,"62fc2b5c",null);t["default"]=h.exports},"8bac":function(e,t,a){"use strict";var s=a("9275"),i=a.n(s);i.a},9275:function(e,t,a){},"9fc4":function(e,t,a){"use strict";var s=a("f7a5"),i=a.n(s);i.a},a117:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.viewDialogVisible?a("div",{staticClass:"modal",on:{click:function(e){e.stopPropagation()}}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("查看详情")]),a("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(t){return e.close()}}},[e._v("返回上一层")])],1),a("Form",{ref:"addOrEditModal",attrs:{"label-width":80,"label-position":"left"}},[a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"商户名称："}},[a("span",[e._v(e._s(e.data.merchantName))])])],1)],1),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"拓客时间："}},[a("span",[e._v(e._s(e.data.expandTime))])])],1)],1),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"优惠券：",span:"24"}},[a("span",[e._v(e._s(e.data.couponName))])])],1)],1),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"状态：",span:"24"}},[a("span",[e._v(e._s(e.data.statusName))])])],1)],1),a("FormItem",[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.close}},[e._v("关闭")])],1)],1)],1)],1):e._e()},i=[],n=a("7f80"),o={name:"showDetailModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{data:{}}},methods:{resetRow:function(e){var t=this;Object(n["g"])("/merchant/platform/expand/selectById",{id:e.id}).then(function(e){"200"===e.code?t.data=e.data||{}:t.$Message.error("获取数据失败")})},close:function(){this.$emit("setViewDialogVisible",!1)}}},l=o,r=(a("8bac"),a("6691")),c=Object(r["a"])(l,s,i,!1,null,"777b4091",null);t["default"]=c.exports},cd24:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[e.TokerViewDialogVisible||e.DownViewDialogVisible||e.showViewDialogVisible?e._e():a("div",{staticStyle:{"min-height":"100%"}},[a("Card",{staticStyle:{height:"100%"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("平台拓客")]),a("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(t){return e.close()}}},[e._v("返回上一层")])],1),a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"searchForm",attrs:{"label-position":"right","label-width":75,model:e.searchForm,inline:""}},[a("FormItem",{staticStyle:{width:"40%"},attrs:{label:"商户名称：",span:"24"}},[a("Select",{staticStyle:{width:"48%"},attrs:{placeholder:"请选择商户类型"},model:{value:e.searchForm.merchantType,callback:function(t){e.$set(e.searchForm,"merchantType",t)},expression:"searchForm.merchantType"}},[a("Option",{attrs:{value:""}},[e._v("全部")]),e._l(e.merchantTypeList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})],2),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),a("Input",{staticStyle:{width:"48%"},attrs:{placeholder:"请填写商户名称",disabled:!e.searchForm.merchantType},model:{value:e.searchForm.merchantName,callback:function(t){e.$set(e.searchForm,"merchantName",t)},expression:"searchForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"35%"},attrs:{label:"省/市：",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"40%"},attrs:{label:"拓客时间：",span:"35"}},[a("DatePicker",{staticStyle:{width:"48%"},attrs:{value:e.searchForm.expandTimeStart,type:"date",placeholder:"",options:e.options1},on:{"on-change":function(t){e.changeDateTime(t,1)}}}),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),a("DatePicker",{staticStyle:{width:"48%"},attrs:{value:e.searchForm.expandTimeEnd,type:"date",placeholder:"",options:e.options2},on:{"on-change":function(t){e.changeDateTime(t,2)}}})],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{label:"状态：",span:"20"}},[a("Select",{staticStyle:{width:"100%"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("Option",{attrs:{value:""}},[e._v("全部")]),e._l(e.statusList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})],2)],1),a("FormItem",{staticStyle:{width:"23%"},attrs:{span:"20","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search("searchForm")}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Card",[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.tokerFn}},[e._v("拓客")]),a("Button",{attrs:{type:"primary",icon:"ios-download-outline"},on:{click:e.downFn}},[e._v("下载")])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:e.TableLoading,border:"",columns:e.tableColumns,data:e.listData,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.row;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info",size:"small"},on:{click:function(t){return e.showDetail(s)}}},[e._v("查看")]),1==s.status?a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.del(s)}}},[e._v("删除")]):e._e()]}},{key:"address",fn:function(t){var s=t.row;return[a("div",[e._v(e._s(s.provinceName+"/"+s.cityName))])]}}],null,!1,3660870475)})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize,"show-total":"","show-elevator":"",current:e.current},on:{"on-change":e.changeCurrent,"update:current":function(t){e.current=t}}})],1)],1)],1)])],1),a("TokerModal",{ref:"TokerModal",attrs:{viewDialogVisible:e.TokerViewDialogVisible},on:{setViewDialogVisible:e.closeTab,search:e.search}}),a("DownModal",{ref:"DownModal",attrs:{viewDialogVisible:e.DownViewDialogVisible},on:{setViewDialogVisible:e.closeTab}}),a("showDetailModal",{ref:"showDetailModal",attrs:{viewDialogVisible:e.showViewDialogVisible},on:{setViewDialogVisible:e.closeTab}})],1)},i=[],n=a("7f80"),o=a("f657"),l=a("86b5"),r=a("a117"),c={name:"PlatformToker",components:{TokerModal:o["default"],DownModal:l["default"],showDetailModal:r["default"]},data:function(){return{merchantTypeList:[{value:"1",label:"本地商户(单店)"},{value:"2",label:"本地商户(多店)"}],statusList:[{value:"1",label:"未生效"},{value:"2",label:"已生效"},{value:"3",label:"已完成"}],expandTypeList:[{value:"0",label:"全部"},{value:"1",label:"精准拓客"},{value:"2",label:"平台拓客"}],TableLoading:!1,totalSize:0,listData:[],addressValue:[],selectDataList:[],tableColumns:[{title:"操作",width:150,align:"center",slot:"action",fixed:"left"},{title:"商户名称",width:200,key:"merchantName"},{title:"省/市",width:220,align:"center",slot:"address"},{title:"拓客人数",width:100,align:"center",key:"maxPushCount"},{title:"状态",width:100,key:"statusName"},{title:"拓客时间",minWidth:250,key:"expandTime"},{title:"操作人",minWidth:150,key:"operatorBy"}],searchForm:{merchantType:"",cityCode:"",provinceCode:"",expandTimeEnd:"",expandTimeStart:"",expandType:"",merchantName:"",status:"",current:1,pageSize:10},current:1,addressData:[],options2:{},options1:{},TokerViewDialogVisible:!1,DownViewDialogVisible:!1,showViewDialogVisible:!1}},created:function(){this.getProvinceList(),this.loadTableData()},activated:function(){},methods:{addressLoad:function(e,t){var a=this;e.loading=!0,Object(n["d"])("/system/area/city/"+e.provinceCode).then(function(s){"200"===s.code?(e.children=s.data||[],e.loading=!1,e.children.length&&e.children.forEach(function(e){e.label=e.shortName,e.value=e.cityCode}),t()):(a.$Message.error("获取数据失败"),e.loading=!1,t())})},changeDateTime:function(e,t){switch(t){case 1:this.searchForm.expandTimeStart=e,this.options2={disabledDate:function(t){return t.valueOf()<new Date(e)-864e5}};break;case 2:this.searchForm.expandTimeEnd=e,this.options1={disabledDate:function(t){return t.valueOf()<Date.now()-864e5||t.valueOf()>new Date(e)}};break}},search:function(){this.searchForm.current=1,this.loadTableData(this.searchForm)},reset:function(){this.searchForm.merchantType="",this.searchForm.cityCode="",this.searchForm.provinceCode="",this.searchForm.expandTimeEnd="",this.searchForm.expandTimeStart="",this.searchForm.expandType="",this.searchForm.merchantName="",this.searchForm.status="",this.searchForm.current=1,this.addressValue=[]},loadTableData:function(e){var t=this;this.totalSize=0,this.listData=[],this.TableLoading=!0,Object(n["g"])("/merchant/platform/expand/list?pageNum=".concat(this.searchForm.current,"&pageSize=10"),{cityCode:this.addressValue[1]||"",provinceCode:this.addressValue[0]||"",expandTimeEnd:this.searchForm.expandTimeEnd,expandTimeStart:this.searchForm.expandTimeStart,expandType:this.searchForm.expandType,merchantName:this.searchForm.merchantName,status:this.searchForm.status,merchantType:this.searchForm.merchantType}).then(function(e){t.TableLoading=!1,"200"===e.code?(t.totalSize=e.data.total,t.listData=e.data.records):t.$Message.error("获取数据失败")})},getProvinceList:function(e){var t=this;Object(n["g"])("/system/area/province/list",{}).then(function(e){"200"===e.code?(console.log(e),t.addressData=e.data||[],t.addressData.length&&t.addressData.forEach(function(e){e.value=e.provinceCode,e.label=e.shortName,e.children=[],e.loading=!1})):t.$Message.error("获取数据失败")})},tokerFn:function(){var e=this;this.TokerViewDialogVisible=!0,this.$nextTick(function(){e.$refs["TokerModal"].resetRow()})},downFn:function(e){var t=this;this.DownViewDialogVisible=!0,this.$nextTick(function(){t.$refs["DownModal"].resetRow()})},del:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"<p>您确定要删除该平台拓客记录吗？</p>",onOk:function(){Object(n["g"])("/merchant/platform/expand/delete?id=".concat(e.id),{id:e.id}).then(function(e){t.TableLoading=!1,"200"===e.code?(t.$Message.success("删除成功"),t.searchForm.current=1,t.loadTableData(t.searchForm)):t.$Message.error(e.msg)})},onCancel:function(){}})},showDetail:function(e){var t=this;this.showViewDialogVisible=!0,this.$nextTick(function(){t.$refs["showDetailModal"].resetRow(e)})},handleSelect:function(e,t){this.selectDataList=e},batchAudit:function(){},changeCurrent:function(e){this.searchForm.current!=e&&(this.searchForm.current=e,this.loadTableData(this.searchForm))},closeTab:function(e){this.TokerViewDialogVisible=!1,this.DownViewDialogVisible=!1,this.showViewDialogVisible=!1},close:function(){this.$emit("close",!1)}}},d=c,h=(a("d9e38"),a("6691")),u=Object(h["a"])(d,s,i,!1,null,"12256f53",null);t["default"]=u.exports},d9e38:function(e,t,a){"use strict";var s=a("eff6"),i=a.n(s);i.a},eff6:function(e,t,a){},f7a5:function(e,t,a){}}]);