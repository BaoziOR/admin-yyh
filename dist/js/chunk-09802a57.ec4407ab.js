(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09802a57","chunk-2d0bd5e8","chunk-2d0c4fc7","chunk-2d20feec"],{"2c67":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"品牌选择",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.viewDialogVisible,callback:function(t){e.viewDialogVisible=t},expression:"viewDialogVisible"}},[a("div",[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"brandForm",attrs:{"label-position":"right","label-width":80,model:e.brandForm,inline:""}},[a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"品牌名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写品牌名称",maxlength:20},model:{value:e.brandForm.name,callback:function(t){e.$set(e.brandForm,"name",t)},expression:"brandForm.name"}})],1),a("FormItem",{staticStyle:{float:"right"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search("searchForm")}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":e.selectBusiness},model:{value:e.selectIndex,callback:function(t){e.selectIndex=t},expression:"selectIndex"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading,border:"",columns:e.tableColumns,data:e.listData,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"activeTime",fn:function(t){var s=t.row;return[a("div",[e._v(e._s(s.activeTime))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize,"show-total":"","show-elevator":"",current:e.current},on:{"on-change":e.changeCurrent,"update:current":function(t){e.current=t}}})],1)],1)]),a("div",{staticStyle:{"text-align":"center",margin:"10px"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.brandSave}},[e._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.brandClose}},[e._v("关闭")])],1)])},i=[],n=a("7f80"),o={name:"brandModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading:"",brandForm:{name:"",current:1},totalSize:0,current:1,selectIndex:"",selectRow:{},tableColumns:[{title:"操作",width:200,align:"center",slot:"action",fixed:"left"},{title:"品牌名称",key:"name",align:"center"}],listData:[],selectDataList:[]}},methods:{resetRow:function(e){this.selectRow=e,this.loadTableData()},search:function(){this.loadTableData()},reset:function(){this.brandForm.current=1,this.brandForm.name=""},handleSelect:function(e,t){this.selectDataList=e},changeCurrent:function(e){this.brandForm.current!=e&&(this.brandForm.current=e,this.loadTableData())},selectBusiness:function(){console.log(this.selectIndex),this.selectRow=this.listData[this.selectIndex]},brandClose:function(){this.$emit("setViewDialogVisible",this.selectRow)},brandSave:function(){this.selectIndex||0===this.selectIndex?this.$emit("setViewDialogVisible",this.selectRow):this.$Message.error("请选择品牌")},loadTableData:function(){var e=this,t=this;this.TableLoading=!0,this.selectIndex="",Object(n["g"])("/merchant/brandMain/list?pageNum=".concat(this.brandForm.current,"&pageSize=10"),{name:this.brandForm.name,pageNum:this.current,pageSize:10}).then(function(a){e.TableLoading=!1,"200"===a.code?(e.totalSize=a.data.total,e.listData=a.data.records,e.selectRow.id&&a.data.records.forEach(function(e,a){console.log(111),e.id===t.selectRow.id&&(t.selectIndex=a)})):e.$Message.error("获取数据失败")})}},created:function(){}},l=o,r=a("6691"),c=Object(r["a"])(l,s,i,!1,null,"46034ace",null);t["default"]=c.exports},"3cbc":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"商户选择",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.viewDialogVisible,callback:function(t){e.viewDialogVisible=t},expression:"viewDialogVisible"}},[a("div",[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"businessModal",attrs:{"label-position":"right","label-width":80,model:e.businessModal,inline:""}},[a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"商户名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商户名称",maxlength:20},model:{value:e.businessModal.name,callback:function(t){e.$set(e.businessModal,"name",t)},expression:"businessModal.name"}})],1),a("FormItem",{staticStyle:{width:"40%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{float:"right"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search("searchForm")}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":e.selectBusiness},model:{value:e.selectIndex,callback:function(t){e.selectIndex=t},expression:"selectIndex"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading,border:"",columns:e.tableColumns,data:e.listData,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"address",fn:function(t){var s=t.row;return[a("div",[e._v(e._s(s.province+"/"+s.city))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize,"show-total":"","show-elevator":"",current:e.current},on:{"on-change":e.changeCurrent,"update:current":function(t){e.current=t}}})],1)],1)]),a("div",{staticStyle:{"text-align":"center",margin:"10px"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.businessSave}},[e._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.businessClose}},[e._v("关闭")])],1)])},i=[],n=a("7f80"),o={name:"businessModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading:"",businessModal:{name:"",current:1},addressValue:[],selectRow:"",selectIndex:"",addressData:[],totalSize:0,current:1,tableColumns:[{title:"操作",width:80,align:"center",slot:"action",fixed:"left"},{title:"商户名称",minWidth:200,key:"name",align:"center"},{title:"省/市",minWidth:250,slot:"address",align:"center"}],listData:[],selectDataList:[]}},methods:{resetRow:function(e){this.selectRow=e,this.businessModal.name="",this.addressData=[],this.getProvinceList(),this.loadTableData()},getProvinceList:function(){var e=this;Object(n["g"])("/system/area/province/list",{}).then(function(t){"200"===t.code?(e.addressData=t.data||[],e.addressData.length&&e.addressData.forEach(function(e){e.value=e.provinceCode,e.label=e.shortName,e.children=[],e.loading=!1})):e.$Message.error("获取数据失败")})},addressLoad:function(e,t){var a=this;e.loading=!0,Object(n["d"])("/system/area/city/"+e.provinceCode).then(function(s){"200"===s.code?(e.children=s.data||[],e.loading=!1,e.children.length&&e.children.forEach(function(e){e.label=e.shortName,e.value=e.cityCode}),t()):(a.$Message.error("获取数据失败"),e.loading=!1,t())})},search:function(){this.TableLoading=!1,this.loadTableData()},reset:function(){},loadTableData:function(){var e=this,t=this;this.totalSize=0,this.listData=[],this.TableLoading=!0,this.selectIndex="",Object(n["g"])("/merchant/merchantInfo/list?pageNum=".concat(this.businessModal.current,"&pageSize=10"),{cityCode:this.addressValue[1]||"",provinceCode:this.addressValue[0]||"",name:this.businessModal.name||""}).then(function(a){e.TableLoading=!1,"200"===a.code?(e.totalSize=a.data.total,e.listData=a.data.records,e.selectRow.merchantId&&a.data.records.forEach(function(e,a){e.merchantId===t.selectRow.merchantId&&(t.selectIndex=a)})):e.$Message.error("获取数据失败")})},handleSelect:function(e,t){this.selectDataList=e},changeCurrent:function(e){this.businessModal.current!=e&&(this.businessModal.current=e,this.loadTableData())},selectBusiness:function(){this.selectRow=this.listData[this.selectIndex]},businessClose:function(){this.$emit("setViewDialogVisible",this.selectRow)},businessSave:function(){this.selectIndex||0===this.selectIndex?this.$emit("setViewDialogVisible",this.selectRow):this.$Message.error("请选择商户")}},created:function(){}},l=o,r=a("6691"),c=Object(r["a"])(l,s,i,!1,null,"6ca7b579",null);t["default"]=c.exports},"4a63":function(e,t,a){"use strict";var s=a("da1d"),i=a.n(s);i.a},b679:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"优惠券选择",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.viewDialogVisible,callback:function(t){e.viewDialogVisible=t},expression:"viewDialogVisible"}},[a("div",[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"couponForm",attrs:{"label-position":"right","label-width":80,model:e.couponForm,inline:""}},[a("FormItem",{staticStyle:{width:"45%"},attrs:{label:"商家名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商家名称",maxlength:20},model:{value:e.couponForm.merchantName,callback:function(t){e.$set(e.couponForm,"merchantName",t)},expression:"couponForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"50%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:e.addressData,"load-data":e.addressLoad},model:{value:e.addressValue,callback:function(t){e.addressValue=t},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"优惠券名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写优惠券名称",maxlength:20},model:{value:e.couponForm.couponName,callback:function(t){e.$set(e.couponForm,"couponName",t)},expression:"couponForm.couponName"}})],1),a("FormItem",{staticStyle:{float:"right"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){return e.search("searchForm")}}},[e._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Row",[a("RadioGroup",{staticStyle:{width:"100%"},on:{"on-change":e.selectBusiness},model:{value:e.selectIndex,callback:function(t){e.selectIndex=t},expression:"selectIndex"}},[a("Table",{ref:"table",attrs:{loading:e.TableLoading,border:"",columns:e.tableColumns,data:e.listData,sortable:"custom"},on:{"on-selection-change":e.handleSelect},scopedSlots:e._u([{key:"action",fn:function(e){e.row;var t=e.index;return[a("Radio",{attrs:{label:t}},[a("span")])]}},{key:"address",fn:function(t){var s=t.row;t.index;return[a("div",[e._v(e._s(s.province+"/"+s.city))])]}},{key:"timer",fn:function(t){var s=t.row;t.index;return[a("div",[e._v(e._s(s.useStartTime+" -- "+s.useEndTime))])]}}])})],1)],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:e.totalSize,"show-total":"","show-elevator":"",current:e.current},on:{"on-change":e.changeCurrent,"update:current":function(t){e.current=t}}})],1)],1)]),a("div",{staticStyle:{"text-align":"center",margin:"10px 0"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.couponSave}},[e._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.couponClose}},[e._v("关闭")])],1)])},i=[],n=a("7f80"),o={name:"couponModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading:"",couponForm:{merchantName:"",couponName:"",current:1},totalSize:0,current:1,selectIndex:"",selectRow:{},addressData:[],tableColumns:[{title:"操作",width:80,align:"center",slot:"action",fixed:"left"},{title:"商家名称",minWidth:150,key:"merchantName",align:"center"},{title:"省/市",minWidth:200,slot:"address",align:"center"},{title:"优惠券名称",minWidth:150,key:"title",align:"center"},{title:"有效期",minWidth:200,slot:"timer",align:"center"}],listData:[],selectDataList:[],addressValue:[]}},methods:{resetRow:function(e,t){this.couponForm.couponName=e.couponName,this.couponForm.merchantName=e.merchantName,this.addressValue=[],this.selectIndex="",this.selectRow=t,this.loadTableData()},addressLoad:function(e,t){e.loading=!0,setTimeout(function(){"beijing"===e.value?e.children=[{value:"talkingdata",label:"TalkingData"},{value:"baidu",label:"百度"},{value:"sina",label:"新浪"}]:"hangzhou"===e.value&&(e.children=[{value:"ali",label:"阿里巴巴"},{value:"163",label:"网易"}]),e.loading=!1,t()},1e3)},search:function(){this.loadTableData()},reset:function(){this.couponForm.couponName=row.couponName,this.couponForm.merchantName=row.merchantName,this.addressValue=[]},loadTableData:function(e){var t=this,a=this;this.selectDataList=[],this.totalSize=0,this.listData=[],this.TableLoading=!0;var s={page:this.couponForm.current,size:10,cityCode:this.addressValue[1]||"",couponName:this.couponForm.couponName,merchantName:this.couponForm.merchantName,provinceCode:this.addressValue[0]||""};a=this;Object(n["g"])("/coupon/merchant/list",s).then(function(e){t.TableLoading=!1,"200"===e.code?(t.totalSize=e.data.total,t.listData=e.data.records||[],t.selectRow.templateId&&t.listData.forEach(function(e,t){e.templateId==a.selectRow.templateId&&(a.selectIndex=t)})):t.$Message.error("获取数据失败")})},handleSelect:function(e,t){this.selectDataList=e},changeCurrent:function(e){this.couponForm.current!=e&&(this.couponForm.current=e,this.loadTableData())},selectBusiness:function(){this.selectRow=this.listData[this.selectIndex]},couponClose:function(){this.$emit("setViewDialogVisible",!1)},couponSave:function(){this.selectIndex||0===this.selectIndex?this.$emit("setViewDialogVisible",this.selectRow):this.$Message.error("请选择优惠券")}},created:function(){this.TableLoading=!1,console.log(2)}},l=o,r=a("6691"),c=Object(r["a"])(l,s,i,!1,null,"265f483e",null);t["default"]=c.exports},da1d:function(e,t,a){},f657:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.viewDialogVisible?a("div",{staticClass:"modal",on:{click:function(e){e.stopPropagation()}}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("平台拓客")]),a("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[a("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(t){return e.close()}}},[e._v("返回上一层")])],1),a("Form",{ref:"addOrEditModal",attrs:{model:e.modal,rules:e.ruleValidate,"label-width":80,"label-position":"left"}},[a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"商户名称："}},[a("Select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择商户类型"},model:{value:e.modal.type,callback:function(t){e.$set(e.modal,"type",t)},expression:"modal.type"}},e._l(e.typeList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),1==e.modal.type?a("Button",{staticStyle:{"min-width":"150px"},attrs:{type:"dashed",disabled:!e.modal.type},on:{click:e.openBusinessModal}},[e._v(e._s(e.selectBusinessObj&&e.selectBusinessObj.name?e.selectBusinessObj.name:"请选择商户名称"))]):e._e(),2==e.modal.type?a("Button",{staticStyle:{"min-width":"150px"},attrs:{type:"dashed",disabled:!e.modal.type},on:{click:e.openBrandModal}},[e._v(e._s(e.selectBrandObj&&e.selectBrandObj.name?e.selectBrandObj.name:"请选择品牌名称"))]):e._e(),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),2==e.modal.type?a("Button",{on:{click:function(t){e.brandList=[].concat(e.oldBrandList)}}},[e._v("刷新")]):e._e(),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),2==e.modal.type&&e.upData.pushCustomerNum?a("span",[e._v("套餐剩余拓客人数 "+e._s(e.upData.remainderPushNum)+" 人，套餐截止时间 "+e._s(e.upData.endDate))]):e._e()],1)],1)],1),1==e.modal.type?a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"推送人数："}},[a("InputNumber",{staticStyle:{width:"150px"},attrs:{width:"200",min:0,step:1,type:"text",precision:0,max:1e9,placeholder:"请填写推送人数"},model:{value:e.modal.uNum,callback:function(t){e.$set(e.modal,"uNum",t)},expression:"modal.uNum"}}),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),e.upData.pushCustomerNum?a("span",[e._v("套餐剩余拓客人数 "+e._s(e.upData.remainderPushNum)+" 人，套餐截止时间 "+e._s(e.upData.endDate))]):e._e()],1)],1)],1):e._e(),2==e.modal.type?a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"推送人数："}},e._l(e.brandList,function(t,s){return a("Col",{staticStyle:{margin:"10px 0"}},[a("Input",{staticStyle:{width:"48%"},attrs:{disabled:""},model:{value:t.merchantName,callback:function(a){e.$set(t,"merchantName",a)},expression:"item.merchantName"}}),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),a("InputNumber",{staticStyle:{width:"150px"},attrs:{width:"200",min:0,step:1,type:"text",precision:0,max:1e9,placeholder:"请填写推送人数"},model:{value:t.maxPushCount,callback:function(a){e.$set(t,"maxPushCount",a)},expression:"item.maxPushCount"}}),a("div",{staticStyle:{width:"2%",display:"inline-block"}}),e.brandList.length>1?a("Button",{attrs:{type:"error",shape:"circle",icon:"ios-trash"},on:{click:function(t){return e.reduce(s)}}}):e._e()],1)}),1)],1)],1):e._e(),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"优惠券："}},[a("Button",{staticStyle:{width:"150px"},attrs:{type:"dashed",disabled:!e.modal.type},on:{click:e.openCoupon}},[e._v(e._s(e.selectCouponObj&&e.selectCouponObj.title?e.selectCouponObj.title:"请选择优惠券"))])],1)],1)],1),a("Row",{staticClass:"padding-left-12"},[a("Col",{attrs:{span:"18"}},[a("FormItem",{attrs:{label:"拓客时间"}},[a("DatePicker",{staticStyle:{width:"150px"},attrs:{type:"datetime",placeholder:"",format:"yyyy-MM-dd HH:mm",options:e.options},on:{"on-change":function(t){e.changeDateTime(t)}}})],1)],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v("拓客")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.close}},[e._v("关闭")])],1)],1)],1),a("brandModal",{ref:"brandModal",attrs:{viewDialogVisible:e.brandVolumeModal},on:{setViewDialogVisible:e.selectBrand}}),a("businessModal",{ref:"businessModal",attrs:{viewDialogVisible:e.businessVolumeModal},on:{setViewDialogVisible:e.selectBusiness}}),a("couponModal",{ref:"couponModal",attrs:{viewDialogVisible:e.couponVolumeModal},on:{setViewDialogVisible:e.selectCoupon}})],1):e._e()},i=[],n=a("7f80"),o=a("2c67"),l=a("3cbc"),r=a("b679"),c={name:"TokerModal",components:{brandModal:o["default"],businessModal:l["default"],couponModal:r["default"]},props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{brandVolumeModal:!1,businessVolumeModal:!1,couponVolumeModal:!1,typeList:[{value:"1",label:"本地商户(单店)"},{value:"2",label:"本地商户(多店)"}],statusList:[{value:0,label:"未开始"},{value:1,label:"进行中"},{value:2,label:"已终止"},{value:3,label:"已结束"}],modal:{type:"1",tokerDate:""},upData:{},options:{disabledDate:function(e){return e.valueOf()<Date.now()+864e5}},selectBusinessObj:{},selectBrandObj:{},brandList:[],oldBrandList:[],selectCouponObj:{},ruleValidate:{requiredType:[{required:!0,message:"",trigger:"blur"}]}}},methods:{changeDateTime:function(e,t){this.modal.tokerDate=e},resetRow:function(e){this.modal.type="1",this.modal.uNum=null,this.modal.date=new Date(Date.now()+1728e5),this.modal.time1="",this.modal.time2="",this.selectBusinessObj={},this.selectBrandObj={},this.brandList=[],this.oldBrandList=[],this.selectCouponObj={},this.upData={}},reduce:function(e){this.brandList.splice(e,1)},openBusinessModal:function(){var e=this;this.businessVolumeModal=!0,this.$nextTick(function(){e.$refs["businessModal"].resetRow(e.selectBusinessObj)})},openBrandModal:function(){var e=this;this.brandVolumeModal=!0,this.$nextTick(function(){e.$refs["brandModal"].resetRow(e.selectBrandObj)})},openCoupon:function(){var e=this;this.selectBusinessObj.name||this.selectBrandObj.name?(this.couponVolumeModal=!0,this.$nextTick(function(){e.$refs["couponModal"].resetRow({},e.selectCouponObj)})):this.$Message.error("请选择商家或品牌")},selectBusiness:function(e){this.selectBusinessObj=e,this.businessVolumeModal=!1,e&&e.merchantId&&this.getPackageData(e.merchantId,1)},selectBrand:function(e){this.selectBrandObj=e,this.brandVolumeModal=!1,e&&e.id&&this.getPackageData(e.id,2)},selectCoupon:function(e){this.selectCouponObj=e,this.couponVolumeModal=!1},getPackageData:function(e,t){var a=this;Object(n["g"])("/merchant/merchantPackageInfo/getPackage",{id:e,type:t}).then(function(e){"200"===e.code?(console.log(e),a.upData=e.data,2==a.modal.type&&e.data.merchantReqList&&e.data.merchantReqList.length&&(e.data.merchantReqList.forEach(function(e,t){e.maxPushCount=0}),a.oldBrandList=e.data.merchantReqList,a.brandList=e.data.merchantReqList)):(a.$Message.error(e.msg),a.oldBrandList=[],a.brandList=[])})},ok:function(){var e=this,t={};if(this.modal.type||this.$Message.error("请选择商户类型"),this.upData&&this.upData.id||this.$Message.error("请选择有效套餐"),1==this.modal.type){if(!this.selectBusinessObj.name)return void this.$Message.error("请选择商户名称");if(!this.modal.uNum&&Number(this.modal.uNum)>Number(this.upData.remainderPushNum))return void this.$Message.error("请填写合适推送人数");if(!this.selectCouponObj&&!this.selectCouponObj.merchantName)return void this.$Message.error("请选择优惠券");if(!this.modal.tokerDate)return void this.$Message.error("请选择拓客时间");t.cityCode=this.selectBusinessObj.cityCode,t.cityName=this.selectBusinessObj.city,t.couponId=this.selectCouponObj.templateId,t.couponType=this.selectCouponObj.couponType,t.couponName=this.selectCouponObj.title,t.expandTime=this.modal.tokerDate+":00",t.expandType="2",t.maxPushCount=this.modal.uNum,t.merchantId=this.selectBusinessObj.merchantId,t.merchantName=this.selectBusinessObj.name,t.merchantType="1",t.provinceCode=this.selectBusinessObj.provinceCode,t.provinceName=this.selectBusinessObj.province,t.packageId=this.upData.id}else if(2==this.modal.type){if(!this.selectBrandObj.name)return void this.$Message.error("请选择品牌名称");if(!this.selectCouponObj&&!this.selectCouponObj.merchantName)return void this.$Message.error("请选择优惠券");if(!this.modal.tokerDate)return void this.$Message.error("请选择拓客时间");if(!this.brandList||!this.brandList.length)return void this.$Message.error("请重新选择品牌");var a=this;this.brandList.forEach(function(e,t){e.maxPushCount-0<=0?a.$Message.error("请填写推送人数"):e.maxPushCount-0>=Number(a.upData.remainderPushNum)&&a.$Message.error("推送人数不能大于套餐剩余人数")}),t.couponId=this.selectCouponObj.templateId,t.couponType=this.selectCouponObj.couponType,t.couponName=this.selectCouponObj.title,t.expandTime=this.modal.tokerDate+":00",t.expandType="2",t.maxPushCount=this.modal.uNum,t.merchantReqs=this.brandList,t.merchantId=this.selectBrandObj.id,t.merchantName=this.selectBrandObj.name,t.packageId=this.upData.id,t.merchantType="2"}Object(n["g"])("/merchant/platform/expand/add",t).then(function(t){"200"===t.code?(e.$Message.success("拓客成功,即将跳回列表"),e.$emit("setViewDialogVisible",!1),e.$emit("search")):e.$Message.error(t.msg)})},close:function(){this.$emit("setViewDialogVisible",!1)}}},d=c,u=(a("4a63"),a("6691")),h=Object(u["a"])(d,s,i,!1,null,"592ef564",null);t["default"]=h.exports}}]);