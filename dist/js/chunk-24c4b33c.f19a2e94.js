(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24c4b33c","chunk-2d0cf4a3","chunk-2d0cf4a3"],{"62a2":function(t,e,i){"use strict";i.d(e,"c",function(){return a}),i.d(e,"b",function(){return n}),i.d(e,"a",function(){return o}),i.d(e,"d",function(){return r});var s=i("2864");function a(t,e){var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),S:t.getMilliseconds()};for(var s in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+s+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return e}function n(t,e,i,a){return new Promise(function(a,n){"image/png"!=t.type&&"image/jpeg"!=t.type&&"image/jpg"!=t.type&&"image/bmp"!=t.type&&(s["Message"].error("图片格式只能选择png/jpeg/jpg/bmp"),n());var o=new FileReader;o.onload=function(t){var o=t.target.result,r=new Image;r.onload=function(){e&&this.width!=e?(s["Message"].error("请上传宽为"+e+"的图片"),n()):i&&this.height!=i?(s["Message"].error("请上传高为"+i+"的图片"),n()):a()},r.onerror=n,r.src=o},o.readAsDataURL(t)})}function o(t,e){return new Promise(function(e,i){"image/png"!=t.type&&"image/jpeg"!=t.type&&"image/jpg"!=t.type&&"image/bmp"!=t.type&&(s["Message"].error("图片格式只能选择png/jpeg/jpg/bmp"),i());var a=new FileReader;a.onload=function(t){var s=t.target.result,a=new Image;e(),a.onerror=i,a.src=s},a.readAsDataURL(t)})}function r(t,e){for(var i=[t[0]],s=1;s<t.length;s++){for(var a=t[s],n=!1,o=0;o<i.length;o++)if(a[e]==i[o][e]){n=!0;break}n||i.push(a)}return i}},"704b":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"search"},[i("div",{staticStyle:{width:"90%",background:"#fff","box-shadow":"0 6px 6px -4px rgba(0,0,0,.2)","z-index":"5",position:"fixed",padding:"14px"}},[t.couponEdit_info.merchantId?i("Alert",{attrs:{"show-icon":""}},[i("span",[t._v("\n        商户编号 :\n        "),i("span",{staticStyle:{color:"red"}},[t._v(t._s(t.couponEdit_info.merchantId))])]),t.edit_info.templateId?i("span",{staticStyle:{"margin-left":"20px"}},[t._v("\n        优惠券模板ID :\n        "),i("span",{staticStyle:{color:"red"}},[t._v(t._s(t.edit_info.templateId))])]):t._e(),i("span",{attrs:{slot:"desc"},slot:"desc"})]):t._e()],1),i("div",{staticStyle:{"padding-top":"100px"}},[i("Card",[i("p",{attrs:{slot:"title"},slot:"title"},[t._v("优惠券模版设置")]),i("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[i("Button",{attrs:{type:"dashed",icon:"md-arrow-round-back"},on:{click:function(e){return t.goback()}}},[t._v("返回列表")])],1),i("Row",{staticStyle:{"margin-left":"15%"}},[i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("适用商户\n          ")]),i("Col",{attrs:{span:"16"}},[i("Button",{on:{click:t.addMerchantList}},[t._v("点击选择所需商户")])],1)],1),i("Row",{staticClass:"box"},[i("Table",{attrs:{border:"",width:"600px",columns:t.columnsSelectMerchant,data:t.add_info.merchantList},scopedSlots:t._u([{key:"operate",fn:function(e){var s=e.row;return[i("Button",{staticStyle:{color:"#2db7f5"},attrs:{size:"large",icon:"ios-trash-outline"},on:{click:function(e){return t.remove(s)}}},[t._v("移除")])]}}])})],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("标题\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多10个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"请输入优惠券标题",maxlength:10},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.title,callback:function(e){t.$set(t.edit_info,"title",e)},expression:"edit_info.title"}})],1)],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("优惠类型\n          ")]),i("Col",{attrs:{span:"16"}},[i("Select",{staticStyle:{width:"300px"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.couponType,callback:function(e){t.$set(t.edit_info,"couponType",e)},expression:"edit_info.couponType"}},[i("Option",{attrs:{value:"1"}},[t._v("立减券")]),i("Option",{attrs:{value:"2"}},[t._v("折扣券")]),i("Option",{attrs:{value:"3"}},[t._v("满减券")]),i("Option",{attrs:{value:"4"}},[t._v("体验券")]),i("Option",{attrs:{value:"5"}},[t._v("换购券")]),i("Option",{attrs:{value:"6"}},[t._v("赠品券")])],1)],1)],1),1==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("立减\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多为两位小数点,最大为999999.99",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{min:0,type:"text",placeholder:"请输入金额",max:999999.99},model:{value:t.edit_info.ticketMoney,callback:function(e){t.$set(t.edit_info,"ticketMoney",e)},expression:"edit_info.ticketMoney"}}),i("span",{staticStyle:{color:"red"}},[t._v("   元")])],1)],1)],1):t._e(),2==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("折扣\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多为一位小数点",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{min:0,type:"text",placeholder:"请输入折扣",max:10},model:{value:t.edit_info.ticketDiscount,callback:function(e){t.$set(t.edit_info,"ticketDiscount",e)},expression:"edit_info.ticketDiscount"}}),i("span",{staticStyle:{color:"red"}},[t._v("   折")])],1)],1)],1):t._e(),3==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("满\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多为一位小数点",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{min:0,type:"text",placeholder:"请输入金额",max:999999.99},model:{value:t.edit_info.fullAmout,callback:function(e){t.$set(t.edit_info,"fullAmout",e)},expression:"edit_info.fullAmout"}}),i("span",{staticStyle:{color:"red"}},[t._v("   元")])],1)],1)],1):t._e(),3==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("减\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多为一位小数点",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{min:0,type:"text",placeholder:"请输入金额",max:999999.99},model:{value:t.edit_info.decreaseAmount,callback:function(e){t.$set(t.edit_info,"decreaseAmount",e)},expression:"edit_info.decreaseAmount"}}),i("span",{staticStyle:{color:"red"}},[t._v("   元")])],1)],1)],1):t._e(),4==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("面额描述\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多10个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",clearable:"",placeholder:"请输入描述",maxlength:10},model:{value:t.edit_info.displayText,callback:function(e){t.$set(t.edit_info,"displayText",e)},expression:"edit_info.displayText"}}),i("span",{staticStyle:{color:"red"}},[t._v("   体验券")])],1)],1)],1):t._e(),5==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("面额描述\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多10个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",clearable:"",placeholder:"请输入描述",maxlength:10},model:{value:t.edit_info.displayText,callback:function(e){t.$set(t.edit_info,"displayText",e)},expression:"edit_info.displayText"}}),i("span",{staticStyle:{color:"red"}},[t._v("   换购券")])],1)],1)],1):t._e(),6==t.edit_info.couponType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("面额描述\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多10个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",clearable:"",placeholder:"请输入描述",maxlength:10},model:{value:t.edit_info.displayText,callback:function(e){t.$set(t.edit_info,"displayText",e)},expression:"edit_info.displayText"}}),i("span",{staticStyle:{color:"red"}},[t._v("   赠品券")])],1)],1)],1):t._e(),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("活动开始时间\n          ")]),i("Col",{attrs:{span:"16"}},[i("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"选择活动开始时间"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.startDate,callback:function(e){t.$set(t.edit_info,"startDate",e)},expression:"edit_info.startDate"}})],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("活动结束时间\n          ")]),i("Col",{attrs:{span:"16"}},[i("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"选择活动结束时间"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.endDate,callback:function(e){t.$set(t.edit_info,"endDate",e)},expression:"edit_info.endDate"}})],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("用券有效期类型\n          ")]),i("Col",{attrs:{span:"16"}},[i("Select",{staticStyle:{width:"300px"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.useDateType,callback:function(e){t.$set(t.edit_info,"useDateType",e)},expression:"edit_info.useDateType"}},[i("Option",{attrs:{value:"1"}},[t._v("固定时间范围")]),i("Option",{attrs:{value:"2"}},[t._v("相对有效期")])],1)],1)],1),"1"==t.edit_info.useDateType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("用券开始时间\n          ")]),i("Col",{attrs:{span:"16"}},[i("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"选择用券开始时间"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.useStartDate,callback:function(e){t.$set(t.edit_info,"useStartDate",e)},expression:"edit_info.useStartDate"}})],1)],1):t._e(),"1"==t.edit_info.useDateType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("用券结束时间\n          ")]),i("Col",{attrs:{span:"16"}},[i("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"选择用券结束时间"},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.useEndDate,callback:function(e){t.$set(t.edit_info,"useEndDate",e)},expression:"edit_info.useEndDate"}})],1)],1):t._e(),"2"==t.edit_info.useDateType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("加X天开始生效\n          ")]),i("Col",{attrs:{span:"16"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",min:0,placeholder:"请输入加X天开始生效"},model:{value:t.edit_info.addDaysUseStart,callback:function(e){t.$set(t.edit_info,"addDaysUseStart",e)},expression:"edit_info.addDaysUseStart"}}),i("span",{staticStyle:{color:"red"}},[t._v("   天")])],1)],1):t._e(),"2"==t.edit_info.useDateType?i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("加Y天结束用券\n          ")]),i("Col",{attrs:{span:"16"}},[i("Input",{staticStyle:{width:"300px"},attrs:{min:0,type:"text",placeholder:"请输入加Y天结束用券"},model:{value:t.edit_info.addDaysUseEnd,callback:function(e){t.$set(t.edit_info,"addDaysUseEnd",e)},expression:"edit_info.addDaysUseEnd"}}),i("span",{staticStyle:{color:"red"}},[t._v("   天")])],1)],1):t._e(),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" 是否活动券\n          ")]),i("Col",{attrs:{span:"3"}},[i("RadioGroup",{model:{value:t.edit_info.isActivityCoupon,callback:function(e){t.$set(t.edit_info,"isActivityCoupon",e)},expression:"edit_info.isActivityCoupon"}},[i("Radio",{attrs:{label:0}},[t._v("否")]),i("Radio",{attrs:{label:1}},[t._v("是")])],1)],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" 优惠券缩略图\n          ")]),i("Col",{attrs:{span:"3"}},[t.imgSrc1?i("div",{staticClass:"imgSrc_box"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.imgSrc1}})]):t._e()]),i("Col",{attrs:{span:"9"}},[i("div",{staticStyle:{width:"100px",float:"left"}},[i("ImgCutter",{attrs:{label:"选择图片",boxWidth:600,boxHeight:500,rate:1},on:{cutDown:t.cutDown1}},[i("button",{staticStyle:{width:"100px",background:"border-box"},attrs:{slot:"openImgCutter"},slot:"openImgCutter"},[t._v("上传图片")])])],1),i("br"),i("div",{staticClass:"left-text"},[t._v("选择优惠券缩略图 (不大于1M,JPG/PNG/JPEG/BMP）")])])],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" 优惠券详情图\n          ")]),i("Col",{attrs:{span:"3"}},[t.imgSrc2?i("div",{staticClass:"imgSrc_box"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.imgSrc2}})]):t._e()]),i("Col",{attrs:{span:"9"}},[i("div",{staticStyle:{width:"100px",float:"left"}},[i("ImgCutter",{attrs:{label:"选择图片",boxWidth:600,boxHeight:500,rate:2},on:{cutDown:t.cutDown2}},[i("button",{staticStyle:{width:"100px",background:"border-box"},attrs:{slot:"openImgCutter"},slot:"openImgCutter"},[t._v("上传图片")])])],1),i("br"),i("div",{staticClass:"left-text"},[t._v("选择优惠券缩略图 (不大于1M,JPG/PNG/JPEG/BMP）")])])],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("库存数量\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"发放总量和数量不限制",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入库存数量(请输入正整数)",min:1,step:1,max:999999999},model:{value:t.edit_info.stockCount,callback:function(e){t.$set(t.edit_info,"stockCount",e)},expression:"edit_info.stockCount"}}),i("span",{staticStyle:{color:"red"}},[t._v("   张")])],1)],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("用户限领数量\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"发放总量和数量不限制",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入用户限领数量(请输入正整数)",min:1,step:1,max:999999999},model:{value:t.edit_info.getLimit,callback:function(e){t.$set(t.edit_info,"getLimit",e)},expression:"edit_info.getLimit"}}),i("span",{staticStyle:{color:"red"}},[t._v("   张")])],1)],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("券使用说明\n          ")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多200个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},maxlength:200},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.useDesc,callback:function(e){t.$set(t.edit_info,"useDesc",e)},expression:"edit_info.useDesc"}})],1)],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",attrs:{span:"3"}},[t._v("备注")]),i("Col",{attrs:{span:"16"}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"最多200个汉字",placement:"right"}},[i("Input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},maxlength:200},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.remark,callback:function(e){t.$set(t.edit_info,"remark",e)},expression:"edit_info.remark"}})],1)],1)],1),i("Row",{staticStyle:{"{'margin-top'":"'54px'}"}},[1==t.isCheckDisabled?i("Alert",{staticStyle:{width:"500px"},attrs:{type:"warning","show-icon":""}},[t._v("修改后才能保存")]):t._e(),i("Button",{staticStyle:{width:"300px"},attrs:{type:"primary",loading:t.edit_loading,disabled:t.isCheckDisabled},on:{click:function(e){return t.campagin_add()}}},[t._v("保存")])],1),t.formShareModal.shareData.length?i("Row",{staticStyle:{"border-top":"1px solid #666","margin-top":"20px"}},[i("Form",{ref:"shareModal",staticStyle:{"margin-top":"20px"},attrs:{model:t.formShareModal,"label-width":100}},[t._l(t.formShareModal.shareData,function(e){return i("FormItem",{key:e.id,attrs:{label:e.name,required:""}},[i("InputNumber",{staticStyle:{width:"320px"},attrs:{min:"倍数"==e.name?1:0,step:1,type:"text",placeholder:"请输入"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}}),"倍数"!=e.name?i("span",[t._v("  U贝")]):t._e(),"倍数"==e.name?i("span",[t._v("  倍")]):t._e()],1)}),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.shareSave("shareModal")}}},[t._v("保存")])],1)],2)],1):t._e()],1)],1),i("Modal",{attrs:{title:"商户列表",width:"800","footer-hide":"",closable:!1,"mask-closable":!1},model:{value:t.merchantTabDisplay,callback:function(e){t.merchantTabDisplay=e},expression:"merchantTabDisplay"}},[i("div",[i("row",[i("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":70}},[i("FormItem",{attrs:{label:"商户编号"}},[i("Input",{staticStyle:{width:"150px"},attrs:{type:"text",clearable:"",placeholder:"请输入商户编号"},model:{value:t.searchItem.merchantId,callback:function(e){t.$set(t.searchItem,"merchantId",e)},expression:"searchItem.merchantId"}})],1),i("FormItem",{attrs:{label:"商户名称"}},[i("Input",{staticStyle:{width:"150px"},attrs:{type:"text",clearable:"",placeholder:"请输入商户名称"},model:{value:t.searchItem.name,callback:function(e){t.$set(t.searchItem,"name",e)},expression:"searchItem.name"}})],1),i("FormItem",{attrs:{label:"所在地区"}},[i("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getcitylist},model:{value:t.searchItem.provinceId,callback:function(e){t.$set(t.searchItem,"provinceId",e)},expression:"searchItem.provinceId"}},t._l(t.provincelist,function(e,s){return i("Option",{key:s,attrs:{value:e.provinceCode}},[t._v(t._s(e.provinceName))])}),1),i("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getarealist},model:{value:t.searchItem.cityId,callback:function(e){t.$set(t.searchItem,"cityId",e)},expression:"searchItem.cityId"}},t._l(t.citylist,function(e,s){return i("Option",{key:s,attrs:{value:e.cityCode}},[t._v(t._s(e.cityName))])}),1),i("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:t.searchItem.areaId,callback:function(e){t.$set(t.searchItem,"areaId",e)},expression:"searchItem.areaId"}},t._l(t.arealist,function(e,s){return i("Option",{key:s,attrs:{value:e.areaCode}},[t._v(t._s(e.areaName))])}),1)],1),i("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[i("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.getMerchantListFn}},[t._v("搜索")]),i("Button",{on:{click:t.refresh}},[t._v("重置")])],1)],1)],1),i("Table",{ref:"selection",attrs:{border:"",width:"100%",columns:t.columnsMerchant,data:t.merchantList,loading:t.TableLoading},on:{"on-select":t.selectionCampagin,"on-select-cancel":t.cancelCampagin,"on-select-all":t.allCampagin,"on-select-all-cancel":t.cancelAllCampagin}}),i("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[i("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1),i("Row",{staticStyle:{"margin-left":"350px","margin-top":"30px"}},[i("Button",{staticStyle:{"margin-right":"20px"},on:{click:t.cancel}},[t._v("取消")]),i("Button",{attrs:{type:"primary"},on:{click:t.selectMerchant}},[t._v("确定")])],1)],1)],1)])},a=[],n=i("7f80"),o=i("62a2"),r=i("365c"),c=i("9cd5");function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d={name:"BasicSet",components:{ImgCutter:c["a"]},props:{couponEdit_info:Object},data:function(){var t;return t={formShareModal:{shareData:[]},imgSrc1:null,imgSrc2:null,receiveRuleSetPage:!1,visible:!1,imgName:"",merchantTabDisplay:!1,userInfoDisplay:!1,selectedMerchantList:[],searchItem:{merchantId:"",name:"",provinceId:"",cityId:"",areaId:""},columnsMerchant:[{type:"selection",width:60,align:"center"},{title:"商户编号",align:"center",minWidth:130,key:"merchantId"},{title:"商户名称",align:"center",width:230,key:"name"},{title:"地址",align:"center",width:340,key:"address"}],columnsSelectMerchant:[{title:"商户编号",align:"center",width:200,key:"merchantId"},{title:"商户名称",align:"center",width:200,key:"name"},{title:"地址",align:"center",minWidth:300,key:"address"},{title:"操作",align:"center",width:140,key:"action",slot:"operate"}],current:1,totalSize:0,pageNum:1,TableLoading:!1,pageStatus:"",merchantList:[],provincelist:[],citylist:[],arealist:[],userToken:{},add_info:l({employeeId:"",mobile:"",realName:"",wxAccount:"",wxQrcode:"",postDesc:"",profile:"",serviceContent:"",roleIdList:[],merchantList:[],userId:""},"userId",""),edit_info:{isActivityCoupon:0,orderBy:"",merchantList:[],startDate:"",endDate:"",useStartDate:"",useEndDate:"",addDaysUseStart:"",addDaysUseEnd:"",new_ticketMoney:0,ticketMoney:0,price:0,ticketDiscount:0,new_ticketDiscount:0,getLimit:0,stockCount:0,fullAmout:0,decreaseAmount:0,displayText:""},edit_loading:!1},l(t,"userToken",""),l(t,"campId",""),l(t,"imgUrl",""),l(t,"url",r["g"]),l(t,"uploadList",[]),l(t,"uploadList1",[]),l(t,"camp_pageStatus",""),l(t,"getUrl",""),l(t,"msg",""),l(t,"isCheckDisabled",!1),l(t,"reqParams",{}),t},created:function(){this.userToken={jwttoken:localStorage.getItem("jwttoken")},this.init()},methods:{share:function(t){var e=this;this.formShareModal.shareData=[],Object(n["g"])("/commonConfig/queryConfigByCode",{code:t.templateId}).then(function(t){200==t.code?t.data||t.data.noOverallCommonConfigList?(e.formShareModal.shareData=t.data.noOverallCommonConfigList||[],e.formShareModal.shareData.forEach(function(t){t.value=Number(t.value)||0}),e.shareDisplay=!0):e.msgErr("未查询到数据"):e.msgErr(t.msg)})},shareSave:function(t){var e=this,i=!0;this.formShareModal.shareData.forEach(function(t){t.createTime=null,t.updateTime=null,t.updateBy=null,t.value||0===t.value||(i=!1,"请输入完整表单"),"倍数"==t.name&&t.value<1&&(i=!1,"请输入大于等于1的倍数")}),i?Object(n["g"])("/commonConfig/updateConfigBatch",{noOverallCommonConfigList:this.formShareModal.shareData}).then(function(t){200==t.code?e.msgOk("保存成功"):e.msgErr(t.msg)}):this.msgErr("请输入完整表单")},init:function(){this.camp_pageStatus=this.getStore("camp_pageStatus"),this.getprovincelist(),this.getMerchantInfo(),this.getCampInfo()},getCampInfo:function(){"add"==this.camp_pageStatus?this.addInfo():"edit"==this.camp_pageStatus&&this.editInfo()},addInfo:function(){this.edit_info={isActivityCoupon:0,startDate:"",endDate:"",useStartDate:"",useEndDate:"",addDaysUseStart:"",addDaysUseEnd:"",status:"0",orderBy:"9999",ticketMoney:0,price:0,ticketDiscount:0,getLimit:0,stockCount:0,fullAmout:0,decreaseAmount:0,displayText:""}},editInfo:function(){this.edit_info=this.couponEdit_info,this.share(this.edit_info),this.uploadList=[{url:this.couponEdit_info.couponSmallImg}],this.uploadList1=[{url:this.couponEdit_info.couponBigImg}],this.edit_info.merchantList=this.couponEdit_info.merchantList,this.imgSrc1=this.couponEdit_info.couponSmallImg,this.imgSrc2=this.couponEdit_info.couponBigImg,2==this.edit_info.couponKind?this.edit_info.price=this.couponEdit_info.price/100:this.edit_info.price=0,this.edit_info.ticketMoney=this.couponEdit_info.ticketMoney/100,this.edit_info.ticketDiscount=this.couponEdit_info.ticketDiscount/10,this.edit_info.couponType=1==this.couponEdit_info.couponType?"1":2==this.couponEdit_info.couponType?"2":3==this.couponEdit_info.couponType?"3":4==this.couponEdit_info.couponType?"4":5==this.couponEdit_info.couponType?"5":"6",this.edit_info.couponKind=1==this.couponEdit_info.couponKind?"1":"2",this.edit_info.useDateType=1==this.couponEdit_info.useDateType?"1":"2"},statusCheckChange:function(){this.isCheckDisabled=!1},refresh:function(){this.searchItem.merchantId="",this.searchItem.name="",this.searchItem.provinceId="",this.searchItem.cityId="",this.searchItem.areaId="",this.getMerchantListFn()},msgOk:function(t){this.$Message.info({content:t,duration:3})},msgErr:function(t){this.$Message.error({content:t,duration:3})},changeCurrent:function(t){this.pageNum=t,this.getMerchantListFn()},getMerchantInfo:function(){var t=this,e=this;"add"==this.camp_pageStatus&&(this.couponEdit_info.templateId=""),"edit"==this.camp_pageStatus&&this.couponEdit_info.templateId&&Object(n["g"])("/merchant/merchantCouponRelation/selectByTemplateId?templateId="+this.couponEdit_info.templateId).then(function(i){if(200==i.code){e.add_info=i.data;i.data.wxQrcode;e.add_info.templateId=e.templateId}else t.$Message.error(i.msg)})},getprovincelist:function(){var t=this;Object(n["g"])("/system/area/province/list").then(function(e){200==e.code?t.provincelist=e.data:t.$Message.error(e.msg)})},getcitylist:function(){var t=this;Object(n["c"])("/system/area/city/"+this.searchItem.provinceId).then(function(e){200==e.code?(t.citylist=e.data,t.searchItem.areaId=""):t.$Message.error(e.msg)})},getarealist:function(){var t=this;Object(n["c"])("/system/area/district/"+this.searchItem.cityId).then(function(e){200==e.code?t.arealist=e.data:t.$Message.error(e.msg)})},cancelCampagin:function(t,e){for(var i=0;i<this.selectedMerchantList.length;i++)e.merchantId==this.selectedMerchantList[i].merchantId&&this.selectedMerchantList.splice(i,1)},selectionCampagin:function(t,e){this.selectedMerchantList.push(e)},allCampagin:function(t){for(var e=0;e<t.length;e++)this.selectedMerchantList.push(t[e])},cancelAllCampagin:function(t){var e=Object(o["d"])(this.selectedMerchantList,"merchantId");this.selectedMerchantList=e;for(var i=0;i<this.selectedMerchantList.length;i++)for(var s=0;s<this.merchantList.length;s++)t[s].merchantId==this.selectedMerchantList[i].merchantId&&this.selectedMerchantList.splice(i,1)},cancel:function(){this.merchantTabDisplay=!1,this.userInfoDisplay=!1},addMerchantList:function(){this.merchantTabDisplay=!0,this.selectedMerchantList=[],this.getMerchantListFn()},getMerchantListFn:function(){var t=this;this.TableLoading=!1;var e={merchantId:this.searchItem.merchantId,name:this.searchItem.name,provinceCode:this.searchItem.provinceId,cityCode:this.searchItem.cityId,areaCode:this.searchItem.areaId};Object(n["g"])("/merchant/merchantInfo/list?isAsc=DESC&orderByColumn=1&pageNum="+this.pageNum+"&pageSize=10",e).then(function(e){200==e.code?(t.totalSize=e.data.total,t.merchantList=e.data.records):t.msgErr(e.msg),t.TableLoading=!1})},selectMerchant:function(){if(this.selectedMerchantList&&this.selectedMerchantList.length>0){var t=!0,e=!1,i=void 0;try{for(var s,a=this.selectedMerchantList[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var n=s.value;this.add_info.merchantList.push(n)}}catch(c){e=!0,i=c}finally{try{t||null==a.return||a.return()}finally{if(e)throw i}}var r=Object(o["d"])(this.add_info.merchantList,"merchantId");this.add_info.merchantList=r,this.merchantTabDisplay=!1}else this.msgErr("至少选一个商户")},remove:function(t){this.removeAlert=!0;for(var e=0;e<this.add_info.merchantList.length;e++)t.merchantId==this.add_info.merchantList[e].merchantId&&this.add_info.merchantList.splice(e,1)},campagin_add:function(){var t=this;if(this.edit_info.couponKind=1,this.add_info.merchantList&&0!=this.add_info.merchantList.length)if(this.edit_info.title)if(this.edit_info.couponType){if("1"==this.edit_info.couponType){if(!this.edit_info.ticketMoney)return void this.$Message.error("请填写金额");if(!/^\d{1,10}(\.\d{1,2})?$/.test(this.edit_info.ticketMoney))return void this.$Message.error("金额最多为2位小数");var e=100*this.edit_info.ticketMoney;this.new_ticketMoney=e.toFixed(2),this.edit_info.displayText=this.edit_info.ticketMoney+"元",this.edit_info.ticketDiscount=""}if("2"==this.edit_info.couponType){if(!this.edit_info.ticketDiscount)return void this.$Message.error("请填写折扣");if(this.edit_info.ticketDiscount>10)return void this.$Message.error("折扣不可大于10.00");if(!/^\d{1,10}(\.\d{1,1})?$/.test(this.edit_info.ticketDiscount))return void this.$Message.error("折扣最多为1位小数");var i=10*this.edit_info.ticketDiscount;this.new_ticketDiscount=i,this.edit_info.displayText=this.edit_info.ticketDiscount+"折",this.edit_info.ticketMoney=""}if("3"==this.edit_info.couponType){if(!this.edit_info.fullAmout)return void this.$Message.error("请填写满减金额");if(!this.edit_info.decreaseAmount)return void this.$Message.error("请填写满减金额");this.edit_info.displayText="满"+this.edit_info.fullAmout+"减"+this.edit_info.decreaseAmount}if("4"!=this.edit_info.couponType&&"5"!=this.edit_info.couponType&&"6"!=this.edit_info.couponType||this.edit_info.displayText)if(this.edit_info.couponKind){if(2==this.edit_info.couponKind){if(!this.edit_info.price)return void this.$Message.error("请填写购买价格");if(!/^\d{1,10}(\.\d{1,2})?$/.test(this.edit_info.price))return void this.$Message.error("购买价格最多为2位小数")}if(""!=this.edit_info.startDate&&""!=this.edit_info.endDate)if((""!=this.edit_info.startDate||""!=this.edit_info.endDate)&&Date.parse(this.edit_info.startDate)>Date.parse(this.edit_info.endDate))this.$Message.error("活动开始时间不能大于活动结束时间");else{this.edit_info.startDate=Object(o["c"])(new Date(this.edit_info.startDate),"yyyy-MM-dd hh:mm:ss");var s=Object(o["c"])(new Date,"yyyy-MM-dd"),a=s+" 00:00:00",r=this.edit_info.startDate<a;if(r)this.$Message.error("活动开始时间不能小于当前时间");else{this.edit_info.endDate=Object(o["c"])(new Date(this.edit_info.endDate),"yyyy-MM-dd");var c=this.edit_info.endDate;if(this.edit_info.endDate=c+" 23:59:59",this.edit_info.useDateType){if("1"==this.edit_info.useDateType){if(""==this.edit_info.useStartDate||""==this.edit_info.useEndDate)return void this.$Message.error("请选择用券开始时间和用券结束时间");if(""!=this.edit_info.useStartDate||""!=this.edit_info.useEndDate){if(Date.parse(this.edit_info.useStartDate)>Date.parse(this.edit_info.useEndDate))return void this.$Message.error("用券开始时间不能大于用券结束时间");this.edit_info.useStartDate=Object(o["c"])(new Date(this.edit_info.useStartDate),"yyyy-MM-dd hh:mm:ss"),this.edit_info.useEndDate=Object(o["c"])(new Date(this.edit_info.useEndDate),"yyyy-MM-dd");var l=this.edit_info.useEndDate;this.edit_info.useEndDate=l+" 23:59:59";var d=Date.parse(this.edit_info.useStartDate)<Date.parse(this.edit_info.startDate),h=Date.parse(this.edit_info.useEndDate)<Date.parse(this.edit_info.endDate);if(d)return void this.$Message.error("用券开始时间不能小于活动开始时间");if(h)return void this.$Message.error("用券结束时间不能小于活动结束时间")}}if("2"==this.edit_info.useDateType){if(this.edit_info.useStartDate="",this.edit_info.useEndDate="",""==this.edit_info.addDaysUseStart&&0!=this.edit_info.addDaysUseStart)return void this.$Message.error("请填写加X天开始生效");if(""==this.edit_info.addDaysUseEnd&&0!=this.edit_info.addDaysUseEnd)return void this.$Message.error("请填写加Y天结束用券");if(this.edit_info.addDaysUseStart>this.edit_info.addDaysUseEnd)return void this.$Message.error("'加X天开始生效'不能大于'加Y天结束用券'");if(0!=this.edit_info.addDaysUseStart&&!/^[1-9]\d*$/.test(this.edit_info.addDaysUseStart))return void this.$Message.error("加X天开始生效请输入正整数");if(0!=this.edit_info.addDaysUseEnd&&!/^[1-9]\d*$/.test(this.edit_info.addDaysUseEnd))return void this.$Message.error("加Y天结束用券请输入正整数")}if(this.edit_info.couponSmallImg)if(this.edit_info.couponBigImg)if(this.edit_info.useDesc)if(this.edit_info.getLimit)if(/^[1-9]\d*$/.test(this.edit_info.getLimit))if(this.edit_info.stockCount)if(/^[1-9]\d*$/.test(this.edit_info.stockCount))if(this.edit_info.getLimit>this.edit_info.stockCount)this.$Message.error("'用户限领数量' 不能大于'库存数量'");else{if("edit"==this.camp_pageStatus){if(!this.edit_info.orderBy)return void this.$Message.error("请填写顺序排序");if(0!=this.edit_info.orderBy&&!/^[1-9]\d*$/.test(this.edit_info.orderBy))return void this.$Message.error("顺序排序请输入正整数")}this.reqParams={isActivityCoupon:this.edit_info.isActivityCoupon,title:this.edit_info.title,couponType:this.edit_info.couponType,ticketMoney:this.new_ticketMoney,ticketDiscount:this.new_ticketDiscount,couponKind:this.edit_info.couponKind,price:this.edit_info.price,label:this.edit_info.label,startDate:this.edit_info.startDate,endDate:this.edit_info.endDate,useDateType:this.edit_info.useDateType,useStartDate:this.edit_info.useStartDate,useEndDate:this.edit_info.useEndDate,addDaysUseStart:this.edit_info.addDaysUseStart,addDaysUseEnd:this.edit_info.addDaysUseEnd,couponSmallImg:this.edit_info.couponSmallImg,couponBigImg:this.edit_info.couponBigImg,buyNotes:this.edit_info.buyNotes,useDesc:this.edit_info.useDesc,getLimit:this.edit_info.getLimit,stockCount:this.edit_info.stockCount,status:this.edit_info.status,remark:this.edit_info.remark,merchantId:this.couponEdit_info.merchantId,orderBy:this.edit_info.orderBy,fullAmout:this.edit_info.fullAmout,decreaseAmount:this.edit_info.decreaseAmount,displayText:this.edit_info.displayText,merchantList:this.add_info.merchantList},"add"===this.camp_pageStatus?(this.getUrl="/merchantCouponTemplate/add",this.msg="新增成功"):(this.getUrl="/merchantCouponTemplate/edit/"+this.edit_info.templateId,this.msg="编辑成功",this.reqParams.templateId=this.edit_info.templateId),this.edit_loading=!0,Object(n["g"])(this.getUrl,this.reqParams).then(function(e){t.edit_loading=!1,200==e.code?(t.$Message.info(t.msg),setTimeout(function(){t.goback()},1200)):t.$Message.error(e.msg)})}else this.$Message.error("库存数量请输入正整数");else this.$Message.error("请填写库存数量");else this.$Message.error("用户限领数量输入正整数");else this.$Message.error("请填写用户限领数量");else this.$Message.error("请填写券使用说明");else this.$Message.error("请上传优惠券详情图");else this.$Message.error("请上传优惠券缩略图")}else this.$Message.error("请选择用券有效期类型")}}else this.$Message.error("请选择活动开始时间和活动结束时间")}else this.$Message.error("请选择优惠券种类");else this.$Message.error("请输入面额")}else this.$Message.error("请选择优惠类型");else this.$Message.error("请填写优惠券标题");else this.$Message.error("请填写适用商户")},goback:function(){this.$emit("changeStatus",!1)},cutDown1:function(t){var e=this;if(this.imgSrc1=t.dataURL,this.showSize1(),this.imgSrc1Size>1024)this.$Message.error("图片不能大于1M");else{var i={imgStr:t.dataURL.substr(22)};Object(n["g"])("/operation/operation-info/uploadBase64Image2AliOss",i).then(function(t){200==t.code?e.edit_info.couponSmallImg=t.image_url:e.$Message.error(t.msg)})}},showSize1:function(){var t=this.imgSrc1,e=t.replace("data:image/png;base64,",""),i=e.indexOf("=");e.indexOf("=")>0&&(e=e.substring(0,i));var s=e.length,a=parseInt(s-s/8*2),n="";n=(a/1024).toFixed(2);var o=n+"",r=o.indexOf("."),c=o.substr(r+1,2);"00"==c&&(this.imgSrc1Size=o.substring(0,r)+o.substr(r+3,2)),this.imgSrc1Size=n},showSize2:function(){var t=this.imgSrc2,e=t.replace("data:image/png;base64,",""),i=e.indexOf("=");e.indexOf("=")>0&&(e=e.substring(0,i));var s=e.length,a=parseInt(s-s/8*2),n="";n=(a/1024).toFixed(2);var o=n+"",r=o.indexOf("."),c=o.substr(r+1,2);"00"==c&&(this.imgSrc2Size=o.substring(0,r)+o.substr(r+3,2)),this.imgSrc2Size=n},cutDown2:function(t){var e=this;if(this.imgSrc2=t.dataURL,this.showSize2(),this.imgSrc2Size>1024)this.$Message.error("图片不能大于1M");else{var i={imgStr:t.dataURL.substr(22)};Object(n["g"])("/operation/operation-info/uploadBase64Image2AliOss",i).then(function(t){200==t.code?e.edit_info.couponBigImg=t.image_url:e.$Message.error(t.msg)})}}},mounted:function(){}},h=d,p=(i("a762"),i("6691")),u=Object(p["a"])(h,s,a,!1,null,null,null);e["default"]=u.exports},a762:function(t,e,i){"use strict";var s=i("e2d5"),a=i.n(s);a.a},e2d5:function(t,e,i){}}]);