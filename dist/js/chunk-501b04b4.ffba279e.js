(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-501b04b4"],{"4c9c":function(e,t,a){"use strict";var i=a("764b"),r=a.n(i);r.a},"764b":function(e,t,a){},a6c7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bannerwayEdit"},[a("Modal",{attrs:{closable:!0,"mask-closable":!1},on:{"on-cancel":e.closeDialog},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),a("span",[e._v(e._s(e.title))])],1),a("div",[a("Form",{ref:"formValidate",attrs:{"label-position":"left",model:e.formValidate,rules:e.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{prop:"drawType"}},[a("RadioGroup",{on:{"on-change":e.changeDrawType},model:{value:e.formValidate.drawType,callback:function(t){e.$set(e.formValidate,"drawType",t)},expression:"formValidate.drawType"}},e._l(e.drawTypeList,function(t){return a("Radio",{key:t.value,attrs:{label:t.value}},[a("span",[e._v(e._s(t.label))])])}),1)],1),1==e.formValidate.drawType?a("FormItem",{attrs:{prop:"checkDrawType",rules:{required:!0,validator:e.validateCheckDrawType,trigger:"blur"}}},[a("Input",{attrs:{type:"text"},model:{value:e.formValidate.checkDrawType,callback:function(t){e.$set(e.formValidate,"checkDrawType",t)},expression:"formValidate.checkDrawType"}})],1):e._e(),a("FormItem",{attrs:{label:"上传图片：",prop:"imgUrl"}},[e._l(e.uploadList,function(t){return a("div",{key:t.imgUrl,staticClass:"demo-upload-list"},[a("img",{attrs:{src:t.imgUrl}}),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return e.handleView(t.imgUrl)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return e.handleRemove(t)}}})],1)])}),a("div",{staticStyle:{display:"inline"}},[a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"90px"},attrs:{headers:e.userToken,type:"drag",format:["jpg","jpeg","png","bmp"],"show-upload-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess,action:e.url,accept:"image","max-size":1024,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError}},[a("div",{staticStyle:{width:"90px",height:"90px","line-height":"90px"}},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),a("p",{staticStyle:{"font-size":"12px"}},[e._v("选择图片(不大于1M,JPG/PNG/JPEG/BMP）")])],1)],2),a("FormItem",{attrs:{label:"上线时间：",prop:"onlineTime"}},[a("DatePicker",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"datetime",options:e.m_dateOptions,placeholder:"请选择抽奖日期",format:"yyyy-MM-dd HH:mm",value:e.formValidate.onlineTime},on:{"on-change":e.changeTime}})],1),a("FormItem",{attrs:{label:"下线时间：",prop:"offlineTime"}},[a("DatePicker",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"datetime",options:e.m_dateOptions,placeholder:"请选择抽奖日期",format:"yyyy-MM-dd HH:mm",value:e.formValidate.offlineTime},on:{"on-change":e.changeOfflineTime}})],1),a("FormItem",{attrs:{label:"排序字段：",prop:"rankNum"}},[a("Input",{attrs:{number:"",type:"text",placeholder:"排序字段，值越大优先级越高..."},model:{value:e.formValidate.rankNum,callback:function(t){e.$set(e.formValidate,"rankNum",t)},expression:"formValidate.rankNum"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large"},on:{click:function(t){return e.save("formValidate")}}},[e._v("确认")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.cancelHandleReset("formValidate")}}},[e._v("取消")])],1)]),a("Modal",{attrs:{"footer-hide":!0},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:e.formValidate.imgUrl}}):e._e()])],1)},r=[],n=a("3add"),o=a.n(n),l=a("6797"),s=a("365c"),c=a("62a2"),d=a("872c");function f(e,t,a,i,r,n,o){try{var l=e[n](o),s=l.value}catch(c){return void a(c)}l.done?t(s):Promise.resolve(s).then(i,r)}function u(e){return function(){var t=this,a=arguments;return new Promise(function(i,r){var n=e.apply(t,a);function o(e){f(n,i,r,o,l,"next",e)}function l(e){f(n,i,r,o,l,"throw",e)}o(void 0)})}}var m={mixins:[d["a"]],name:"bannerway-edit",props:{action:{type:Object,default:function(){return{type:"add"}}}},watch:{action:{handler:function(e,t){var a=this,i=this.action,r=i.type,n=i.data;this.isShow=!0,"add"==r?(this.title="添加任务抽奖banner",Object.keys(this.formValidate).forEach(function(e){a.formValidate[e]=""})):(this.title="修改任务抽奖banner",this.$nextTick(function(){Object.keys(a.formValidate).forEach(function(e){a.formValidate[e]=n[e]});var e=n.drawId,t=n.linkUrl,i=e?1:2;a.formValidate.drawType=i,a.formValidate.checkDrawType=1==i?e:t,a.uploadList=[{imgUrl:n.imgUrl}]}))},deep:!0}},data:function(){var e=function(e,t,a){t+="",t=t.trim(),""==t?a(new Error("请选择类型")):a()},t=function(e,t,a){if(t+="",""==t.trim())return a();if(-1!=t.indexOf("."))return a(new Error("请输入整数"));var i=parseInt(t);return isNaN(i)?a(new Error("请输入整数")):i!=t?a(new Error("请输入整数")):(i>=1&&i<=99999&&a(),void a(new Error("请输入[1—99999]之间的整数")))};return{userToken:{},url:s["g"],uploadList:[],visible:!1,isShow:!1,title:"新增",data:{},drawTypeList:[{value:1,label:"抽奖id"},{value:2,label:"抽奖链接"}],formValidate:{id:"",drawType:"",checkDrawType:"",drawId:"",linkUrl:"",imgUrl:"",onlineTime:"",offlineTime:"",rankNum:""},ruleValidate:{drawType:[{required:!0,validator:e,trigger:"blur"}],imgUrl:[{required:!0,message:"请上传图片",trigger:"blur"}],onlineTime:[{required:!0,type:"string",message:"请选择上线时间",trigger:"change"}],offlineTime:[{required:!0,type:"string",message:"请选择下线时间",trigger:"change"}],rankNum:[{validator:t,trigger:"blur"}]}}},created:function(){this.userToken={jwttoken:localStorage.getItem("jwttoken")}},methods:{validateCheckDrawType:function(e,t,a){if(""===t){var i="";if(""==this.formValidate.drawType)return this.$refs.formValidate.validateField("drawType");1==this.formValidate.drawType&&(i="请输入抽奖id"),a(new Error(i))}else{if(1==this.formValidate.drawType){if(t+="",-1!=t.indexOf("."))return a(new Error("请输入整数"));var r=parseInt(t);if(isNaN(r))return a(new Error("请输入整数"));if(r!=t)return a(new Error("请输入整数"))}a()}},changeDrawType:function(e){console.log(e)},closeDialog:function(){this.$refs.formValidate.resetFields(),this.uploadList=[]},handleView:function(e){this.formValidate.imgUrl=e,this.visible=!0},handleRemove:function(e){this.$refs.upload.fileList=[],this.uploadList=[],this.formValidate.imgUrl=""},handleUploadSuccess:function(e,t){if(200==e.code){var a=e.image_url;this.uploadList=[{imgUrl:a}],this.formValidate.imgUrl=a,this.$Message.info("上传图片成功")}else this.$Message.error("上传图片失败，请重新上传")},handleMaxSize:function(e){this.$Message.error("图片不大于1M")},handleFormatError:function(){this.msgErr("只能上传jpg,jpeg,png,bmp格式,请重新上传")},handleBeforeUpload:function(e){return Object(c["a"])(e)},changeTime:function(e){this.formValidate.onlineTime=e},changeOfflineTime:function(e){this.formValidate.offlineTime=e},showBigImg:function(e){this.bigImgDialog=!0,this.bigImageUrl=e.imgUrl},bigImgCancel:function(){this.bigImgDialog=!1},cancelHandleReset:function(e){var t=this;e=e||"formValidate",this.isShow=!1,this.$nextTick(function(){t.$refs[e].resetFields(),t.uploadList=[],t.formValidate={id:"",drawType:1,checkDrawType:"",drawId:"",linkUrl:"",imgUrl:"",onlineTime:"",offlineTime:"",rankNum:""}})},save:function(e){var t=this;this.$refs[e].validate(function(){var e=u(o.a.mark(function e(a){var i,r,n,s,c;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=13;break}return i=JSON.parse(JSON.stringify(t.formValidate)),r=i.drawType,n=i.checkDrawType,1==r?i.drawId=n:i.linkUrl=n,delete i.checkDrawType,s=null,s="add"==t.action.type?l["a"]:l["J"],e.next=9,s(i);case 9:c=e.sent,200==c.code?(t.cancelHandleReset(),t.$emit("refresh")):t.msgErr(c.msg),e.next=14;break;case 13:t.$Message.error("数据验证失败！");case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},msgOk:function(e){this.$Message.info({content:e,duration:3})},msgErr:function(e){this.$Message.error({content:e,duration:3})}}},p=m,h=(a("4c9c"),a("6691")),g=Object(h["a"])(p,i,r,!1,null,"7c5b75f6",null);t["default"]=g.exports}}]);