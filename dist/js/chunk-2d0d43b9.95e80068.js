(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d43b9"],{"5fc5":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{width:"800",title:"优惠券选择",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:t.viewDialogVisible,callback:function(e){t.viewDialogVisible=e},expression:"viewDialogVisible"}},[a("div",[a("div",[a("Card",{staticStyle:{"margin-bottom":"2px"},attrs:{bordered:!1}},[a("Form",{ref:"copponForm",attrs:{"label-position":"right","label-width":80,model:t.copponForm,inline:""}},[a("FormItem",{staticStyle:{width:"45%"},attrs:{label:"商家名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写商家名称",maxlength:20},model:{value:t.copponForm.merchantName,callback:function(e){t.$set(t.copponForm,"merchantName",e)},expression:"copponForm.merchantName"}})],1),a("FormItem",{staticStyle:{width:"50%"},attrs:{label:"省/市",span:"24"}},[a("Cascader",{attrs:{data:t.addressData,"load-data":t.addressLoad},model:{value:t.addressValue,callback:function(e){t.addressValue=e},expression:"addressValue"}})],1),a("FormItem",{staticStyle:{width:"25%"},attrs:{label:"优惠券名称",span:"24"}},[a("Input",{attrs:{placeholder:" 请填写优惠券名称",maxlength:20},model:{value:t.copponForm.couponName,callback:function(e){t.$set(t.copponForm,"couponName",e)},expression:"copponForm.couponName"}})],1),a("FormItem",{staticStyle:{float:"right"},attrs:{span:"24","label-width":1}},[a("Button",{staticClass:"submit",staticStyle:{"margin-right":"5px"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){return t.search("searchForm")}}},[t._v("搜索")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("Row",[a("Table",{ref:"table",attrs:{loading:t.TableLoading,border:"",columns:t.tableColumns,data:t.listData,sortable:"custom"},on:{"on-selection-change":t.handleSelect},scopedSlots:t._u([{key:"address",fn:function(e){var o=e.row;e.index;return[a("div",[t._v(t._s(o.province+"/"+o.city))])]}},{key:"timer",fn:function(e){var o=e.row;e.index;return[a("div",[t._v(t._s(o.useStartTime+" -- "+o.useEndTime))])]}}])})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1)]),a("div",{staticStyle:{"text-align":"center",margin:"10px 0"}},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.couponSave}},[t._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:t.couponClose}},[t._v("关闭")])],1)])},n=[],i=a("7f80"),s={name:"couponModal",props:{viewDialogVisible:{type:Boolean,default:!1}},data:function(){return{TableLoading:"",copponForm:{merchantName:"",couponName:"",current:1},totalSize:0,current:1,selectIndex:"",selectRow:{},addressData:[],addressValue:[],tableColumns:[{type:"selection",width:60,align:"center"},{title:"商家名称",minWidth:200,key:"merchantName",align:"center"},{title:"省/市",minWidth:200,slot:"address",align:"center"},{title:"优惠券名称",minWidth:200,key:"title",align:"center"},{title:"有效期",minWidth:200,slot:"timer",align:"center"}],listData:[],selectDataList:[]}},methods:{resetRow:function(t){this.copponForm.couponName="",this.copponForm.current=1,this.copponForm.merchantName="",this.addressValue=[],this.loadTableData(t),this.selectDataList=[]},getProvinceList:function(t){var e=this;Object(i["g"])("/system/area/province/list",{}).then(function(t){"200"===t.code?(console.log(t),e.addressData=t.data||[],e.addressData.length&&e.addressData.forEach(function(t){t.value=t.provinceCode,t.label=t.shortName,t.children=[],t.loading=!1})):e.$Message.error("获取数据失败")})},addressLoad:function(t,e){var a=this;t.loading=!0,Object(i["d"])("/system/area/city/"+t.provinceCode).then(function(o){"200"===o.code?(t.children=o.data||[],t.loading=!1,t.children.length&&t.children.forEach(function(t){t.label=t.shortName,t.value=t.cityCode}),e()):(a.$Message.error("获取数据失败"),t.loading=!1,e())})},search:function(){this.loadTableData()},reset:function(){this.copponForm.couponName="",this.copponForm.current=1,this.copponForm.merchantName="",this.addressValue=[]},loadTableData:function(t){var e=this;this.selectDataList=[],this.totalSize=0,this.listData=[],this.TableLoading=!0;var a={page:this.copponForm.current,size:10,cityCode:this.addressValue[1]||"",couponName:this.copponForm.couponName,merchantName:this.copponForm.merchantName,provinceCode:this.addressValue[0]||""};Object(i["g"])("/coupon/merchant/list",a).then(function(t){e.TableLoading=!1,"200"===t.code?(e.totalSize=t.data.total,e.listData=t.data.records||[]):e.$Message.error("获取数据失败")})},handleSelect:function(t,e){this.selectDataList=t},changeCurrent:function(t){this.copponForm.current!=t&&(this.copponForm.current=t,this.loadTableData())},couponClose:function(){this.$emit("setViewDialogVisible",!1)},couponSave:function(){0!=this.selectDataList.length?this.$emit("setViewDialogVisible",this.selectDataList):this.$Message.error("请选择")}},created:function(){this.getProvinceList()}},r=s,c=a("6691"),l=Object(c["a"])(r,o,n,!1,null,"64b1ea0d",null);e["default"]=l.exports}}]);