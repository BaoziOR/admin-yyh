(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e2321"],{"7e52":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"search",attrs:{id:"app"}},[i("Card",[i("Tabs",{on:{"on-click":e.changeTab}},e._l(e.tabs,function(e,t){return i("TabPane",{key:t,attrs:{label:e.lable,value:e.value}})}),1),4!==e.currentTab&&5!==e.currentTab?i("div",{staticStyle:{"margin-top":"15px"}},[i("Form",{attrs:{"label-width":180}},[i("FormItem",{attrs:{label:"规则名称",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",disabled:""},model:{value:e.ruleName,callback:function(t){e.ruleName=t},expression:"ruleName"}})],1),i("FormItem",{attrs:{label:"积分值",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusAddChange},model:{value:e.add_info.score,callback:function(t){e.$set(e.add_info,"score",t)},expression:"add_info.score"}})],1),i("FormItem",{attrs:{label:"限制总次数",required:""}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"0.表示无限制",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"0.表示无限制"},on:{"on-change":e.statusAddChange},model:{value:e.add_info.totalLimit,callback:function(t){e.$set(e.add_info,"totalLimit",t)},expression:"add_info.totalLimit"}})],1)],1),i("FormItem",{attrs:{label:"按单个用户限制次数",required:""}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"0.表示无限制",placement:"right"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"0.表示无限制"},on:{"on-change":e.statusAddChange},model:{value:e.add_info.userLimit,callback:function(t){e.$set(e.add_info,"userLimit",t)},expression:"add_info.userLimit"}})],1)],1),i("FormItem",{staticStyle:{"{'margin-top'":"'54px'}"}},[i("Button",{style:{width:"230px"},attrs:{type:"primary",size:"large",loading:e.add_loading,disabled:e.isAddDisabled},on:{click:e.editRule}},[e._v("\n                    保存\n                ")])],1)],1)],1):e._e(),4===e.currentTab?i("div",{staticStyle:{"margin-top":"15px"}},[i("Form",{attrs:{"label-width":180}},[i("FormItem",{attrs:{label:"活动名称",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.checkIn_info.name,callback:function(t){e.$set(e.checkIn_info,"name",t)},expression:"checkIn_info.name"}})],1),i("FormItem",{attrs:{label:"状态",required:""}},[i("RadioGroup",{on:{"on-change":e.statusCheckChange},model:{value:e.checkIn_info.status,callback:function(t){e.$set(e.checkIn_info,"status",t)},expression:"checkIn_info.status"}},[i("Radio",{attrs:{label:"0"}},[e._v("禁用")]),i("Radio",{attrs:{label:"1"}},[e._v("启用")])],1)],1),i("FormItem",{attrs:{label:"签到周期天数",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"例如7天/30天"},on:{"on-change":e.statusCheckChange},model:{value:e.checkIn_info.cycleDays,callback:function(t){e.$set(e.checkIn_info,"cycleDays",t)},expression:"checkIn_info.cycleDays"}})],1),i("FormItem",{attrs:{label:"每日签到奖励积分",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"例如10积分"},on:{"on-change":e.statusCheckChange},model:{value:e.checkIn_info.dailyRewardRule,callback:function(t){e.$set(e.checkIn_info,"dailyRewardRule",t)},expression:"checkIn_info.dailyRewardRule"}})],1),i("FormItem",{attrs:{label:"连续签到奖励积分规则",required:""}}),e._l(e.checkIn_info.continuousRewardRules,function(t,a){return i("FormItem",{key:a},[i("span",[e._v("连续")]),e._v("      \n          "),i("Input",{staticStyle:{width:"100px"},attrs:{type:"text",placeholder:"例如7天"},on:{"on-change":e.statusCheckChange},model:{value:t.day,callback:function(i){e.$set(t,"day",i)},expression:"item.day"}}),e._v("\n                   "),i("span",[e._v(" 日签到额外赠送")]),e._v("      \n          "),i("Input",{staticStyle:{width:"100px"},attrs:{type:"text",placeholder:"例如10积分"},on:{"on-change":e.statusCheckChange},model:{value:t.score,callback:function(i){e.$set(t,"score",i)},expression:"item.score"}}),e._v("\n          \n          \n                     "),e.checkIn_info.continuousRewardRules.length>1?i("Button",{attrs:{type:"error"},on:{click:function(t){return e.handleRemove(a)}}},[e._v("删除")]):e._e()],1)}),i("FormItem",{attrs:{label:""}},[i("Button",{attrs:{type:"info",icon:"md-add"},on:{click:e.handleAdd}},[e._v("增加一项")])],1),i("FormItem",{staticStyle:{"{'margin-top'":"'54px'}"}},[i("Button",{style:{width:"230px"},attrs:{type:"primary",size:"large",loading:e.checkIn_loading,disabled:e.isCheckDisabled},on:{click:e.checkInEdit}},[e._v("\n                    保存\n                ")])],1)],2)],1):e._e(),5===e.currentTab?i("div",{staticStyle:{"margin-top":"15px"}},[i("Form",{attrs:{"label-width":180}},[i("FormItem",{attrs:{label:"每人每天免费次数",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.dailyFreeTimes,callback:function(t){e.$set(e.parameter_info,"dailyFreeTimes",t)},expression:"parameter_info.dailyFreeTimes"}})],1),i("FormItem",{attrs:{label:"每人每天限制兑换次数",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.dailyLimitTimes,callback:function(t){e.$set(e.parameter_info,"dailyLimitTimes",t)},expression:"parameter_info.dailyLimitTimes"}})],1),i("FormItem",{attrs:{label:"兑换要优惠一次所需积分",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.requiredScore,callback:function(t){e.$set(e.parameter_info,"requiredScore",t)},expression:"parameter_info.requiredScore"}})],1),i("FormItem",{attrs:{label:"折扣比例",required:""}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"折扣比例在(0-1)之间",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{max:1,min:0,step:.01,placeholder:"随机范围在(0.1~0.5)之间"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.discountRatio,callback:function(t){e.$set(e.parameter_info,"discountRatio",t)},expression:"parameter_info.discountRatio"}})],1)],1),i("FormItem",{attrs:{label:"最低优惠额",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.lowerDiscountAmount,callback:function(t){e.$set(e.parameter_info,"lowerDiscountAmount",t)},expression:"parameter_info.lowerDiscountAmount"}})],1),i("FormItem",{attrs:{label:"最高优惠额",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.upperDiscountAmount,callback:function(t){e.$set(e.parameter_info,"upperDiscountAmount",t)},expression:"parameter_info.upperDiscountAmount"}})],1),i("FormItem",{attrs:{label:"团长优惠金额放大倍数",required:""}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.multiple,callback:function(t){e.$set(e.parameter_info,"multiple",t)},expression:"parameter_info.multiple"}})],1),i("FormItem",{attrs:{label:"随机因子",required:""}},[i("Tooltip",{attrs:{trigger:"focus",title:"提醒",content:"随机范围在(0.1~0.5)之间",placement:"right"}},[i("InputNumber",{staticStyle:{width:"300px"},attrs:{max:.5,min:.1,step:.1,placeholder:"随机范围在(0.1~0.5)之间"},on:{"on-change":e.statusParameterChange},model:{value:e.parameter_info.randomSeed,callback:function(t){e.$set(e.parameter_info,"randomSeed",t)},expression:"parameter_info.randomSeed"}})],1)],1),i("FormItem",{staticStyle:{"{'margin-top'":"'54px'}"}},[e.parameter_info.id?e._e():i("Button",{style:{width:"230px"},attrs:{type:"primary",size:"large",loading:e.parameter_loading,disabled:e.isParameterDisabled},on:{click:e.parameterAdd}},[e._v("\n                    保存\n                ")]),e.parameter_info.id?i("Button",{style:{width:"230px"},attrs:{type:"primary",size:"large",loading:e.parameter_loading,disabled:e.isParameterDisabled},on:{click:e.parameterEdit}},[e._v("\n                    保存\n                ")]):e._e()],1)],1)],1):e._e()],1)],1)},r=[],n=i("7f80");function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o={name:"role-manage",components:{},data:function(){var e;return e={tabs:[{lable:"用户注册积分",value:"register"},{lable:"推荐注册积分",value:"recommendRegister"},{lable:"核券积分",value:"useCoupon"},{lable:"推荐核券积分",value:"recommendUseCoupon"},{lable:"签到积分",value:"checkIn"},{lable:"要优惠全局参数",value:"parameter"}],isAddDisabled:!0,add_info:{id:"",name:"",score:"",totalLimit:"",trigger:"",userLimit:""},add_loading:!1,ruleType:"register",ruleName:"",currentTab:0,checkIn_info:{continuousRewardRules:[{day:"",index:1,score:""}],cycleDays:"",dailyRewardRule:"",name:"",signinRuleId:"",status:"",remark:""},checkIn_loading:!1,isCheckDisabled:!0,parameter_info:{dailyFreeTimes:"",dailyLimitTimes:"",discountRatio:"",id:"",lowerDiscountAmount:"",multiple:"",randomSeed:"",requiredScore:"",upperDiscountAmount:""},parameter_loading:!1,isParameterDisabled:!0,ScoreRuleurl:"",ScoreRuleMsg:""},s(e,"ScoreRuleurl",""),s(e,"SigninRuleMsg",""),s(e,"CampaignGlobalSeturl",""),s(e,"CampaignGlobalSetMsg",""),e},created:function(){},methods:{init:function(){4===this.currentTab?this.getCheckIn():5===this.currentTab?this.getParameter():(this.ruleType=this.tabs[0].value,this.ruleName=this.tabs[0].lable,this.getRule())},changeTab:function(e){console.log(e),this.currentTab=e,this.ruleType=this.tabs[e].value,this.ruleName=this.tabs[e].lable,this.add_info.name=this.tabs[e].lable,4===this.currentTab?this.getCheckIn():5===this.currentTab?this.getParameter():this.getRule()},getRule:function(){var e=this,t={trigger:this.ruleType};Object(n["c"])("/score/ScoreRule/selectScoreRule",t).then(function(t){200==t.code?t.data?e.add_info=t.data:e.add_info={id:"",name:"",score:"",totalLimit:"",trigger:"",userLimit:""}:e.$Message.error(t.msg)})},editRule:function(){var e=this;if(""!=this.add_info.score&&void 0!=this.add_info.score)if(""!=this.add_info.totalLimit&&void 0!=this.add_info.totalLimit)if(""!=this.add_info.userLimit&&void 0!=this.add_info.userLimit){this.add_info.id?(this.ScoreRuleurl="/score/ScoreRule/edit",this.ScoreRuleMsg="编辑成功"):(this.ScoreRuleurl="/score/ScoreRule/add",this.ScoreRuleMsg="新增成功"),this.add_loading=!0;var t={id:this.add_info.id,score:this.add_info.score,totalLimit:this.add_info.totalLimit,trigger:this.ruleType,userLimit:this.add_info.userLimit};Object(n["g"])(this.ScoreRuleurl,t).then(function(t){e.add_loading=!1,200==t.code?(e.$Message.info(e.ScoreRuleMsg),e.getRule()):e.$Message.error(t.msg)})}else this.$Message.error("按单个用户限制次数不能为空！");else this.$Message.error("限制总次数不能为空！");else this.$Message.error("积分值不能为空！")},statusAddChange:function(){this.isAddDisabled=!1},handleAdd:function(){this.checkIn_info.continuousRewardRules.length>5?this.$Message.error("连续签到奖励积分规则最多伟5条！"):(this.index++,this.checkIn_info.continuousRewardRules.push({index:this.index,day:"",score:""}))},handleRemove:function(e){this.checkIn_info.continuousRewardRules.splice(e,1)},getCheckIn:function(){var e=this;Object(n["c"])("/score/SigninRule/selectSigninRule").then(function(t){200==t.code?t.data?(e.checkIn_info=t.data,e.checkIn_info.status=0==t.data.status?"0":"1"):e.checkIn_info={continuousRewardRules:[{day:"",index:1,score:""}],cycleDays:"",dailyRewardRule:"",name:"",signinRuleId:"",status:""}:e.$Message.error(t.msg)})},checkInEdit:function(){var e=this;if(""!=this.checkIn_info.name&&void 0!=this.checkIn_info.name){var t=!0,i=!1,a=void 0;try{for(var r,s=this.checkIn_info.continuousRewardRules[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if(!o.day||!o.score)return void this.$Message.error("连续签到奖励积分规则填写不完全！")}}catch(c){i=!0,a=c}finally{try{t||null==s.return||s.return()}finally{if(i)throw a}}if(""!=this.checkIn_info.cycleDays&&void 0!=this.checkIn_info.cycleDays)if(""!=this.checkIn_info.dailyRewardRule&&void 0!=this.checkIn_info.dailyRewardRule){this.checkIn_info.signinRuleId?(this.ScoreRuleurl="/score/SigninRule/edit",this.SigninRuleMsg="编辑成功"):(this.SigninRuleurl="/score/SigninRule/add",this.SigninRuleMsg="新增成功"),this.checkIn_loading=!0;var l={continuousRewardRules:JSON.stringify(this.checkIn_info.continuousRewardRules),cycleDays:this.checkIn_info.cycleDays,dailyRewardRule:this.checkIn_info.dailyRewardRule,name:this.checkIn_info.name,signinRuleId:this.checkIn_info.signinRuleId,status:this.checkIn_info.status,remark:this.checkIn_info.remark};Object(n["g"])(this.SigninRuleurl,l).then(function(t){e.checkIn_loading=!1,200==t.code?(e.$Message.info(e.SigninRuleMsg),e.getCheckIn()):e.$Message.error(t.msg)})}else this.$Message.error("每日签到奖励积分不能为空！");else this.$Message.error("签到周期天数不能为空！")}else this.$Message.error("活动名称不能为空！")},statusCheckChange:function(){this.isCheckDisabled=!1},getParameter:function(){var e=this;Object(n["c"])("/campaign/CampaignGlobalSet/selectCampaignGlobalSet").then(function(t){200==t.code?t.data?e.parameter_info=t.data:e.parameter_info={dailyFreeTimes:"",dailyLimitTimes:"",discountRatio:"",id:"",lowerDiscountAmount:"",multiple:"",randomSeed:"",requiredScore:"",upperDiscountAmount:""}:e.$Message.error(t.msg)})},parameterEdit:function(){var e=this;if(""!=this.parameter_info.dailyFreeTimes&&void 0!=this.parameter_info.dailyFreeTimes)if(""!=this.parameter_info.dailyLimitTimes&&void 0!=this.parameter_info.dailyLimitTimes)if(""!=this.parameter_info.discountRatio&&void 0!=this.parameter_info.discountRatio)if(""!=this.parameter_info.lowerDiscountAmount&&void 0!=this.parameter_info.lowerDiscountAmount)if(""!=this.parameter_info.multiple&&void 0!=this.parameter_info.multiple)if(""!=this.parameter_info.randomSeed&&void 0!=this.parameter_info.randomSeed)if(this.parameter_info.randomSeed>.5||this.parameter_info.randomSeed<.1)this.$Message.error("随机因子的范围在0.1~0.5！");else if(""!=this.parameter_info.requiredScore&&void 0!=this.parameter_info.requiredScore)if(""!=this.parameter_info.upperDiscountAmount&&void 0!=this.parameter_info.upperDiscountAmount){this.checkIn_info.signinRuleId?(this.CampaignGlobalSeturl="/campaign/CampaignGlobalSet/edit",this.CampaignGlobalSetMsg="编辑成功"):(this.CampaignGlobalSeturl="/campaign/CampaignGlobalSet/add",this.CampaignGlobalSetMsg="新增成功"),this.parameter_loading=!0;var t={id:this.parameter_info.id,dailyFreeTimes:this.parameter_info.dailyFreeTimes,dailyLimitTimes:this.parameter_info.dailyLimitTimes,discountRatio:this.parameter_info.discountRatio,lowerDiscountAmount:this.parameter_info.lowerDiscountAmount,multiple:this.parameter_info.multiple,randomSeed:this.parameter_info.randomSeed,requiredScore:this.parameter_info.requiredScore,upperDiscountAmount:this.parameter_info.upperDiscountAmount};Object(n["g"])(this.CampaignGlobalSeturl,t).then(function(t){e.parameter_loading=!1,200==t.code?(e.$Message.info(e.CampaignGlobalSetMsg),e.getParameter()):e.$Message.error(t.msg)})}else this.$Message.error("最高优惠额不能为空！");else this.$Message.error("兑换要优惠一次所需积分不能为空！");else this.$Message.error("随机因子不能为空！");else this.$Message.error("团长优惠金额放大倍数不能为空！");else this.$Message.error("最低优惠额不能为空！");else this.$Message.error("折扣比例不能为空！");else this.$Message.error("每人每天限制兑换次数不能为空！");else this.$Message.error("每人每天免费次数不能为空！")},statusParameterChange:function(){this.isParameterDisabled=!1}},mounted:function(){this.init()}},l=o,c=i("6691"),d=Object(c["a"])(l,a,r,!1,null,null,null);t["default"]=d.exports}}]);