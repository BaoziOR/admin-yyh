(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cd372b6"],{"9cd5":function(t,o,i){"use strict";var e=function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",[i("div",{on:{click:t.handleOpen}},[t._t("openImgCutter"),t._t("open")],2),t.$slots.openImgCutter||t.$slots.open?t._e():i("button",{staticClass:"btn btn-primary",on:{click:t.handleOpen}},[t._v(t._s(t.label))]),i("transition",{attrs:{name:"fade"}},[t.visible?i("div",{ref:"mask",staticClass:"mask vue-img-cutter"},[t.visible?i("div",{staticClass:"dialogBox",style:"height:"+parseInt(t.boxHeight+150)+"px"},[i("transition",{attrs:{name:"fade","enter-class":"fade-in-enter","enter-active-class":"fade-in-active","leave-class":"fade-out-enter","leave-active-class":"fade-out-active"}},[i("div",{staticClass:"dialogMain",attrs:{width:t.boxWidth+40+"px"}},[i("div",{staticClass:"toolMain"},[i("div",{staticClass:"tool-title"},[t._v("\n                图片裁剪\n                "),i("span",{staticClass:"closeIcon",on:{click:t.handleClose}},[t._v("×")])]),i("div",{ref:"toolBox",staticClass:"toolBox",style:"height:"+t.boxHeight+"px;width:"+t.boxWidth+"px",on:{mousemove:t.controlBtnMouseMove,mouseup:t.controlBtnMouseUp,mouseleave:t.controlBtnMouseUp}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.drawImg.img,expression:"!drawImg.img"}],staticClass:"tips"},[i("div",{staticClass:"btn btn-warning btn-xs",on:{click:t.chooseImg}},[t._v("选择图片")])]),1==t.tool?i("div",{staticClass:"dockMain",on:{mouseenter:t.dropImgOff}},[t.rate?i("div",{staticClass:"dockBtn"},[t._v("比例："+t._s(t.rate))]):t._e(),i("div",{staticClass:"dockBtn",on:{click:t.scaleReset}},[t._v("\n                    缩放："+t._s(t.drawImg.swidth>0?(t.drawImg.width/t.drawImg.swidth).toFixed(2):"-")+"\n                  ")]),i("div",{staticClass:"dockBtn",on:{click:function(o){return t.turnImg(-90)}}},[t._v("左转90°")]),i("div",{staticClass:"dockBtn",on:{click:function(o){return t.turnImg(90)}}},[t._v("右转90°")]),i("div",{staticClass:"dockBtn",on:{click:function(o){return t.turnReset()}}},[t._v("复位")]),i("div",{staticClass:"dockBtnScrollBar"},[i("div",{ref:"dockBtnScrollControl",staticClass:"scrollBarControl",style:"left:"+t.rotateControl.position+"px",on:{mousemove:t.scrollBarControlMove,mousedown:t.scrollBarControlOn,mouseleave:t.scrollBarControlOff,mouseup:t.scrollBarControlOff}}),1==t.rotateControl.active?i("div",{staticClass:"scrollBarText",style:"left:"+t.rotateControl.position+"px"},[t._v("\n                      "+t._s(t.rotateImg.angle.toFixed(0)+"°")+"\n                    ")]):t._e()])]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:null!=t.drawImg.img,expression:"drawImg.img!=null"}],ref:"toolBoxControl",staticClass:"toolBoxControl",on:{mousedown:t.toolBoxMouseDown,mouseup:t.toolBoxMouseUp,mousemove:t.toolBoxMouseMove,mouseleave:t.toolBoxMouseLeave}},[i("div",{staticClass:"controlBox"},[i("div",{staticClass:"selectArea"},[t._v("宽:"+t._s(t.toolBox.width)+" 高:"+t._s(t.toolBox.height)+"\n                      (x:"+t._s(t.toolBox.boxMove.moveTo.x)+",y:"+t._s(t.toolBox.boxMove.moveTo.y)+")\n                    ")]),i("div",{staticClass:"leftUp controlBtn",attrs:{"data-name":"leftUp"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"leftDown controlBtn",attrs:{"data-name":"leftDown"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"rightUp controlBtn",attrs:{"data-name":"rightUp"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"rightDown controlBtn",attrs:{"data-name":"rightDown"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"topCenter controlBtn",attrs:{"data-name":"topCenter"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"downCenter controlBtn",attrs:{"data-name":"downCenter"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"leftCenter controlBtn",attrs:{"data-name":"leftCenter"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"rightCenter controlBtn",attrs:{"data-name":"rightCenter"},on:{mousedown:t.controlBtnMouseDown}}),i("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-1"}),i("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-2"}),i("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-3"}),i("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-4"})])]),i("canvas",{ref:"canvasSelectBox",staticClass:"canvasSelectBox",attrs:{width:t.boxWidth,height:t.boxHeight},on:{mousedown:t.dropImgOn,mouseup:t.dropImgOff,mousemove:t.dropImgMove}}),i("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.boxWidth,height:t.boxHeight}})])]),i("span",{staticClass:"i-dialog-footer"},[i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputFile",attrs:{type:"file",accept:"image/*"},on:{change:t.putImgToCanv}}),i("div",{staticClass:"btn btn-primary btn-primary-plain",on:{click:t.chooseImg}},[t._v("选择图片")]),i("div",{staticClass:"btn-group fr"},[i("div",{staticClass:"btn btn-default",on:{click:t.handleClose}},[t._v("取消")]),i("div",{staticClass:"btn btn-primary",attrs:{disabled:!t.drawImg.img,type:"primary"},on:{click:t.cropPicture}},[t._v("确定")])])]),i("div",{staticClass:"copyright"},[t.DoNotDisplayCopyright?t._e():i("a",{attrs:{target:"_blank",href:"https://github.com/acccccccb/vue-img-cutter",rel:"nofollow"}},[t._v("vue-img-cutter")])])])])],1):t._e()]):t._e()])],1)},s=[];function a(t,o){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);o&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,e)}return i}function r(t){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?a(i,!0).forEach(function(o){n(t,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(i).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(i,o))})}return t}function n(t,o,i){return o in t?Object.defineProperty(t,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[o]=i,t}var l={name:"ImgCutter",props:{label:{type:String,default:"选择图片",required:!1},boxWidth:{type:Number,default:800,required:!1},boxHeight:{type:Number,default:400,required:!1},rate:{type:Number,default:null,required:!1},tool:{type:Boolean,default:!0,required:!1},DoNotDisplayCopyright:{type:Boolean,default:!1,required:!1}},model:["label","boxWidth","boxHeight","rate","tool","DoNotDisplayCopyright"],data:function(){var t,o;return t=this.boxWidth/2,o=this.boxHeight/2,{visible:!1,drawImg:{img:null,sx:0,sy:0,swidth:0,sheight:0,x:0,y:0,width:0,height:0},toolBox:{disable:!0,width:t,height:o,x:0,y:0,boxMove:{start:{x:0,y:0},moveTo:{x:0,y:0}}},dropImg:{active:!1,pageX:0,pageY:0,params:{}},rotateImg:{angle:0},rotateControl:{active:!1,start:{x:0,y:0},position:100},scaleImg:{rate:0,params:{}},controlBox:{disable:!0,btnName:"",start:{x:0,y:0,width:0,height:0}},selectBox:!1,selectBoxColor:"rgba(0,0,0,0.6)"}},methods:{handleOpen:function(){var t=this;this.visible=!0,this.$nextTick(function(){var o=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";"mousewheel"==o?t.$refs["toolBox"].onmousewheel=t.scaleImgWheel:t.$refs["toolBox"].addEventListener("DOMMouseScroll",t.scaleImgWheel)})},handleClose:function(){var t=this;this.clearAll(),this.$nextTick(function(){t.visible=!1})},chooseImg:function(){this.$refs["inputFile"].click()},putImgToCanv:function(t){var o=this,i=t.target.files[0]||null;if(i){var e=new FileReader;new Image,e.readAsDataURL(i),e.onload=function(t){var i=t.target.result,s=document.createElement("img");s.src=i;var a=setInterval(function(){if(2==e.readyState){clearInterval(a);var t,i=s.height,n=s.width,l=o.boxWidth,h=o.boxHeight,c=r({},o.drawImg);c.img=s,o.scaleImg.rate=n/i,i<h&&n<l?(t=1,c.x=(l-n)/2,c.y=(h-i)/2):n/i<=l/h?(t=h/i,c.x=(l-n*t)/2):(t=l/n,c.y=(h-i*t)/2),c.swidth=n,c.sheight=i,c.width=n*t,c.height=i*t,c.x=(l-c.width)/2,c.y=(h-c.height)/2,o.$set(o,"drawImg",c),o.printImg()}},200)},this.drawControlBox(this.toolBox.width,this.toolBox.height,this.toolBox.x,this.toolBox.y)}},clearAll:function(){var t=this,o=t.$refs["canvas"],i=o.getContext("2d");i.clearRect(0,0,o.width,o.height);var e=t.$refs["canvasSelectBox"],s=e.getContext("2d");s.clearRect(0,0,e.width,e.height),this.drawImg={img:null,sx:0,sy:0,swidth:0,sheight:0,x:0,y:0,width:0,height:0},this.$refs["inputFile"].value="",this.rotateImg.angle=0,this.drawImg.img=null,this.turnReset()},drawControlBox:function(t,o,i,e){if(t<50||o<50)return!1;var s=this.$refs["toolBoxControl"];i<0&&(i=0),e<0&&(e=0),i+this.toolBox.width>this.boxWidth&&(i=this.boxWidth-this.toolBox.width),e+this.toolBox.height>this.boxHeight&&(e=this.boxHeight-this.toolBox.height),s.style.top=e+"px",s.style.left=i+"px";var a=this.$refs["canvasSelectBox"],r=a.getContext("2d");if(r.fillStyle=this.selectBoxColor,r.clearRect(0,0,a.width,a.height),r.fillRect(0,0,a.width,a.height),this.rate){var n=this.rate;r.clearRect(i,e,t,t/n),s.style.width=t+"px",s.style.height=t/n+"px",this.toolBox.height=t/n}else r.clearRect(i,e,t,o),s.style.width=t+"px",s.style.height=o+"px";this.toolBox.boxMove.moveTo.x=i,this.toolBox.boxMove.moveTo.y=e},toolBoxMouseDown:function(t){var o=this.$refs["toolBoxControl"];this.toolBox.x=parseInt(o.style.left.split("px")[0]),this.toolBox.y=parseInt(o.style.top.split("px")[0]),this.toolBox.disable=!1,this.dropImg.active=!1,this.toolBox.boxMove.start={x:t.pageX,y:t.pageY}},toolBoxMouseMove:function(t){if(this.dropImg.active&&this.dropImgMove(t),!1===this.toolBox.disable){var o=t.pageX-this.toolBox.boxMove.start.x,i=t.pageY-this.toolBox.boxMove.start.y,e=this.toolBox.x+o,s=this.toolBox.y+i;this.drawControlBox(this.toolBox.width,this.toolBox.height,e,s)}},toolBoxMouseLeave:function(){this.toolBox.disable=!0},toolBoxMouseUp:function(t){var o=this.$refs["toolBoxControl"];this.toolBox.x=parseInt(o.style.left.split("px")[0]),this.toolBox.y=parseInt(o.style.top.split("px")[0]),this.toolBox.disable=!0,this.dropImg.active=!1},printImg:function(){if(this.drawImg.img){var t=this.$refs["canvas"],o=t.getContext("2d");o.save(),o.clearRect(0,0,t.width,t.height),o.translate(this.drawImg.x+this.drawImg.width/2,this.drawImg.y+this.drawImg.height/2),o.rotate(this.rotateImg.angle*Math.PI/180),o.translate(-(this.drawImg.x+this.drawImg.width/2),-(this.drawImg.y+this.drawImg.height/2)),o.translate(this.drawImg.x,this.drawImg.y),o.drawImage(this.drawImg.img,this.drawImg.sx,this.drawImg.sy,this.drawImg.swidth,this.drawImg.sheight,0,0,this.drawImg.width,this.drawImg.height),o.translate(-this.drawImg.x,-this.drawImg.y),o.restore()}},dropImgOn:function(t){this.dropImg.active=!0,this.dropImg.params=r({},this.drawImg),this.dropImg.pageX=t.pageX,this.dropImg.pageY=t.pageY},dropImgOff:function(){this.dropImg.active=!1},dropImgMove:function(t){var o=this;if(this.dropImg.active&&this.drawImg.img){var i=r({},o.drawImg);i.x=o.dropImg.params.x-(o.dropImg.pageX-t.pageX),i.y=o.dropImg.params.y-(o.dropImg.pageY-t.pageY),o.$set(o,"drawImg",i),o.printImg(),t.stopPropagation()}},scaleReset:function(){this.drawImg.width=this.drawImg.swidth,this.drawImg.height=this.drawImg.sheight,this.printImg()},scaleImgWheel:function(t){var o=this;if(o.drawImg.img){var i,e=t||window.event;e.wheelDelta?i=-e.wheelDelta/40:e.detail&&(i=e.detail);var s=50;o.drawImg.x=o.drawImg.width-9*i>s?o.drawImg.x+3*i:o.drawImg.x,o.drawImg.y=o.drawImg.width-9*i>s?o.drawImg.y+3*i:o.drawImg.y,o.drawImg.width=o.drawImg.width-9*i>s?o.drawImg.width-9*i:s,o.drawImg.height=o.drawImg.width/o.scaleImg.rate,o.printImg()}var a=this.$refs["mask"].scrollTop;return this.$refs["mask"].scrollTo(this.$refs["mask"].scrollLeft,a),!1},turnImg:function(t){var o=this.rotateImg.angle,i=o+t;i>=-180&&i<=180&&(this.rotateImg.angle=i,this.rotateControl.position=i/180*100+100,this.printImg("rotate"))},turnReset:function(){this.rotateImg.angle=0,this.rotateControl.position=100,this.printImg("rotate")},controlBtnMouseDown:function(t){this.controlBox.disable=!1,this.controlBox.btnName=t.target.dataset.name,this.controlBox.start.x=t.clientX,this.controlBox.start.y=t.clientY,this.controlBox.start.width=this.toolBox.width,this.controlBox.start.height=this.toolBox.height,t.stopPropagation()},controlBtnMouseUp:function(t){this.controlBox.disable=!0,this.dropImgOff(),t.stopPropagation()},controlBtnMouseMove:function(t){if(!1===this.controlBox.disable){var o=t.clientX-this.controlBox.start.x,i=t.clientY-this.controlBox.start.y;if("leftUp"==this.controlBox.btnName){var e=this.toolBox.x+o,s=this.toolBox.y+i;this.toolBox.width=this.controlBox.start.width-o>50?this.controlBox.start.width-o:50,this.toolBox.height=this.controlBox.start.height-i>50?this.controlBox.start.height-i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,e,s)}if("rightUp"==this.controlBox.btnName){var a=this.toolBox.x,r=this.toolBox.y+i;this.toolBox.width=this.controlBox.start.width+o>50?this.controlBox.start.width+o:50,this.toolBox.height=this.controlBox.start.height-i>50?this.controlBox.start.height-i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,a,r)}if("rightDown"==this.controlBox.btnName){var n=this.toolBox.x,l=this.toolBox.y;this.toolBox.width=this.controlBox.start.width+o>50?this.controlBox.start.width+o:50,this.toolBox.height=this.controlBox.start.height+i>50?this.controlBox.start.height+i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,n,l)}if("leftDown"==this.controlBox.btnName){var h=this.toolBox.x+o,c=this.toolBox.y;this.toolBox.width=this.controlBox.start.width-o>50?this.controlBox.start.width-o:50,this.toolBox.height=this.controlBox.start.height+i>50?this.controlBox.start.height+i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,h,c)}if("topCenter"==this.controlBox.btnName){var d=this.toolBox.x,g=this.toolBox.y+i;this.toolBox.width=this.controlBox.start.width,this.toolBox.height=this.controlBox.start.height-i>50?this.controlBox.start.height-i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,d,g)}if("downCenter"==this.controlBox.btnName){var x=this.toolBox.x,m=this.toolBox.y;this.toolBox.width=this.controlBox.start.width,this.toolBox.height=this.controlBox.start.height+i>50?this.controlBox.start.height+i:50,this.drawControlBox(this.toolBox.width,this.toolBox.height,x,m)}if("leftCenter"==this.controlBox.btnName){var B=this.toolBox.x+o,w=this.toolBox.y;this.toolBox.width=this.controlBox.start.width-o>50?this.controlBox.start.width-o:50,this.toolBox.height=this.controlBox.start.height,this.drawControlBox(this.toolBox.width,this.toolBox.height,B,w)}if("rightCenter"==this.controlBox.btnName){var v=this.toolBox.x,p=this.toolBox.y;this.toolBox.width=this.controlBox.start.width+o>50?this.controlBox.start.width+o:50,this.toolBox.height=this.controlBox.start.height,this.drawControlBox(this.toolBox.width,this.toolBox.height,v,p)}}t.stopPropagation()},cropPicture:function(){var t=this,o=this.$refs["canvas"],i=new Image;i.src=o.toDataURL(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,i,e){var s=o;setTimeout(function(){for(var o=atob(s.toDataURL(i,e).split(",")[1]),a=o.length,r=new Uint8Array(a),n=0;n<a;n++)r[n]=o.charCodeAt(n);t(new Blob([r],{type:i||"image/png"}))})}}),o.toBlob(function(o){var e=new FileReader;e.readAsDataURL(o),e.onload=function(){var o=setInterval(function(){if(2==e.readyState){clearInterval(o);var s=document.createElement("canvas");s.width=t.toolBox.width,s.height=t.toolBox.height;var a=s.getContext("2d"),r=t.toolBox;if(this.rate){var n=this.rate.split(":")[0]/this.rate.split(":")[1];a.drawImage(i,r.x,r.y,r.width,r.width*n,0,0,r.width,r.width*n)}else a.drawImage(i,r.x,r.y,r.width,r.height,0,0,r.width,r.height);s.toBlob(function(o){t.handleClose(),t.$emit("cutDown",{file:o,dataURL:s.toDataURL()})},"image/jpeg",.95)}},200)}})},scrollBarControlMove:function(t){if(this.rotateControl.active){var o=t.pageX-this.rotateControl.start.x,i=this.rotateControl.start.position+o;i<=0&&(i=0),i>=200&&(i=200),this.rotateControl.position=i,this.rotateImg.angle=(i-100)/100*180,this.printImg()}},scrollBarControlOn:function(t){this.rotateControl.active=!0,this.rotateControl.start.x=t.pageX,this.rotateControl.start.y=t.pageY,this.rotateControl.start.position=this.rotateControl.position},scrollBarControlOff:function(){this.rotateControl.active=!1}}},h=l,c=(i("ec57"),i("6691")),d=Object(c["a"])(h,e,s,!1,null,"76e04f79",null);o["a"]=d.exports},b867:function(t,o,i){},ec57:function(t,o,i){"use strict";var e=i("b867"),s=i.n(e);s.a}}]);