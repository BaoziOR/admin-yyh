(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d8a","2ce6"],{"18ad":function(t,e,n){},"267d":function(t,e,n){"use strict";var s=n("18ad"),a=n.n(s);a.a},"2ce6":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Row",[n("Col",{attrs:{span:"12"}},[n("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择主行业"},on:{"on-change":function(e){t.changeMainIndustry()}},model:{value:t.mainIndustryId,callback:function(e){t.mainIndustryId=e},expression:"mainIndustryId"}},t._l(t.initData.mainIndustryList,function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),n("Col",{attrs:{span:"12"}},[n("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择二级行业"},on:{"on-change":function(e){t.changeSecondIndustry()}},model:{value:t.secondIndustryId,callback:function(e){t.secondIndustryId=e},expression:"secondIndustryId"}},t._l(t.secondInudstryList,function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1)},a=[],i=n("7f80"),o={name:"child1",data:function(){return{mainIndustryId:null,secondIndustryId:null,secondInudstryList:[],initData:{mainIndustryList:[]}}},mounted:function(){this.getMainIndustryList()},methods:{getMainIndustryList:function(){var t=this;Object(i["f"])("/merchant/industryMain/all").then(function(e){200==e.code?t.initData.mainIndustryList=e.data:t.$Message.error(e.msg)})},changeMainIndustry:function(){var t=this;this.secondInudstryList=[],this.mainIndustryId&&(this.returnMainIndustryId(),Object(i["c"])("/merchant/industrySecond/all/"+this.mainIndustryId).then(function(e){200==e.code?t.secondInudstryList=e.data:t.$Message.error(e.msg)}))},changeSecondIndustry:function(){this.$emit("sendSecondIndustryId",this.secondIndustryId)},returnMainIndustryId:function(){this.$emit("sendMainIndustryId",this.mainIndustryId)},reset:function(){this.secondIndustryId=null,this.mainIndustryId=null}}},r=o,c=n("2877"),d=Object(c["a"])(r,s,a,!1,null,null,null);d.options.__file="industry.vue";e["default"]=d.exports},c0fb:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.merchantCustomerAddPage?t._e():n("div",[n("Card",{attrs:{bordered:!1}},[n("Card",[n("Row",[n("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":70}},[n("FormItem",{attrs:{label:"合同号"}},[n("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入合同号"},model:{value:t.searchItem.contractNumber,callback:function(e){t.$set(t.searchItem,"contractNumber",e)},expression:"searchItem.contractNumber"}})],1),n("FormItem",{attrs:{label:"商户名称"}},[n("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入商户名称"},model:{value:t.searchItem.name,callback:function(e){t.$set(t.searchItem,"name",e)},expression:"searchItem.name"}})],1),t.drop?n("span",[n("FormItem",{attrs:{label:"省/市"}},[n("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getcitylist},model:{value:t.searchItem.province,callback:function(e){t.$set(t.searchItem,"province",e)},expression:"searchItem.province"}},t._l(t.provincelist,function(e,s){return n("Option",{key:s,attrs:{value:e.provinceCode}},[t._v(t._s(e.provinceName))])})),n("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:t.searchItem.city,callback:function(e){t.$set(t.searchItem,"city",e)},expression:"searchItem.city"}},t._l(t.citylist,function(e,s){return n("Option",{key:s,attrs:{value:e.cityCode}},[t._v(t._s(e.cityName))])}))],1),n("FormItem",{attrs:{label:"行业"}},[n(t.industryView,{ref:"industryViewChild",tag:"component",on:{sendMainIndustryId:t.mainIndustryId,sendSecondIndustryId:t.secondIndustryId}}),n("Input",{staticStyle:{display:"none"},attrs:{type:"text"},model:{value:t.searchItem.mainIndustryId,callback:function(e){t.$set(t.searchItem,"mainIndustryId",e)},expression:"searchItem.mainIndustryId"}}),n("Input",{staticStyle:{display:"none"},attrs:{type:"text"},model:{value:t.searchItem.industryId,callback:function(e){t.$set(t.searchItem,"industryId",e)},expression:"searchItem.industryId"}})],1),n("FormItem",{attrs:{label:"状态"}},[n("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},model:{value:t.searchItem.isStop,callback:function(e){t.$set(t.searchItem,"isStop",e)},expression:"searchItem.isStop"}},t._l(t.statusList,function(e,s){return n("Option",{key:s,attrs:{value:e.val}},[t._v(t._s(e.name))])}))],1)],1):t._e(),n("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[n("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.search}},[t._v("搜索")]),n("Button",{on:{click:t.searchFormReset}},[t._v("重置")]),n("a",{staticClass:"drop-down",staticStyle:{"margin-left":"10px"},on:{click:t.dropDown}},[t._v("\n                                "+t._s(t.dropDownContent)+"\n                                "),n("Icon",{attrs:{type:t.dropDownIcon}})],1)],1)],1)],1)],1),n("Row",{staticClass:"operation"},[n("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:t.addInfo}},[t._v("新增")]),n("Button",{attrs:{icon:"md-refresh"},on:{click:t.search}},[t._v("刷新")])],1),n("div",[n("Table",{attrs:{border:"",width:"100%",columns:t.columns,data:t.packageList,loading:t.TableLoading},scopedSlots:t._u([{key:"action",fn:function(e){var s=e.row;return["0"==s.isInvoice?n("Button",{staticStyle:{color:"#363591"},attrs:{type:"text",size:"small"},on:{click:function(e){t.invoice(s)}}},[t._v("开票")]):t._e(),"生效中"==s.status?n("Button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(e){t.stop(s)}}},[t._v("终止")]):t._e(),"未开始"==s.status||"生效中"==s.status?n("Button",{staticStyle:{color:"#2db7f5"},attrs:{type:"text",size:"small"},on:{click:function(e){t.editInfo(s)}}},[t._v("编辑")]):t._e(),"未开始"==s.status?n("Button",{staticStyle:{color:"#ed4014"},attrs:{type:"text",size:"small"},on:{click:function(e){t.del(s)}}},[t._v("删除")]):t._e()]}}])})],1),n("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[n("Page",{attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent}})],1)],1)],1),1==t.merchantCustomerAddPage?n("div",[n("merchantCustomerAdd",{attrs:{packageId:t.packageId},on:{changeStatus:t.showMerchantStaffAddStatus}})],1):t._e(),n("Modal",{attrs:{title:"终止操作","footer-hide":!0},on:{"on-visible-change":t.stopFormModalChange},model:{value:t.stopModalShow,callback:function(e){t.stopModalShow=e},expression:"stopModalShow"}},[n("Form",{ref:"stopForm",attrs:{"label-width":80,model:t.stopForm,rules:t.stopFormRule}},[n("FormItem",{attrs:{label:"理由描述",prop:"remarks"}},[n("Input",{attrs:{type:"textarea",rows:4,placeholder:"理由描述"},model:{value:t.stopForm.remarks,callback:function(e){t.$set(t.stopForm,"remarks",e)},expression:"stopForm.remarks"}})],1),n("FormItem",[n("ButtonGroup",[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.stopCancel()}}},[t._v("取消")]),n("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.stopFormOk("stopForm")}}},[t._v("确定")])],1)],1)],1)],1)],1)},a=[],i=n("7f80"),o=n("724b"),r=(n("365c"),n("2ce6")),c={name:"merchant-customer",components:{merchantCustomerAdd:o["default"],industryView:r["default"]},data:function(){var t=function(t,e,n){e.length>100?n(new Error("不能超过100个字")):""!==e?n():n(new Error("必须输入理由"))};return{packageId:"",merchantCustomerAddPage:!1,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{contractNumber:null,name:null,province:null,city:null,mainIndustry:null,secondIndustry:null,status:null},statusList:[{name:"已终止",val:"1"},{name:"生效中",val:"0"},{name:"未开始",val:"10"},{name:"已结束",val:"20"}],columns:[{title:"操作",align:"center",fixed:"left",slot:"action",minWidth:200,width:280},{title:"合同号",key:"contractNumber",minWidth:120},{title:"商户名称",key:"name",minWidth:100},{title:"省/市",key:"address",minWidth:150},{title:"行业",key:"industry",minWidth:100},{title:"状态",key:"status",minWidth:100},{title:"套餐",key:"serviceName",minWidth:100},{title:"应收款（元）",key:"receivables",minWidth:130},{title:"开票状态",key:"dateTime",minWidth:150,render:function(t,e){return"0"==e.row.isInvoice?t("span","未开票"):"1"==e.row.isInvoice?t("span","已开票"):void 0}},{title:"套餐有效期",key:"dateTime",minWidth:200}],packageList:[],TableLoading:!1,current:1,totalSize:0,provincelist:[],citylist:[],industryView:"industryView",stopModalShow:!1,selectRow:{},stopForm:{remarks:"",id:""},stopFormRule:{remarks:[{validator:t,trigger:"blur"}]}}},created:function(){this.userToken={jwttoken:localStorage.getItem("jwttoken")}},methods:{showMerchantStaffAddStatus:function(t){this.merchantCustomerAddPage=t,this.search()},addInfo:function(){this.setStore("pageStatus","add"),this.merchantCustomerAddPage=!0},editInfo:function(t){console.info(JSON.stringify(t));var e="";"未开始"==t.status?e="edit1":"生效中"==t.status&&(e="edit2"),this.setStore("pageStatus",e),this.packageId=""+t.id,this.merchantCustomerAddPage=!0},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},getprovincelist:function(){var t=this;Object(i["f"])("/system/area/province/list").then(function(e){200==e.code?t.provincelist=e.data:t.$Message.error(e.msg)})},getcitylist:function(){var t=this;Object(i["c"])("/system/area/city/"+this.searchItem.province).then(function(e){200==e.code?(t.citylist=e.data,t.searchItem.areaId=""):t.$Message.error(e.msg)})},search:function(){this.current=1,this.totalSize=0,this.getPackageList()},init:function(){this.getPackageList(),this.getprovincelist()},refresh:function(){},del:function(t){var e=this;console.info(JSON.stringify(t));var n=t.name?t.name:"",s=t.id;this.$Modal.confirm({title:"删除确认",content:"您确定要删除"+n+"套餐吗？",onOk:function(){Object(i["f"])("/merchant/merchantPackageInfo/delete?id="+s).then(function(t){200==t.code&&e.search()})},onCancel:function(){}})},stopFormOk:function(t){var e=this,n=this.selectRow.name?this.selectRow.name:"";this.stopForm.id=this.selectRow.id,this.$refs[t].validate(function(t){t&&e.$Modal.confirm({title:"终止确认",content:"您确定要终止"+n+"套餐吗？",onOk:function(){Object(i["f"])("/merchant/merchantPackageInfo/stop",e.stopForm).then(function(t){e.stopModalShow=!1,200==t.code?e.search():e.msgErr("操作失败")})},onCancel:function(){}})})},stopCancel:function(){this.stopModalShow=!1,this.stopFormModalChange()},stopFormModalChange:function(){this.stopForm.id="",this.stopForm.remarks=""},stop:function(t){this.stopModalShow=!0,this.selectRow=t},invoice:function(t){var e=this;console.info(JSON.stringify(t));var n=t.contractNumber?t.contractNumber:"",s=t.id;this.$Modal.confirm({title:"开票确认",content:"合同号为"+n+"是否已开具发票？",onOk:function(){Object(i["f"])("/merchant/merchantPackageInfo/invoice?id="+s).then(function(t){if(200==t.code){var n=!0,a=!1,i=void 0;try{for(var o,r=e.packageList[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var c=o.value;c.id==s&&(c.isInvoice="1")}}catch(t){a=!0,i=t}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}}})},onCancel:function(){}})},getPackageList:function(){var t=this;this.TableLoading=!0,Object(i["f"])("/merchant/merchantPackageInfo/list?isAsc=DESC&orderByColumn=1&pageNum="+this.current+"&pageSize=10",this.searchItem).then(function(e){200==e.code?(t.packageList=e.data.records,t.current=e.data.current,t.totalSize=e.data.total,t.TableLoading=!1):(t.TableLoading=!1,t.msgErr(e.msg))})},changeCurrent:function(t){this.current=t,this.getPackageList()},msgOk:function(t){this.$Message.info({content:t,duration:3})},msgErr:function(t){this.$Message.error({content:t,duration:3})},back:function(){this.$emit("changeStatus",!1)},mainIndustryId:function(t){this.searchItem.mainIndustry=t},secondIndustryId:function(t){this.searchItem.secondIndustry=t},searchFormReset:function(){this.searchItem.contractNumber=null,this.searchItem.name=null,this.searchItem.province=null,this.searchItem.city=null,this.searchItem.mainIndustry=null,this.searchItem.secondIndustry=null,this.searchItem.isStop=null,this.$refs.industryViewChild&&this.$refs.industryViewChild.reset()}},mounted:function(){this.init()}},d=c,l=(n("267d"),n("2877")),u=Object(l["a"])(d,s,a,!1,null,"6bc849c0",null);u.options.__file="merchant-customer.vue";e["default"]=u.exports}}]);