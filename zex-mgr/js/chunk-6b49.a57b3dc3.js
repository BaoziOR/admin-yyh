(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b49"],{"29fc":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Row",[a("Col",[a("Card",[a("Row",[a("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:e.searchItem,inline:"","label-width":70}},[a("FormItem",{attrs:{label:"部门名称"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入部门名称"},model:{value:e.searchItem.deptName,callback:function(t){e.$set(e.searchItem,"deptName",t)},expression:"searchItem.deptName"}})],1),e.drop?a("span",[a("FormItem",{attrs:{label:"部门状态"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.searchItem.status,callback:function(t){e.$set(e.searchItem,"status",t)},expression:"searchItem.status"}},[a("Option",{attrs:{value:""}},[e._v("所有")]),a("Option",{attrs:{value:"0"}},[e._v("正常")]),a("Option",{attrs:{value:"1"}},[e._v("停用")])],1)],1)],1):e._e(),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.queryTableList}},[e._v("搜索")]),a("Button",{on:{click:e.refresh}},[e._v("重置")]),a("a",{staticClass:"drop-down",on:{click:e.dropDown}},[e._v("\n                "+e._s(e.dropDownContent)+"\n                "),a("Icon",{attrs:{type:e.dropDownIcon}})],1)],1)],1)],1)],1),a("Card",[a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(t){e.addInfo()}}},[e._v("新增")]),a("Button",{staticClass:"ivu-btn ivu-btn-info",on:{click:function(t){e.fold=!1}}},[e._v("全部展开")]),a("Button",{staticClass:"ivu-btn ivu-btn-error",on:{click:function(t){e.fold=!0}}},[e._v("全部折叠")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.update}},[e._v("刷新")])],1),a("Row",[e.TableLoading?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),a("tree-table",{attrs:{"expand-key":"title","expand-type":!1,selectable:!1,columns:e.tableColumns,data:e.table_list,"show-index":!0,"is-fold":e.fold},scopedSlots:e._u([{key:"status",fn:function(t){return["1"==t.row.status?a("span",{staticStyle:{color:"#ed4014"}},[e._v("停止")]):e._e(),"0"==t.row.status?a("span",{staticStyle:{color:"#19be6b"}},[e._v("正常")]):e._e()]}},{key:"likes",fn:function(t){return[a("Button",{staticStyle:{color:"#5cadff"},attrs:{type:"text",size:"small"},on:{click:function(a){e.editInfo(t.row)}}},[e._v("编辑")]),e._v("   \n              "),a("Button",{staticStyle:{color:"#19be6b"},attrs:{type:"text",size:"small"},on:{click:function(a){e.edit_add(t.row)}}},[e._v("新增")]),e._v("   \n              "),a("Button",{staticStyle:{color:"#ff3300"},attrs:{type:"text",size:"small"},on:{click:function(a){e.removeInfo(t.row)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),a("Modal",{attrs:{title:"部门管理新增","mask-closable":!1,width:"700"},model:{value:e.add_Modal_show,callback:function(t){e.add_Modal_show=t},expression:"add_Modal_show"}},[a("Form",{ref:"add_info",attrs:{model:e.add_info,"label-width":80,rules:e.ruleValidate}},[a("FormItem",{attrs:{label:"上级部门",required:""}},[a("Button",{staticStyle:{width:"252px"},on:{click:function(t){e.tree_Modal_show=!0}}},[e._v(e._s(e.bumenname||"请选择"))])],1),a("FormItem",{attrs:{label:"部门名称",prop:"deptName"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.add_info.deptName,callback:function(t){e.$set(e.add_info,"deptName",t)},expression:"add_info.deptName"}})],1),a("FormItem",{attrs:{label:"显示排序",required:""}},[a("InputNumber",{staticStyle:{width:"100%"},attrs:{max:99999,min:0,placeholder:"请输入",clearable:""},model:{value:e.add_info.orderNum,callback:function(t){e.$set(e.add_info,"orderNum",t)},expression:"add_info.orderNum"}})],1),a("FormItem",{attrs:{label:"负责人",prop:"leader"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.add_info.leader,callback:function(t){e.$set(e.add_info,"leader",t)},expression:"add_info.leader"}})],1),a("FormItem",{attrs:{label:"联系电话",prop:"phone"}},[a("Input",{attrs:{placeholder:"请输入手机或者固话（固话需加区号，如02012345678）",clearable:""},model:{value:e.add_info.phone,callback:function(t){e.$set(e.add_info,"phone",t)},expression:"add_info.phone"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.add_info.email,callback:function(t){e.$set(e.add_info,"email",t)},expression:"add_info.email"}})],1),a("FormItem",{attrs:{label:"状态",prop:"status"}},[a("Select",{model:{value:e.add_info.status,callback:function(t){e.$set(e.add_info,"status",t)},expression:"add_info.status"}},[a("Option",{attrs:{value:"0"}},[e._v("正常")]),a("Option",{attrs:{value:"1"}},[e._v("停用")])],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.add_Modal_show=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.add_loading},on:{click:function(t){e.addOk("add_info")}}},[e._v("保存")])],1)],1),a("Modal",{attrs:{width:"700",title:"部门管理编辑",loading:e.edit_loading,"mask-closable":!1},on:{"on-ok":e.editOk},model:{value:e.edit_Modal_show,callback:function(t){e.edit_Modal_show=t},expression:"edit_Modal_show"}},[a("Form",{ref:"edit_info",attrs:{model:e.edit_info,"label-width":80,rules:e.ruleValidate}},[a("FormItem",{attrs:{label:"上级部门",required:""}},[a("Button",{staticStyle:{width:"252px"},on:{click:function(t){e.tree_Modal_show1=!0}}},[e._v(e._s(e.bumenname||"请选择"))])],1),a("FormItem",{attrs:{label:"部门名称",prop:"deptName"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.edit_info.deptName,callback:function(t){e.$set(e.edit_info,"deptName",t)},expression:"edit_info.deptName"}})],1),a("FormItem",{attrs:{label:"显示排序",required:""}},[a("InputNumber",{staticStyle:{width:"100%"},attrs:{max:99999,min:0,placeholder:"请输入",clearable:""},model:{value:e.edit_info.orderNum,callback:function(t){e.$set(e.edit_info,"orderNum",t)},expression:"edit_info.orderNum"}})],1),a("FormItem",{attrs:{label:"负责人",prop:"leader"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.edit_info.leader,callback:function(t){e.$set(e.edit_info,"leader",t)},expression:"edit_info.leader"}})],1),a("FormItem",{attrs:{label:"联系电话",prop:"phone"}},[a("Input",{attrs:{placeholder:"请输入手机或者固话（固话需加区号，如02012345678）",clearable:""},model:{value:e.edit_info.phone,callback:function(t){e.$set(e.edit_info,"phone",t)},expression:"edit_info.phone"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.edit_info.email,callback:function(t){e.$set(e.edit_info,"email",t)},expression:"edit_info.email"}})],1),a("FormItem",{attrs:{label:"状态",prop:"status"}},[a("Select",{model:{value:e.edit_info.status,callback:function(t){e.$set(e.edit_info,"status",t)},expression:"edit_info.status"}},[a("Option",{attrs:{value:"0"}},[e._v("正常")]),a("Option",{attrs:{value:"1"}},[e._v("停用")])],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.edit_Modal_show=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.edit_loading},on:{click:function(t){e.editOk("edit_info")}}},[e._v("保存")])],1)],1),a("Modal",{attrs:{width:"400",title:"选择部门"},on:{"on-ok":e.treeOk},model:{value:e.tree_Modal_show,callback:function(t){e.tree_Modal_show=t},expression:"tree_Modal_show"}},[a("Tree",{ref:"tree4",attrs:{data:e.data2},on:{"on-select-change":e.choiceAll}})],1),a("Modal",{attrs:{width:"400",title:"选择部门"},on:{"on-ok":e.treeOk1},model:{value:e.tree_Modal_show1,callback:function(t){e.tree_Modal_show1=t},expression:"tree_Modal_show1"}},[a("Tree",{ref:"tree4",attrs:{data:e.data2},on:{"on-select-change":e.choiceAll1}})],1)],1)},i=[],s=a("7f80"),n={name:"dept-manage",components:{},data:function(){return{fold:!0,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{deptName:"",status:""},current:1,totalSize:0,pageNum:1,limit:10,TableLoading:!1,table_list:[],self:this,tableColumns:[{key:"title",minWidth:250,title:"部门名称"},{key:"orderNum",title:"排序",width:80},{key:"status",title:"状态",type:"template",template:"status"},{key:"createTime",title:"创建时间"},{title:"操作",key:"likes",minWidth:"200px",type:"template",template:"likes"}],loading:!1,add_Modal_show:!1,add_loading:!1,add_info:{},edit_Modal_show:!1,edit_info:{},edit_loading:!1,tree_Modal_show:!1,tree_Modal_show1:!1,data2:[],parentId:"",bumenname:"",deptId:"",ruleValidate:{deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],phone:[{required:!0,message:"联系电话不能为空",trigger:"blur"},{type:"number",message:"请输入正确的手机号或固话号",trigger:"change",transform:function(e){var t=/^[1][3,4,5,7,8][0-9]{9}$/,a=/0\d{2,3}\d{8}/;if(e)return!(!t.test(e)&&!a.test(e))&&Number(e)}}],leader:[{required:!0,message:"负责人不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"输入的邮箱格式不对",trigger:"blur"}]},searchType:""}},created:function(){},methods:{init:function(){this.searchType=1,this.updateTableList({}),this.refreshDept()},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},refresh:function(){this.searchItem.deptName="",this.searchItem.status="",this.updateTableList({})},queryTableList:function(){this.searchType=2,this.updateTableList(this.searchItem)},update:function(){""==this.searchItem.name||" "==this.searchItem.name?this.updateTableList({}):this.updateTableList(this.searchItem)},changeCurrent:function(e){this.pageNum=e,1==this.searchType?this.updateTableList({}):this.updateTableList(this.searchItem)},updateTableList:function(e){var t=this;this.TableLoading=!0,Object(s["f"])("/system/sys-dept/tree",e).then(function(e){t.TableLoading=!1,e.isSuccess?(t.totalSize=e.data.total,t.table_list=e.data):t.$Message.error(e.msg)})},addInfo:function(){this.add_info={},this.add_info.orderNum=null,this.add_Modal_show=!0,this.parentId="",this.bumenname="",this.deptId=""},addOk:function(e){var t=this;""!=this.deptId?this.$refs[e].validate(function(e){if(e){if(""==t.add_info.orderNum)return void t.$Message.error("显示排序不能为空!");var a={parentId:t.deptId,deptName:t.add_info.deptName,orderNum:t.add_info.orderNum,leader:t.add_info.leader,phone:t.add_info.phone,email:t.add_info.email,status:t.add_info.status};Object(s["f"])("/system/sys-dept/add",a).then(function(e){200==e.code?(t.$Message.info("新增成功！"),setTimeout(function(){t.add_Modal_show=!1,t.updateTableList({})},1200)):t.$Message.error(e.msg)})}else t.$Message.error("表单验证失败!")}):this.$Message.error("上级部门还没选择")},editInfo:function(e){var t=this,a={deptId:e.deptId};Object(s["f"])("/system/sys-dept/selectDeptById?deptId="+e.deptId,a).then(function(e){console.log(e.msg),200==e.code?(t.edit_info=e.data,t.edit_Modal_show=!0,t.parentId=e.data.parentId,t.bumenname=e.data.parentName,t.deptId=e.data.deptId):t.$Message.error(e.msg)})},edit_add:function(e){console.log(e),this.add_Modal_show=!0,this.parentId=e.parentId,this.bumenname=e.title,this.deptId=e.deptId},editOk:function(e){var t=this;""!=this.edit_info.orderNum?this.$refs[e].validate(function(e){if(e){var a={deptId:t.deptId,parentId:t.parentId,deptName:t.edit_info.deptName,orderNum:t.edit_info.orderNum,leader:t.edit_info.leader,phone:t.edit_info.phone,email:t.edit_info.email,status:t.edit_info.status,delFlag:t.edit_info.delFlag,createBy:t.edit_info.createBy,createTime:t.edit_info.createTime};Object(s["f"])("/system/sys-dept/edit",a).then(function(e){console.log(e.msg),200==e.code?(t.$Message.info("编辑成功！"),setTimeout(function(){t.edit_Modal_show=!1,t.updateTableList({})},1200)):t.$Message.error(e.msg)})}else t.$Message.error("表单验证失败!")}):this.$Message.error("显示排序不能为空!")},refreshDept:function(){var e=this,t={};Object(s["f"])("/system/sys-dept/tree",t).then(function(t){"200"==t.code?e.data2=t.data:e.$Message.error(t.msg)})},choiceAll:function(e){e&&(console.log(e),this.deptId=e[0].deptId,this.parentId=e[0].parentId,this.bumenname=e[0].title)},choiceAll1:function(e){e&&(console.log(e),this.parentId=e[0].deptId,this.bumenname=e[0].title)},treeOk:function(){void 0!=this.deptId?this.tree_Modal_show=!1:this.$Message.error("请选择部门名称")},treeOk1:function(){void 0!=this.deptId?this.tree_Modal_show1=!1:this.$Message.error("请选择部门名称")},removeInfo:function(e){var t=this,a=this;this.$Modal.confirm({title:"删除确认",content:"删除后不可恢复，是否继续删除？",onOk:function(){var t=this;this.$Loading.start(),Object(s["f"])("/system/sys-dept/delete?deptId="+e.deptId).then(function(e){t.loading=!1,200==e.code?(t.$Message.info("删除成功！"),a.updateTableList({})):t.$Message.error(e.msg)})},onCancel:function(){t.$Message.info("点击了取消")}})}},mounted:function(){this.init()}},d=n,r=(a("8c85"),a("2877")),l=Object(r["a"])(d,o,i,!1,null,"cb790064",null);l.options.__file="departmentManage.vue";t["default"]=l.exports},"8c85":function(e,t,a){"use strict";var o=a("c1ae"),i=a.n(o);i.a},c1ae:function(e,t,a){}}]);