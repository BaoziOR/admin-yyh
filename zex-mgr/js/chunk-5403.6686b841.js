(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5403"],{"0fbc":function(t,e,i){"use strict";var a=i("c57e"),n=i.n(a);n.a},c57e:function(t,e,i){},ef7d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"search"},[i("Row",[i("Col",[i("Card",[i("Row",[i("Form",{ref:"searchItem",staticClass:"search-form",attrs:{model:t.searchItem,inline:"","label-width":70}},[i("FormItem",{attrs:{label:"品牌名称"}},[i("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入品牌名称"},model:{value:t.searchItem.name,callback:function(e){t.$set(t.searchItem,"name",e)},expression:"searchItem.name"}})],1),t.drop?i("span"):t._e(),i("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[i("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.queryTableList}},[t._v("搜索")]),i("Button",{on:{click:t.refresh}},[t._v("重置")]),i("a",{staticClass:"drop-down",on:{click:t.dropDown}},[t._v("\n                "+t._s(t.dropDownContent)+"\n                "),i("Icon",{attrs:{type:t.dropDownIcon}})],1)],1)],1)],1)],1),i("Card",[i("Row",{staticClass:"operation"},[i("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){t.addMainInfo()}}},[t._v("新增主品牌")]),i("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:function(e){t.addSecondInfo()}}},[t._v("新增子品牌")]),i("Button",{attrs:{icon:"md-refresh"},on:{click:t.queryTableList}},[t._v("刷新")])],1),i("Row",[i("Table",{ref:"table",attrs:{loading:t.TableLoading,border:"",columns:t.tableColumns,data:t.table_list,sortable:"custom"},scopedSlots:t._u([{key:"logoImage",fn:function(e){var a=e.row;return[i("img",{staticStyle:{width:"74px",height:"43px"},attrs:{src:a.logo},on:{click:function(e){t.showBigImg(a)}}})]}}])})],1),i("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[i("Page",{staticStyle:{float:"right"},attrs:{total:t.totalSize,"show-total":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"update:current":function(e){t.current=e}}})],1)],1)],1)],1),i("Modal",{attrs:{width:"700",title:t.title,"mask-closable":!1},model:{value:t.edit_Modal_show,callback:function(e){t.edit_Modal_show=e},expression:"edit_Modal_show"}},[t.edit_info.secondPage||t.edit_info.brandIsSecond?i("span",[i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",staticStyle:{width:"100px"},attrs:{span:"2"}},[t._v(" 所属主品牌 ")]),i("Col",{attrs:{span:"16"}},[i("Select",{staticStyle:{width:"150px"},attrs:{clearable:""},on:{"on-change":t.getMainBrandlist},model:{value:t.edit_info.parentId,callback:function(e){t.$set(t.edit_info,"parentId",e)},expression:"edit_info.parentId"}},t._l(t.parentList,function(e,a){return i("Option",{key:a,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1)],1):t._e(),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",staticStyle:{width:"100px"},attrs:{span:"2"}},[t._v(" 品牌名称 ")]),i("Col",{attrs:{span:"16"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"请输入品牌名称",maxlength:20},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.name,callback:function(e){t.$set(t.edit_info,"name",e)},expression:"edit_info.name"}})],1)],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",staticStyle:{width:"100px"},attrs:{span:"2"}},[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v(" 品牌logo")]),i("Col",{attrs:{span:"3"}},[t.logeImgSrc?i("div",{staticClass:"imgSrc_box"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.logeImgSrc}})]):t._e()]),i("Col",{attrs:{span:"8"}},[i("div",{staticStyle:{width:"100px",float:"left"}},[i("ImgCutter",{attrs:{label:"选择图片",boxWidth:600,boxHeight:500,rate:1},on:{cutDown:t.cutDown}},[i("button",{staticStyle:{width:"100px",background:"border-box"},attrs:{slot:"openImgCutter"},slot:"openImgCutter"},[t._v("上传图片")])])],1),i("br"),i("div",{staticClass:"left-text"},[t._v("选择品牌logo (不大于1M,JPG/PNG/JPEG/BMP）")])])],1),i("Row",{staticClass:"box"},[i("Col",{staticClass:"left-text",staticStyle:{width:"100px"},attrs:{span:"2"}},[t._v(" 品牌描述 ")]),i("Col",{attrs:{span:"16"}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入品牌描述",maxlength:50},on:{"on-change":t.statusCheckChange},model:{value:t.edit_info.description,callback:function(e){t.$set(t.edit_info,"description",e)},expression:"edit_info.description"}})],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"text"},on:{click:function(e){t.edit_Modal_show=!1}}},[t._v("取消")]),i("Button",{attrs:{type:"primary",loading:t.edit_loading},on:{click:function(e){t.editOk("edit_info")}}},[t._v("保存")])],1)],1),i("Modal",{attrs:{title:"查看大图",width:"600"},on:{"on-cancel":t.bigImgCancel},model:{value:t.bigImgDialog,callback:function(e){t.bigImgDialog=e},expression:"bigImgDialog"}},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.big_Image_url}})])],1)},n=[],o=i("7f80"),s=i("9cd5"),r={components:{ImgCutter:s["a"]},name:"post-manage",data:function(){var t=this;return{drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",searchItem:{name:""},current:1,totalSize:0,pageNum:1,limit:10,TableLoading:!1,table_list:[],self:this,tableColumns:[{title:"品牌logo",key:"logo",width:150,align:"center",slot:"logoImage"},{title:"品牌ID",key:"id",width:150,align:"center",sortable:!0},{title:"品牌层级",key:"brandLevel",width:150,align:"center",sortable:!0},{title:"主品牌",key:"mainName",align:"center",width:200,render:function(t,e){var i=e.row,a="blue",n="1"==i.brandLevel?i.name:i.parentName;return t("Tag",{props:{color:a}},n)}},{title:"子品牌",key:"secondName",align:"center",width:200,render:function(t,e){var i=e.row,a="green",n="1"==i.brandLevel?"无":i.name;return t("Tag",{props:{color:a}},n)}},{title:"关联商户数",key:"relationMerchantCount",width:100,align:"center"},{title:"创建人",key:"createBy",width:100,align:"center"},{title:"创建时间",key:"createTime",width:200,align:"center",sortable:!0},{title:"编辑人",key:"updateBy",width:100,align:"center"},{title:"编辑时间",key:"updateTime",width:200,align:"center",sortable:!0},{title:"操作",key:"action",fixed:"left",align:"center",width:150,render:function(e,i){return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#5cadff"},on:{click:function(){t.editInfo(i.row)}}},"编辑")])}}],edit_Modal_show:!1,edit_info:{parentId:"",parentName:"",name:"",logo:"",description:"",remark:null,logoImg:"",mainPage:!1,secondPage:!1,addFlag:!1,editFlag:!1,action:"",id:"",brandLevel:"",brandIsSecond:!1},logeImgSrc:"",bigImgDialog:!1,big_Image_url:"",parentList:[],isCheckDisabled:!0,edit_loading:!1,ruleValidate:{postName:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}],postCode:[{required:!0,message:"岗位编码不能为空",trigger:"blur"}],postSort:[{required:!0,message:"显示顺序不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择岗位状态",trigger:"change"}]},requestUrl:"",msg:"",title:""}},created:function(){},methods:{cutDown:function(t){var e=this;if(this.logeImgSrc=t.dataURL,this.showSize(),this.logImgSize>1024)this.$Message.error("图片不能大于1M");else{var i={imgStr:t.dataURL.substr(22)};Object(o["f"])("/operation/operation-info/uploadBase64Image2AliOss",i).then(function(t){200==t.code?e.edit_info.logoImg=t.image_url:e.$Message.error(t.msg)}),this.isCheckDisabled=!1}},showBigImg:function(t){this.bigImgDialog=!0,this.big_Image_url=t.logo},bigImgCancel:function(){this.bigImgDialog=!1},showSize:function(){var t=this.logeImgSrc,e=t.replace("data:image/png;base64,",""),i=e.indexOf("=");e.indexOf("=")>0&&(e=e.substring(0,i));var a=e.length,n=parseInt(a-a/8*2),o="";o=(n/1024).toFixed(2);var s=o+"",r=s.indexOf("."),l=s.substr(r+1,2);"00"==l&&(this.logImgSize=s.substring(0,r)+s.substr(r+3,2)),this.logImgSize=o},init:function(){this.updateTableList(),this.getMainBrandlist()},statusCheckChange:function(){this.isCheckDisabled=!1},getMainBrandlist:function(){var t=this;Object(o["f"])("/merchant/brandMain/listall").then(function(e){200==e.code?t.parentList=e.data:t.$Message.error(e.msg)})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},refresh:function(){this.searchItem.name="",this.updateTableList()},queryTableList:function(){this.pageNum=1,this.totalSize=0,this.updateTableList()},changeCurrent:function(t){this.pageNum=t,this.updateTableList()},updateTableList:function(){var t=this;this.TableLoading=!0,this.getMainBrandlist();var e={name:this.searchItem.name};Object(o["f"])("/merchant/brandMain/list?pageNum="+this.pageNum+"&pageSize="+this.limit,e).then(function(e){t.TableLoading=!1,e.isSuccess?(t.totalSize=e.data.total,t.table_list=e.data.records):t.$Message.error(e.msg)})},addInfo:function(){this.edit_info={parentId:"",parentName:"",name:"",logo:"",logoImg:"",description:""},this.edit_Modal_show=!0,this.title="岗位管理新增"},addMainInfo:function(){this.logeImgSrc="",this.edit_info={mainPage:!0,secondPage:!1,action:"add",addFlag:!0,editFlag:!1,parentId:"",parentName:"",name:"",logo:"",logoImg:"",description:"",id:""},this.edit_Modal_show=!0,this.title="新增主品牌"},addSecondInfo:function(){this.logeImgSrc="",this.edit_info={secondPage:!0,mainPage:!1,action:"add",addFlag:!0,editFlag:!1,parentId:"",parentName:"",name:"",logo:"",logoImg:"",description:"",id:""},this.edit_Modal_show=!0,this.title="新增子品牌"},editInfo:function(t){this.edit_info={action:"edit",addFlag:!1,editFlag:!0,parentId:t.parentId,parentName:t.parentName,brandLevel:t.brandLevel,name:t.name,logo:t.logo,logoImg:t.logo,description:t.description,id:t.id},this.edit_Modal_show=!0,this.logeImgSrc=t.logo,this.title="品牌编辑","2"==this.edit_info.brandLevel?(this.edit_info.brandIsSecond=!0,this.edit_info.secondPage=!0,this.edit_info.mainPage=!1):(this.edit_info.brandIsSecond=!1,this.edit_info.secondPage=!1,this.edit_info.mainPage=!0)},editOk:function(t){var e=this;if(this.edit_info.parentId||!this.edit_info.secondPage)if(this.edit_info.name)if(this.edit_info.logoImg)if(""!=this.edit_info.postSort){this.edit_info.mainPage&&this.edit_info.addFlag&&(this.requestUrl="/merchant/brandMain/add",this.msg="新增成功"),this.edit_info.mainPage&&this.edit_info.editFlag&&(this.requestUrl="/merchant/brandMain/edit",this.msg="编辑成功"),this.edit_info.secondPage&&this.edit_info.addFlag&&(this.requestUrl="/merchant/brandSecond/add",this.msg="新增成功"),this.edit_info.secondPage&&this.edit_info.editFlag&&(this.requestUrl="/merchant/brandSecond/edit",this.msg="编辑成功"),this.edit_loading=!0;var i={parentId:this.edit_info.parentId,parentName:this.edit_info.parentName,name:this.edit_info.name,logo:this.edit_info.logoImg,remark:this.edit_info.remark,description:this.edit_info.description,id:this.edit_info.id};Object(o["f"])(this.requestUrl,i).then(function(t){e.edit_loading=!1,200==t.code?(e.$Message.info(e.msg),setTimeout(function(){e.edit_Modal_show=!1,e.updateTableList()},1200)):e.$Message.error(t.msg)})}else this.$Message.error("显示顺序不能为空");else this.$Message.error("请上传品牌logo");else this.$Message.error("请填写品牌名称");else this.$Message.error("请选择主品牌")},removeInfo:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"删除后不可恢复，是否继续删除？",onOk:function(){e.$Loading.start(),Object(o["f"])("/system/sys-post/delete?postId="+t.postId).then(function(t){e.loading=!1,"200"==t.code?(e.$Message.info("删除成功！"),setTimeout(function(){e.pageNum=1,e.updateTableList()},1200)):e.$Message.error(t.msg)})},onCancel:function(){e.$Message.info("点击了取消")}})}},mounted:function(){this.init()}},l=r,d=(i("0fbc"),i("2877")),c=Object(d["a"])(l,a,n,!1,null,"5dd00042",null);c.options.__file="brandManage.vue";e["default"]=c.exports}}]);